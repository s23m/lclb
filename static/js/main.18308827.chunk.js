(this.webpackJsonps23mgrapheditor=this.webpackJsonps23mgrapheditor||[]).push([[0],{140:function(e,t,n){},179:function(e,t,n){e.exports=n.p+"static/media/vertex.4937cefd.svg"},180:function(e,t,n){e.exports=n.p+"static/media/edge.09e9d9dc.svg"},181:function(e,t,n){e.exports=n.p+"static/media/specialisation.3320bc80.svg"},182:function(e,t,n){e.exports=n.p+"static/media/visibility.5452d398.svg"},183:function(e,t,n){e.exports=n.p+"static/media/select.8b3cad47.svg"},184:function(e,t,n){e.exports=n.p+"static/media/artifact.91473c28.svg"},185:function(e,t,n){e.exports=n.p+"static/media/container.ddecd459.svg"},205:function(e,t,n){e.exports=n.p+"static/media/create_folder.5ddfbbc9.svg"},206:function(e,t,n){e.exports=n.p+"static/media/delete_folder.ccd4d6e6.svg"},207:function(e,t,n){e.exports=n.p+"static/media/changeFolderName.d6c49e9c.svg"},208:function(e,t,n){e.exports=n.p+"static/media/NewModel.5f359781.svg"},209:function(e,t,n){e.exports=n.p+"static/media/DeleteModel.8ff04828.svg"},210:function(e,t,n){e.exports=n.p+"static/media/editModel.0c58ce6e.svg"},232:function(e,t,n){e.exports=n(413)},237:function(e,t,n){},413:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(13),s=n.n(r),l=(n(237),n(140),n(9)),o=n(18),c=n(20),d=n(37),u=n(36),h=n(177),f=n.n(h),m=n(23);var y=function e(t,n,a,i,r,s){Object(o.a)(this,e),this.typeName="SemanticIdentity",this.UUID=void 0!==r?r:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})),this.name=t,this.description=n,this.abbreviation=a,this.shortAbbreviation=i,this.translations=void 0!==s?s:[]},v=5,g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unnamed",n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0;Object(o.a)(this,e),this.typeName="Vertex",this.semanticIdentity=void 0!==l?l:new y(t,"","","",void 0,[]),this.title=t,this.content=n,this.x=a,this.y=i,this.icons=[[],[],[]],this.colour="#FFD5A9",this.selected=!1,this.imageElements={},this.fontSize=12,this.width=r,this.height=s,this.realHeight=s,this.width=Math.max(r,30),this.height=Math.max(s,30),this.isAbstract=!1,this.vertexPath="",this.vertexModelKey=Le(),this.vertexRenderKey=oa(this.vertexModelKey),this.renderedx=a,this.renderedy=i,this.awayx=Math.floor(2e6*Math.random())+1e5,this.awayy=Math.floor(2e6*Math.random())+1e5,this.status="present"}return Object(c.a)(e,[{key:"setAway",value:function(){"present"===this.status&&(this.renderedx=this.x,this.renderedy=this.y,this.x=this.awayx,this.y=this.awayy,this.status="away")}},{key:"setPresent",value:function(){"away"===this.status&&(this.x=this.renderedx,this.y=this.renderedy,this.status="present")}},{key:"setModelKey",value:function(e){this.vertexModelKey=e}},{key:"getModelKey",value:function(){return this.vertexModelKey}},{key:"setRenderKey",value:function(e){this.vertexRenderKey=e}},{key:"getRenderKey",value:function(){return this.vertexRenderKey}},{key:"setPath",value:function(e){this.vertexPath=e}},{key:"getPath",value:function(){return this.vertexPath}},{key:"setSelected",value:function(e){this.selected=e}},{key:"getColour",value:function(){return this.colour}},{key:"setColour",value:function(e){this.colour=e}},{key:"setTitle",value:function(e){this.title=e,this.semanticIdentity.name=e}},{key:"setContent",value:function(e){this.content=e,this.semanticIdentity.description=e}},{key:"getAbstract",value:function(){return this.isAbstract}},{key:"toggleAbstract",value:function(){this.isAbstract=!this.isAbstract}},{key:"getContentAsString",value:function(){if(null!==this.content){for(var e="",t=0;t<this.content.length;t++)e=e.concat(this.content[t]),t<this.content.length-1&&(e=e.concat("\n"));return e}return""}},{key:"setIcon",value:function(e){var t=this.icons[0],n=this.icons[1],a=this.icons[2],i=t.indexOf(e);-1===i?(t.push(e),n.push(!0),a.push(!1)):n[i]=!n[i],!1===a[i]&&!1===n[i]&&(n.splice(i,1),a.splice(i,1),t.splice(i,1))}},{key:"setText",value:function(e){var t=this.icons[0],n=this.icons[1],a=this.icons[2],i=t.indexOf(e);-1===i?(t.push(e),n.push(!1),a.push(!0)):a[i]=!a[i],!1===a[i]&&!1===n[i]&&(n.splice(i,1),a.splice(i,1),t.splice(i,1))}},{key:"isIconSet",value:function(e){var t=this.icons[0].indexOf(e);return-1!==t&&this.icons[1][t]}},{key:"isTextSet",value:function(e){var t=this.icons[0].indexOf(e);return-1!==t&&this.icons[2][t]}},{key:"getBounds",value:function(){return[this.x,this.y,this.x+this.width,this.y+this.realHeight-v]}},{key:"expandSide",value:function(e,t,n,a){var i=0,r=0,s=this.hasContent()?4*v:2*v;switch(e){case"topLeft":r+=this.y+this.height,this.y=n,this.height=r-this.y,i+=this.x+this.width,this.x=t,this.width=i-this.x;break;case"topRight":r+=this.y+this.height,this.y=n,this.height=r-this.y,this.width=t-this.x;break;case"bottomLeft":this.height=n-this.y-this.iconAreaHeight-this.contentHeight-s,i+=this.x+this.width,this.x=t,this.width=i-this.x;break;case"bottomRight":this.height=n-this.y-this.iconAreaHeight-this.contentHeight-s,this.width=t-this.x;break;case"left":i+=this.x+this.width,this.x=t,this.width=i-this.x;break;case"right":this.width=t-this.x;break;case"top":r+=this.y+this.height,this.y=n,this.height=r-this.y;break;case"bottom":this.height=n-this.y-this.iconAreaHeight-this.contentHeight-s}this.height=Math.max(this.height,12+v),this.draw(a)}},{key:"increaseWidthIfNecessary",value:function(e,t){t>this.width&&(this.width=t)}},{key:"hasContent",value:function(){return!(""===this.content[0]&&1===this.content.length)}},{key:"draw",value:function(e){for(var t=this.icons[0].length,n=0;n<this.icons[0].length;n++)!0===this.icons[1][n]?!0===this.icons[2][n]&&this.increaseWidthIfNecessary(e,20+e.measureText("<< "+this.icons[0][n]+" >>").width):!0===this.icons[2][n]&&this.increaseWidthIfNecessary(e,e.measureText("<< "+this.icons[0][n]+" >>").width);this.increaseWidthIfNecessary(e,e.measureText(this.title).width);for(var a=0;a<this.content.length;a++)this.increaseWidthIfNecessary(e,e.measureText(this.content[a]).width+2*v);v=5,this.is&&(e.font=this.fontSize+"px Segoe UI"),e.fontSize=this.fontSize;var i=e.measureText(this.title).width,r=Math.max(i+2*v,this.width);this.contentHeight=0;for(var s=0;s<this.content.length;s++){var l=e.measureText(this.content[s]);r=Math.max(r,l.width,i),this.contentHeight+=this.fontSize+v}this.hasContent()||(this.contentHeight=0),r>this.width&&(this.width=r),e.shadowOffsetX=2,e.shadowOffsetY=2,this.iconAreaHeight=24*t,""!==this.content[0]?this.realHeight=4*v+this.height+this.iconAreaHeight+this.contentHeight:this.realHeight=2*v+this.height+this.iconAreaHeight,e.fillStyle=this.colour,e.fillRect(this.x,this.y,this.width,this.realHeight),e.strokeRect(this.x,this.y,this.width,this.realHeight),""!==this.content[0]&&e.strokeRect(this.x,this.y,this.width,this.height+this.iconAreaHeight+2*v),this.selected&&(e.fillStyle="#000000",xt(this.x,this.y),xt(this.x+this.width,this.y),xt(this.x,this.y+this.realHeight),xt(this.x+this.width,this.y+this.realHeight));this.y,this.x,this.width;e.fillStyle="#000000";var o=v+this.fontSize;e.shadowOffsetX=0,e.shadowOffsetY=0;for(var c=this.x+2,d=this.y+20,u=0;u<this.icons[0].length;u++){if(!0===this.icons[2][u]){!0!==this.icons[1][u]&&this.increaseWidthIfNecessary(e,e.measureText("<< "+this.icons[0][u]+" >>").width);var h="<< "+this.icons[0][u].slice(0,-4)+" >>";"_n"===this.icons[0][u].slice(-6,-4)&&(h=""),e.fillText(h,c,d)}d+=24}this.increaseWidthIfNecessary(e,e.measureText(this.title).width),this.isAbstract?e.font="italic "+this.fontSize+"px Segoe UI":e.font=this.fontSize+"px Segoe UI",e.fillText(this.title,this.x+v,this.y+o+this.iconAreaHeight),o=2*v+this.height+this.contentHeight,e.font=this.fontSize+"px Segoe UI";for(var f=0;f<this.content.length;f++)this.increaseWidthIfNecessary(e,e.measureText(this.content[f]).width+2*v),e.fillText(this.content[f],this.x+v,this.y+o+this.iconAreaHeight),o+=this.fontSize+v;e.strokeStyle="black"}},{key:"intersects",value:function(e,t){return!(e<this.x)&&(!(t<this.y)&&(!(e>this.x+this.width)&&t<=this.y+this.height))}},{key:"getNearestSideFrom",value:function(e,t){return this.getNearestSide(e,t)}},{key:"getNearestSide",value:function(e,t){var n=[];if(e>this.x&&e<this.x+this.width){var a=(e-this.x)/this.width;n.push([Math.abs(t-this.y),a,0]),n.push([Math.abs(t-(this.y+this.realHeight)),a,1])}else if(t>this.y&&t<this.y+this.realHeight){var i=(t-this.y)/this.realHeight;n.push([Math.abs(e-this.x),0,i]),n.push([Math.abs(e-(this.x+this.width)),1,i])}var r=!1;if(n.forEach((function(e){e[0]<Qe&&(r=!0)})),!1===r&&e>this.x&&e<this.x+this.width&&t>this.y&&t<this.y+this.realHeight){for(var s=(t-this.y)/this.realHeight,l=(e-this.x)/this.width,o=Math.abs(l-1)*this.width,c=s*this.realHeight,d=l*this.width,u=0,h=d,f=[d,o,c,s*this.realHeight],m=1;m<f.length-1;m++)f[m]<h&&(h=f[m],u=m);if(0===u)return[0,0,s];if(1===u)return[0,1,s];if(2===u)return[0,l,0];if(3===u)return[0,l,1]}if(0===n.length)return null;for(var y=n[0],v=1;v<n.length;v++)n[v][0]<y[0]&&(y=n[v]);return y}}]),e}(),p="None",b="Arrow",E="Triangle",x="Filled Triangle",w="Diamond",k="Filled Diamond",I={};I[p]="None",I[b]="Arrow",I[E]="Triangle",I[x]="FilledTriangle",I[w]="Diamond",I[k]="FilledDiamond";var N={};N.None=p,N.Arrow=b,N.Triangle=E,N.FilledTriangle=x,N.Diamond=w,N.FilledDiamond=k;var S="#000000",C="#FF0000",M="#0000FF",V="#00FF00",O={};O[S]="Black",O[C]="Red",O[M]="Blue",O[V]="Green";var j={};j.Black=S,j.Red=C,j.Blue=M,j.Green=V;var L=1,U=2,D={};D[L]="Solid",D[U]="Dashed";var T={};T.Solid=L,T.Dashed=U;var A=function(){function e(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;Object(o.a)(this,e),this.typeName="Cardinality",this.numLowerBound=t,this.numUpperBound=n,this.attachedToUUID=a,this.isVisible=i,this.semanticIdentity=void 0!==r?r:new y(this.toString(),this.getDescription())}return Object(c.a)(e,[{key:"toggleVisibility",value:function(){this.isVisible=!this.isVisible}},{key:"toString",value:function(){var e,t;return(e="-1"===this.lowerBound?"n":this.lowerBound)===(t="-1"===this.upperBound?"n":this.upperBound)?e:e+" .. "+t}},{key:"getDescription",value:function(){return"Cardinality of Edge End ".concat(this.attachedToUUID)}},{key:"lowerBound",set:function(e){this.numLowerBound=e,this.semanticIdentity.name=this.toString()},get:function(){return this.numLowerBound}},{key:"upperBound",set:function(e){this.numUpperBound=e,this.semanticIdentity.name=this.toString()},get:function(){return this.numUpperBound}}]),e}(),B=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4?arguments[4]:void 0;Object(o.a)(this,e),this.attachedToUUID=t,this.typeName="EdgeEnd",this.semanticIdentity=void 0!==r?r:new y(this.toString(),this.getDescription()),this.headType=n,this.cardinality=void 0!==a?a:new A(1,1,this.semanticIdentity.UUID),this.label=i,this.edgeEndRenderKey=Me(),this.edgeEndModelKey=Le()}return Object(c.a)(e,[{key:"setModelKey",value:function(e){this.edgeEndModelKey=e}},{key:"getModelKey",value:function(){return this.edgeEndModelKey}},{key:"setRenderKey",value:function(e){this.edgeEndRenderKey=e}},{key:"getRenderKey",value:function(e){return this.edgeEndRenderKey}},{key:"toString",value:function(){return"".concat(this.type," type Edge End")}},{key:"getDescription",value:function(){return"Edge end of ".concat(this.attachedToUUID)}},{key:"updateCardinality",value:function(e,t,n){this.cardinality.lowerBound=e,this.cardinality.upperBound=t,this.cardinality.visibility=n}},{key:"drawLines",value:function(e,t,n,a){e.strokeStyle=n,void 0!==a&&(e.fillStyle=a),e.beginPath(),e.moveTo(t[0].X,t[0].Y);for(var i=1;i<t.length;i++)e.lineTo(t[i].X,t[i].Y);void 0!==a&&(e.closePath(),e.fill()),e.stroke(),e.fillStyle="#000",e.strokeStyle="#000"}},{key:"drawArrowEnd",value:function(e,t,n,a,i){var r=Math.PI/6,s=a+Math.PI,l=[];l.push({X:t+7*Math.cos(s-r),Y:n+7*Math.sin(s-r)}),l.push({X:t,Y:n}),l.push({X:t+7*Math.cos(s+r),Y:n+7*Math.sin(s+r)}),this.drawLines(e,l,i)}},{key:"drawTriangleEnd",value:function(e,t,n,a,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#FFF",s=7,l=Math.PI/6,o=a+Math.PI,c=[];c.push({X:t,Y:n}),c.push({X:t+s*Math.cos(o-l),Y:n+s*Math.sin(o-l)}),c.push({X:t+s*Math.cos(o+l),Y:n+s*Math.sin(o+l)}),c.push({X:t,Y:n}),this.drawLines(e,c,i,r)}},{key:"drawDiamondEnd",value:function(e,t,n,a,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#FFF",s=7,l=Math.PI/9,o=a+Math.PI,c=[];c.push({X:t,Y:n}),c.push({X:t+s*Math.cos(o-l),Y:n+s*Math.sin(o-l)}),c.push({X:t+2*s*Math.cos(o),Y:n+2*s*Math.sin(o)}),c.push({X:t+s*Math.cos(o+l),Y:n+s*Math.sin(o+l)}),c.push({X:t,Y:n}),this.drawLines(e,c,i,r)}},{key:"draw",value:function(e,t,n,a,i){switch(this.type){case p:break;case b:this.drawArrowEnd(e,t,n,a,i);break;case E:this.drawTriangleEnd(e,t,n,a,i);break;case x:this.drawTriangleEnd(e,t,n,a,i,i);break;case w:this.drawDiamondEnd(e,t,n,a,i);break;case k:this.drawDiamondEnd(e,t,n,a,i,i);break;default:console.log("EdgeEnd had unexpected type: %s",this.type)}}},{key:"type",set:function(e){this.headType=e,this.semanticIdentity.name=this.toString()},get:function(){return this.headType}}]),e}(),K=n(44),F=n(178),R=n(179),P=n.n(R),H=n(180),Y=n.n(H),X=n(181),z=n.n(X),W=n(182),G=n.n(W),J=n(183),_=n.n(J),q=n(184),Z=n.n(q),$=n(185),Q=n.n($),ee=n(133),te={TreeView:"TreeView",Vertex:"Vertex",Arrow:"Arrow",Artifact:"Artifact",Container:"Container"},ne={};ne[te.TreeView]="TreeView",ne[te.Vertex]="Vertex",ne[te.Arrow]="Arrow",ne[te.Arrow]="Artifact",ne[te.Arrow]="Container";var ae={};ne.TreeView=te.TreeView,ne.Vertex=te.Vertex,ne.Arrow=te.Arrow,ne.Artifact=te.Artifact,ne.Container=te.Container;var ie,re,se,le,oe,ce,de,ue,he,fe={Select:"Select",Vertex:"Vertex",Visibility:"Visibility",Edge:"Edge",Specialisation:"Specialisation",Artifact:"Artifact",Container:"Container"},me=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).testUpdateLabel=function(){a.setPath("fffffffff")},a.getVertexColour=function(){return a.state.selectedObject.getColour()},a.setVertexColour=function(e){a.state.selectedObject.setColour(e.hex),_e()},a.getMenu=function(){var e,t=i.a.createElement("div",{id:"Toolbar",className:"Toolbar"},i.a.createElement("div",{id:"Select",className:"ToolbarItem",onClick:function(){return a.props.setMode(fe.Select)}},i.a.createElement("img",{src:_.a,alt:"Select"})),i.a.createElement("div",{id:"Vertex",className:"ToolbarItem",onClick:function(){a.props.setMode(fe.Vertex)},onKeyDown:function(){return a.onKeyPressed()}},i.a.createElement("img",{src:P.a,alt:"Vertex"})),i.a.createElement("div",{id:"Artifact",className:"ToolbarItem",onClick:function(){return a.props.setMode(fe.Artifact)},onKeyDown:function(){return a.onKeyPressed()}},i.a.createElement("img",{src:Z.a,alt:"Artifact"})),i.a.createElement("div",{id:"Container",className:"ToolbarItem",onClick:function(){return a.props.setMode(fe.Container)},onKeyDown:function(){return a.onKeyPressed()}},i.a.createElement("img",{src:Q.a,alt:"Container"})),i.a.createElement("div",{id:"Edge",className:"ToolbarItem",onClick:function(){return a.props.setMode(fe.Edge)}},i.a.createElement("img",{src:Y.a,alt:"Edge"})),i.a.createElement("div",{id:"Specialisation",className:"ToolbarItem",onClick:function(){return a.props.setMode(fe.Specialisation)}},i.a.createElement("img",{src:z.a,alt:"Specialisation"})),i.a.createElement("div",{id:"Visibility",className:"ToolbarItem",onClick:function(){return a.props.setMode(fe.Visibility)}},i.a.createElement("img",{src:G.a,alt:"Visibility"})));return a.state.menu===te.TreeView?e=i.a.createElement(ha,{setLeftMenu:a.props.setLeftMenu}):a.state.menu===te.Vertex?(_e(),e=i.a.createElement("form",{id:"VertexMenu"},i.a.createElement("div",{className:"LeftHeader"},"Vertex Properties"),i.a.createElement("label",{className:"LeftLabel"},"Title"),i.a.createElement("input",{id:"LeftTitle",className:"LeftTitle",defaultValue:a.state.selectedObject.title,onKeyUp:function(){return a.setTitle()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Content"),i.a.createElement("textarea",{id:"LeftContent",className:"LeftContent",defaultValue:a.state.selectedObject.getContentAsString(),onKeyUp:function(){return a.setContent()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),a.getS23MIconsSelector(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),a.getColourPicker(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Is Abstract?"),i.a.createElement("input",{type:"checkbox",id:"IsAbstract",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getAbstract(),onClick:function(){return a.toggleAbstract()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return a.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){!function(e){console.log("vDeleteE occurs");var t=we.ArrowUUIDSource(e),n=we.ArrowUUIDDest(e);t.forEach((function(e){return we.remove(e.arrow)})),n.forEach((function(e){return we.remove(e.arrow)})),null!==e?(console.log("vdl if staement pass"),we.remove(e)||console.error("Failed to delete object with UUID %s",e.semanticIdentity.UUID)):console.error("Attempted to delete a null element");_e()}(a.state.selectedObject),a.setState({menu:"TreeView"})},placeholder:"NoTabIndex"},"Remove"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("input",{id:"VertPath",className:"vertexPath",defaultValue:a.state.selectedObject.vertexPath}))):a.state.menu===te.Artifact?(_e(),e=i.a.createElement("form",{id:"VertexMenu"},i.a.createElement("div",{className:"LeftHeader"},"Vertex Properties"),i.a.createElement("label",{className:"LeftLabel"},"Title"),i.a.createElement("input",{id:"LeftTitle",className:"LeftTitle",defaultValue:a.state.selectedObject.title,onKeyUp:function(){return a.setTitle()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Content"),i.a.createElement("textarea",{id:"LeftContent",className:"LeftContent",defaultValue:a.state.selectedObject.getContentAsString(),onKeyUp:function(){return a.setContent()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),a.getS23MIconsSelector(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),a.getColourPicker(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Is Abstract?"),i.a.createElement("input",{type:"checkbox",id:"IsAbstract",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getAbstract(),onClick:function(){return a.toggleAbstract()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return a.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){qe(a.state.selectedObject),a.setState({menu:"TreeView"})},placeholder:"NoTabIndex"},"Remove"))):a.state.menu===te.Container?(_e(),e=i.a.createElement("form",{id:"VertexMenu"},i.a.createElement("div",{className:"LeftHeader"},"Vertex Properties"),i.a.createElement("label",{className:"LeftLabel"},"Title"),i.a.createElement("input",{id:"LeftTitle",className:"LeftTitle",defaultValue:a.state.selectedObject.title,onKeyUp:function(){return a.setTitle()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Content"),i.a.createElement("textarea",{id:"LeftContent",className:"LeftContent",defaultValue:a.state.selectedObject.getContentAsString(),onKeyUp:function(){return a.setContent()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),a.getS23MIconsSelector(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Is Abstract?"),i.a.createElement("input",{type:"checkbox",id:"IsAbstract",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getAbstract(),onClick:function(){return a.toggleAbstract()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return a.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){qe(a.state.selectedObject),a.setState({menu:"TreeView"})},placeholder:"NoTabIndex"},"Remove"))):a.state.menu===te.Arrow&&(console.log("Arrow Selected"),console.log(a.state.selectedObject),e=a.state.selectedObject.edgeType===fe.Edge?i.a.createElement("form",{id:"ArrowMenu"},i.a.createElement("div",{className:"LeftHeader"},"Edge Properties"),i.a.createElement("label",{className:"LeftLabel"},"Source Is Navigable?"),i.a.createElement("input",{type:"checkbox",id:"SourceIsNavigable",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getNavigable(0),onClick:function(){return a.setNavigable(0)}}),i.a.createElement("label",{className:"LeftLabel"},"Destination Is Navigable?"),i.a.createElement("input",{type:"checkbox",id:"DestIsNavigable",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getNavigable(1),onClick:function(){return a.setNavigable(1)}}),i.a.createElement("label",{className:"LeftLabel"},"Source Is Aggregation?"),i.a.createElement("input",{type:"checkbox",id:"SourceIsAggregation",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getAggregation(0),onClick:function(){return a.setAggregation(0)}}),i.a.createElement("label",{className:"LeftLabel"},"Destination Is Aggregation?"),i.a.createElement("input",{type:"checkbox",id:"DestIsAggregation",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getAggregation(1),onClick:function(){return a.setAggregation(1)}}),i.a.createElement("label",{className:"LeftLabel"},"Line Colour"),i.a.createElement("select",{name:"LineColour",id:"LineColour",className:"LeftSelector",defaultValue:O[a.state.selectedObject.lineColour],onChange:function(){return a.setColour()}},i.a.createElement("option",{value:"Black"},"Black"),i.a.createElement("option",{value:"Red"},"Red"),i.a.createElement("option",{value:"Blue"},"Blue"),i.a.createElement("option",{value:"Green"},"Green")),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Source Cardinality"),i.a.createElement("div",{className:"CardinalityArea"}," ",i.a.createElement("div",{className:"LeftCheckboxLabel"}," Visible: ")," ",i.a.createElement("input",{type:"checkbox",id:"sourceCardinalityShown",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getSourceCardinalityVisibility(),onChange:function(){a.toggleSourceCardinalityVisibility(),_e()}}),i.a.createElement("input",{type:"number",id:"sourceFromCardindality",className:"CardinalityBox",defaultValue:a.state.selectedObject.getSourceCardinalityLowerBound(),min:"0",max:"25",onChange:function(){return a.updateCardinality()}}),i.a.createElement("label",null,".."),i.a.createElement("input",{type:"number",id:"sourceToCardindality",className:"CardinalityBox",defaultValue:a.state.selectedObject.getSourceCardinalityUpperBound(),min:"-1",max:"25",onChange:function(){return a.updateCardinality()}})),i.a.createElement("label",{className:"LeftLabel"},"Destination Cardinality"),i.a.createElement("div",{className:"CardinalityArea"}," ",i.a.createElement("div",{className:"LeftCheckboxLabel"},"Visible:")," ",i.a.createElement("input",{type:"checkbox",id:"destCardinalityShown",className:"LeftCheckbox",defaultChecked:a.state.selectedObject.getDestCardinalityVisibility(),onChange:function(){a.toggleDestCardinalityVisibility(),_e()}}),i.a.createElement("input",{type:"number",id:"destFromCardindality",className:"CardinalityBox",defaultValue:a.state.selectedObject.getDestCardinalityLowerBound(),min:"0",max:"25",onChange:function(){return a.updateCardinality()}}),i.a.createElement("label",null,".."),i.a.createElement("input",{type:"number",id:"destToCardindality",className:"CardinalityBox",defaultValue:a.state.selectedObject.getDestCardinalityUpperBound(),min:"-1",max:"25",onChange:function(){return a.updateCardinality()}})),i.a.createElement("label",{className:"LeftLabel"},"Source Label"),i.a.createElement("input",{id:"SourceLabel",className:"LeftTitle",defaultValue:a.state.selectedObject.sourceEdgeEnd.label,onKeyUp:function(){return a.setStartLabel()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Destination Label"),i.a.createElement("input",{id:"DestLabel",className:"LeftTitle",defaultValue:a.state.selectedObject.destEdgeEnd.label,onKeyUp:function(){return a.setEndLabel()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){qe(a.state.selectedObject),a.setState({menu:te.TreeView,selectedObject:null})}},"Remove"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(e){return a.stripElement(e)}},"Make Straight"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return a.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){qe(a.state.selectedObject),a.setState({menu:te.TreeView,selectedObject:null})}},"Remove")):i.a.createElement("form",{id:"ArrowMenu"},i.a.createElement("div",{className:"LeftHeader"},"Selected Edge"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return a.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){qe(a.state.selectedObject),a.setState({menu:te.TreeView,selectedObject:null})}},"Remove"))),i.a.createElement("div",null,t,i.a.createElement("form",{ref:a.setFormRef,className:a.props.className},e))},a.state={menu:te.TreeView,selectedObject:null,fileNames:[]},a.setTitle=a.setTitle.bind(Object(K.a)(a)),a.setContent=a.setContent.bind(Object(K.a)(a)),a.formRef=null,a.setFormRef=function(e){a.formRef=e},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.menu=this.props.mainState.menu,this.selectedItem=this.props.mainState.drawMode,this.props.setMode(this.selectedItem),document.addEventListener("keydown",this.onKeyPressed.bind(this))}},{key:"onKeyPressed",value:function(e){86===e.keyCode&&null===this.state.selectedObject&&this.props.setMode(fe.Vertex),69===e.keyCode&&null===this.state.selectedObject&&this.props.setMode(fe.Edge),46===e.keyCode&&(console.log(this.state.selectedObject),qe(this.state.selectedObject),this.setState({menu:"TreeView"}))}},{key:"componentWillReceiveProps",value:function(e,t){this.setState({menu:e.mainState.menu,selectedObject:e.mainState.selectedObject})}},{key:"componentDidUpdate",value:function(e,t,n){var a=document.getElementById("LeftTitle");null!==a&&document.getElementById("ModelName")!==document.activeElement&&(a.select(),a.click());var i=document.getElementById("VertexMenu");null===i&&(i=document.getElementById("ArrowMenu")),null!==i&&i.addEventListener("keypress",(function(e){"Enter"===e.key&&e.preventDefault()}))}},{key:"setIcons",value:function(){var e=this;fetch("http://localhost:8080/icons/list",{method:"GET",headers:{Accept:"*/*"}}).then((function(e){return e.json()})).then((function(t){var n=[];t.icons.forEach((function(e){n.push(e)})),e.setState({fileNames:n})}))}},{key:"setTitle",value:function(){var e=document.getElementById("LeftTitle").value;this.state.selectedObject.setTitle(e),_e()}},{key:"setContent",value:function(){var e=document.getElementById("LeftContent").value;e=e.split("\n"),this.state.selectedObject.setContent(e),_e()}},{key:"setLineType",value:function(){var e=document.getElementById("LineType").value;this.state.selectedObject.setLineType(e),_e()}},{key:"setColour",value:function(){var e=document.getElementById("LineColour").value;this.state.selectedObject.setLineColour(e),_e()}},{key:"setStartLabel",value:function(){var e=document.getElementById("SourceLabel").value;this.state.selectedObject.setStartLabel(e),_e()}},{key:"setEndLabel",value:function(){var e=document.getElementById("DestLabel").value;this.state.selectedObject.setEndLabel(e),_e()}},{key:"updateCardinality",value:function(){var e=document.getElementById("sourceFromCardindality").value,t=document.getElementById("sourceToCardindality").value,n=this.state.selectedObject.getSourceCardinalityVisibility(),a=document.getElementById("destFromCardindality").value,i=document.getElementById("destToCardindality").value,r=this.state.selectedObject.getDestCardinalityVisibility();this.state.selectedObject.updateSourceCardinality(e,t,n),this.state.selectedObject.updateDestCardinality(a,i,r),_e()}},{key:"toggleSourceCardinalityVisibility",value:function(){this.state.selectedObject.toggleSourceCardinalityVisibility(),_e()}},{key:"toggleDestCardinalityVisibility",value:function(){this.state.selectedObject.toggleDestCardinalityVisibility(),_e()}},{key:"toggleAbstract",value:function(){this.state.selectedObject.toggleAbstract(),_e()}},{key:"getS23MIconsSelector",value:function(){var e=this,t=[i.a.createElement("div",{className:"DropdownItem"},i.a.createElement("div",{className:"dropdownLabel"},"Name"),i.a.createElement("div",{className:"checkBoxContainer"},"Text"),i.a.createElement("div",{className:"checkBoxContainer"},"Icon"))],n="";return this.state.fileNames.forEach((function(a){"_n"===a.slice(-6,-4)?(n=a.slice(0,-6),t.push(i.a.createElement("div",{className:"DropdownItem",ref:a}," ",i.a.createElement("div",{className:"dropdownLabel"},n)," ",i.a.createElement("div",{className:"checkBoxContainer"},i.a.createElement("input",{type:"checkbox",disabled:"disabled"})," "),"  ",i.a.createElement("div",{className:"checkBoxContainer"},i.a.createElement("input",{type:"checkbox",defaultChecked:e.shouldIconBeSelected(a),onClick:function(){e.setIcon(a)}}))," "))):(n=a.slice(0,-4),t.push(i.a.createElement("div",{className:"DropdownItem",ref:a}," ",i.a.createElement("div",{className:"dropdownLabel"},n)," ",i.a.createElement("div",{className:"checkBoxContainer"},i.a.createElement("input",{type:"checkbox",defaultChecked:e.shouldTextBeSelected(a),onClick:function(){e.setText(a)}})," "),"  ",i.a.createElement("div",{className:"checkBoxContainer"},i.a.createElement("input",{type:"checkbox",defaultChecked:e.shouldIconBeSelected(a),onClick:function(){e.setIcon(a)}}))," ")))})),i.a.createElement(ee.a,{title:"Category Selector",name:"Icons",id:"IconSelector",className:"IconSelector"},t)}},{key:"getColourPicker",value:function(){return i.a.createElement(ee.a,{title:"Colour Selector",id:"ColourSelector"},i.a.createElement(F.SketchPicker,{color:this.getVertexColour,onChangeComplete:this.setVertexColour,presetColors:["#FFD5A9","#F5B942","#FFFFFF"]}))}},{key:"shouldTextBeSelected",value:function(e){return this.state.selectedObject.isTextSet(e)}},{key:"shouldIconBeSelected",value:function(e){return this.state.selectedObject.isIconSet(e)}},{key:"setText",value:function(e){this.state.selectedObject.setText(e),_e()}},{key:"setIcon",value:function(e){this.state.selectedObject.setIcon(e),_e()}},{key:"setNavigable",value:function(e){this.state.selectedObject.toggleNavigable(e),document.getElementById("SourceIsNavigable").checked=this.state.selectedObject.getNavigable(0),document.getElementById("DestIsNavigable").checked=this.state.selectedObject.getNavigable(1),_e()}},{key:"setAggregation",value:function(e){this.state.selectedObject.getNavigable(e)||this.state.selectedObject.toggleNavigable(e),this.state.selectedObject.toggleAggregation(e);var t=this.state.selectedObject.getAggregation(0),n=this.state.selectedObject.getAggregation(1);t&&(document.getElementById("SourceIsNavigable").checked=!0),n&&(document.getElementById("DestIsNavigable").checked=!0),document.getElementById("SourceIsAggregation").checked=t,document.getElementById("DestIsAggregation").checked=n,_e()}},{key:"deselectElement",value:function(){this.props.setLeftMenu(null),_e()}},{key:"showTreeView",value:function(){this.state.selectedObject(null),_e()}},{key:"stripElement",value:function(e){e.preventDefault(),this.state.selectedObject.trimPath(),_e()}},{key:"render",value:function(){var e=this.getMenu();return null!==this.formRef&&this.formRef.reset(),e}}]),n}(i.a.Component),ye=function(){function e(t,n,a,i){Object(o.a)(this,e),this.typeName="Arrow",void 0!==i||null===t?this.semanticIdentity=i:t.length>1?this.semanticIdentity=new y("Arrow from "+t[0].semanticIdentity.UUID+" to "+t[1].semanticIdentity.UUID,"","","",void 0,[]):1===t.length?this.semanticIdentity=new y("Arrow connecting "+t[0].semanticIdentity.UUID,"","","",void 0,[]):this.semanticIdentity=new y("Arrow connecting 1 or less vertices","","","",void 0,[]),this.sourceEdgeEnd=new B(this.semanticIdentity.UUID),this.destEdgeEnd=new B(this.semanticIdentity.UUID),1===n.length&&n.push(n[0]),this.pathData=n,this.sourceVertexUUID=null,this.destVertexUUID=null,this.updateAttachedVertices(),this.rebuildPath(),this.lineColour=S,this.lineType=L,a===fe.Edge||a===fe.Specialisation||a===fe.Visibility||console.log("Failed to find correct tool"),this.sourceEdgeEnd.type=p,a===fe.Edge?(this.destEdgeEnd.type=p,this.typeName="Edge"):a===fe.Specialisation?(this.destEdgeEnd.type=E,this.typeName="Specialisation"):a===fe.Visibility?(this.destEdgeEnd.type=b,this.lineType=U,this.typeName="Visibility"):(console.log("Failed to find correct tool"),this.destEdgeEnd.type=p),this.edgeType=a,this.selected=!1,this.sourceIsNavigable=!1,this.destIsNavigable=!1,this.sourceIsAggregation=!1,this.destIsAggregation=!1,this.arrowModelKey=Le(),this.arrowRenderKey=oa(this.arrowModelKey)}return Object(c.a)(e,[{key:"setModelKey",value:function(e){this.arrowModelKey=e}},{key:"getModelKey",value:function(){return this.arrowModelKey}},{key:"setRenderKey",value:function(e){this.arrowRenderKey=e}},{key:"getRenderKey",value:function(){return this.arrowRenderKey}},{key:"toggleNavigable",value:function(e){0===e?this.sourceIsNavigable=!this.sourceIsNavigable:1===e&&(this.destIsNavigable=!this.destIsNavigable),this.sourceIsAggregation&&(this.sourceIsNavigable=!0),this.destIsAggregation&&(this.destIsNavigable=!0),this.sourceIsNavigable&&this.destIsNavigable?this.sourceIsAggregation?(this.sourceEdgeEnd.type=k,this.destEdgeEnd.type=b):this.destIsAggregation?(this.sourceEdgeEnd.type=b,this.destEdgeEnd.type=k):(this.sourceEdgeEnd.type=b,this.destEdgeEnd.type=b):this.sourceIsNavigable?this.sourceIsAggregation?(this.sourceEdgeEnd.type=k,this.destEdgeEnd.type=p):(this.sourceEdgeEnd.type=b,this.destEdgeEnd.type=p):this.destIsNavigable?this.destIsAggregation?(this.destEdgeEnd.type=k,this.sourceEdgeEnd.type=p):(this.destEdgeEnd.type=b,this.sourceEdgeEnd.type=p):(this.sourceEdgeEnd.type=p,this.destEdgeEnd.type=p)}},{key:"toggleAggregation",value:function(e){0===e?(this.sourceIsAggregation=!this.sourceIsAggregation,this.destIsAggregation&&this.sourceIsAggregation&&(this.destIsAggregation=!1)):(this.destIsAggregation=!this.destIsAggregation,this.destIsAggregation&&this.sourceIsAggregation&&(this.sourceIsAggregation=!1)),this.sourceIsAggregation?(this.sourceEdgeEnd.type=k,this.destIsNavigable?this.destEdgeEnd.type=b:this.destEdgeEnd.type=p):this.destIsAggregation?(this.destEdgeEnd.type=k,this.sourceIsNavigable?this.sourceEdgeEnd.type=b:this.sourceEdgeEnd.type=p):this.toggleNavigable(100)}},{key:"getNavigable",value:function(e){return 0===e?this.sourceIsNavigable:this.destIsNavigable}},{key:"getAggregation",value:function(e){return 0===e?this.sourceIsAggregation:this.destIsAggregation}},{key:"trimPath",value:function(){this.pathData=[this.pathData[0],this.pathData[this.pathData.length-1]],this.path=[this.path[0],this.path[this.path.length-1]]}},{key:"rebuildPath",value:function(){var e=this.getObjectUUIDList(),t=[];e.forEach((function(e){t.push(rt(e))})),this.path=[];for(var n=0;n<this.pathData.length;n++){var a=this.pathData[n];0===a[0]?this.path.push(this.getZerothCasePathItem(t,a)):1===a[0]?this.path.push([a[1],a[2]]):console.error("Invalid PathData case, wrong case",a)}}},{key:"getZerothCasePathItem",value:function(e,t){for(var n=0;n<e.length;n++){if(null!==e[n]&&void 0!==e[n])if(e[n].semanticIdentity.UUID===t[1])return[t[2]*e[n].width+e[n].x,t[3]*e[n].realHeight+e[n].y]}return console.error("Could not find vertex to connect for pathItem",t),null}},{key:"getObjectUUIDList",value:function(){var e=this,t=[];return this.pathData.forEach((function(n){var a=e.pathData.indexOf(n);null==n&&(e.pathData[a]=[1,e.path[a][0],e.path[a][1]]),0===e.pathData[a][0]&&t.push(n[1])})),t}},{key:"updateAttachedVertices",value:function(){var e=this.pathData[0],t=this.pathData[this.pathData.length-1];0===e[0]?this.sourceVertexUUID=e[1]:this.sourceVertexUUID=null,0===t[0]?this.destVertexUUID=t[1]:this.destVertexUUID=null}},{key:"setSelected",value:function(e){this.selected=e}},{key:"updateSourceCardinality",value:function(e,t,n){this.sourceEdgeEnd.updateCardinality(e,t,n)}},{key:"getSourceCardinalityVisibility",value:function(){return this.sourceEdgeEnd.cardinality.isVisible}},{key:"toggleSourceCardinalityVisibility",value:function(){this.sourceEdgeEnd.cardinality.toggleVisibility()}},{key:"getSourceCardinalityLowerBound",value:function(){return this.sourceEdgeEnd.cardinality.lowerBound}},{key:"getSourceCardinalityUpperBound",value:function(){return this.sourceEdgeEnd.cardinality.upperBound}},{key:"updateDestCardinality",value:function(e,t,n){this.destEdgeEnd.updateCardinality(e,t,n)}},{key:"getDestCardinalityVisibility",value:function(){return this.destEdgeEnd.cardinality.isVisible}},{key:"toggleDestCardinalityVisibility",value:function(){this.destEdgeEnd.cardinality.toggleVisibility()}},{key:"getDestCardinalityLowerBound",value:function(){return this.destEdgeEnd.cardinality.lowerBound}},{key:"getDestCardinalityUpperBound",value:function(){return this.destEdgeEnd.cardinality.upperBound}},{key:"setStartLabel",value:function(e){this.sourceEdgeEnd.label=e}},{key:"setEndLabel",value:function(e){this.destEdgeEnd.label=e}},{key:"setLineColour",value:function(e){var t=j[e];void 0!==t?this.lineColour=t:console.log("Attempted to assign invalid lineColour: %s",e)}},{key:"setLineType",value:function(e){var t=T[e];void 0!==t?this.lineType=t:console.log("Attempted to assign invalid lineType: %s",e)}},{key:"createPathNodesForVertex",value:function(e,t,n){var a=t++,i=t++,r=t++,s=t++,l=t++,o=t++,c=t++,d=t++,u=[];return u.push([a,e.x-n,e.y+e.height+n,[d,i]]),u.push([i,e.x+e.width/2,e.y+e.height+n,[a,r]]),u.push([r,e.x+e.width+n,e.y+e.height+n,[i,s]]),u.push([s,e.x+e.width+n,e.y+e.height/2,[r,l]]),u.push([l,e.x+e.width+n,e.y-n,[s,o]]),u.push([o,e.x+e.width/2,e.y-n,[l,c]]),u.push([c,e.x-n,e.y-n,[l,d]]),u.push([d,e.x-n,e.y+e.height/2,[c,a]]),[t,u]}},{key:"drawStartHead",value:function(e){var t=Math.atan2(this.getSY()-this.getNSY(),this.getSX()-this.getNSX());this.sourceEdgeEnd.draw(e,this.getSX(),this.getSY(),t,this.lineColour)}},{key:"drawEndHead",value:function(e){var t=Math.atan2(this.getEY()-this.getNEY(),this.getEX()-this.getNEX());this.destEdgeEnd.draw(e,this.getEX(),this.getEY(),t,this.lineColour)}},{key:"isPathSegmentLR",value:function(e,t){var n=this.path[e][0],a=this.path[t][0],i=this.path[e][1],r=this.path[t][1];return Math.abs(n-a)>Math.abs(i-r)}},{key:"getTextOffsets",value:function(e,t,n,a,i){var r,s,l,o,c,d,u,h,f=e.measureText(t).width,m=e.measureText(n).width,y=e.measureText(a).width,v=e.measureText(i).width,g=e.measureText("M").width,p=!0,b=!0,E=!0,x=!0,w=this.path.length-2,k=this.path.length-1,I=this.isPathSegmentLR(0,1),N=this.isPathSegmentLR(w,k),S=this.path[0][0],C=this.path[0][1],M=this.path[1][0],V=this.path[1][1],O=this.path[w][0],j=this.path[w][1],L=this.path[k][0],U=this.path[k][1];return I?S>M&&(p=!p):C>V&&(b=!b),N?O>L&&(E=!E):j>U&&(x=!x),p?(r=g/2,c=I?g/2:-1*(y+g/2)):(r=-1*(f+g/2),c=I?-1*(y+g/2):g/2),b?(s=15,d=I?-7.5:s):(s=-7.5,d=I?s:-7.5),(E=!E)?(l=g/2,u=N?g/2:-1*(v+g/2)):(l=-1*(m+g/2),u=N?-1*(v+g/2):g/2),(x=!x)?(o=15,h=N?-7.5:o):(o=-7.5,h=N?15:o),[r,s,l,o,c,d,u,h]}},{key:"drawLabelsAndCardinalities",value:function(e){var t=this.sourceEdgeEnd.cardinality.toString(),n=this.destEdgeEnd.cardinality.toString(),a=this.getTextOffsets(e,this.sourceEdgeEnd.label,this.destEdgeEnd.label,t,n);e.fillStyle="#000",e.fillText(this.sourceEdgeEnd.label,this.getSX()+a[0],this.getSY()+a[1]),e.fillText(this.destEdgeEnd.label,this.getEX()+a[2],this.getEY()+a[3]),this.getSourceCardinalityVisibility()&&e.fillText(t,this.getSX()+a[4],this.getSY()+a[5]),this.getDestCardinalityVisibility()&&e.fillText(n,this.getEX()+a[6],this.getEY()+a[7])}},{key:"draw",value:function(e){switch(this.lineType){case L:e.setLineDash([]);break;case U:e.setLineDash([5,5]);break;default:console.log("Arrow had invalid lineType: %s",this.lineType)}e.strokeStyle=this.lineColour;for(var t=0;t<this.path.length-1;t++){var n=this.path[t],a=this.path[t+1];e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(a[0],a[1]),e.stroke()}if(e.strokeStyle="#000",e.setLineDash([]),this.drawStartHead(e),this.drawEndHead(e),this.drawLabelsAndCardinalities(e),this.selected)for(var i=0;i<this.path.length;i++){var r=this.path[i];xt(r[0],r[1])}}},{key:"intersects",value:function(e,t){for(var n=0;n<this.path.length-1;n++){var a=this.path[n],i=this.path[n+1];if(this.intersectsSegment(e,t,a,i))return!0}return!1}},{key:"intersectsSegment",value:function(e,t,n,a){return wt(e,t,n[0],n[1])+wt(e,t,a[0],a[1])-1<wt(n[0],n[1],a[0],a[1])}},{key:"getSX",value:function(){return this.path[0][0]}},{key:"getSY",value:function(){return this.path[0][1]}},{key:"getNSX",value:function(){return this.path[1][0]}},{key:"getNSY",value:function(){return this.path[1][1]}},{key:"getNEX",value:function(){var e=this.path.length-2;return e<0&&(e=0),this.path[e][0]}},{key:"getNEY",value:function(){var e=this.path.length-2;return e<0&&(e=0),this.path[e][1]}},{key:"getEX",value:function(){return this.path[this.path.length-1][0]}},{key:"getEY",value:function(){return this.path[this.path.length-1][1]}}]),e}(),ve=n(67),ge=function(){function e(t){Object(o.a)(this,e),this.vertex=t,this.children=new Set,this.typeName="Vertex",this.cleanObjectPath=(Ge(),"Vertices"),this.vertexObjectPath=(Ge(),"Vertices")}return Object(c.a)(e,[{key:"add",value:function(e){this.children.add(e)}},{key:"remove",value:function(e,t){console.log("remove is called");var n=!1;e.add(this),n=this.children.has(t),this.children.delete(t);var a,i=Object(l.a)(this.children);try{for(i.s();!(a=i.n()).done;){var r=a.value;e.has(r)||(e.add(r),n=r.remove(e,t))}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"getVertexNode",value:function(e,t){var n,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Object(l.a)(this.children);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(!e.has(r)){if(e.add(r),r.vertex.semanticIdentity.UUID===t.semanticIdentity.UUID)return r;if(a){var s=r.getVertexNode(e,t);if(null!==s)return s}}}}catch(o){i.e(o)}finally{i.f()}return null}},{key:"removeFromChildren",value:function(e){return!!this.children.has(e)&&(this.children.delete(e),!0)}},{key:"flatten",value:function(e){var t,n=[],a=Object(l.a)(this.children);try{for(a.s();!(t=a.n()).done;){var i=t.value;e.has(i)||(e.add(i),n.push(i.vertex),null!==i&&n.push.apply(n,Object(ve.a)(i.flatten(e))))}}catch(r){a.e(r)}finally{a.f()}return n}},{key:"flattenVertexNodes",value:function(e){var t,n=[],a=Object(l.a)(this.children);try{for(a.s();!(t=a.n()).done;){var i=t.value;e.has(i)||(e.add(i),n.push(i),null!==i&&n.push.apply(n,Object(ve.a)(i.flattenVertexNodes(e))))}}catch(r){a.e(r)}finally{a.f()}return n}},{key:"has",value:function(e,t){if(this.children.has(t))return!0;var n,a=Object(l.a)(this.children);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(!e.has(i)&&(e.add(i),i.has(e,t)))return!0}}catch(r){a.e(r)}finally{a.f()}return!1}},{key:"toTreeViewElement",value:function(e,t,n){var a=[],i=[];if("Vertex Folder"===e){for(var r=0;r<we.flatten().length;r++)if("Vertex"===we.flatten()[r].typeName&&we.flatten()[r].getRenderKey()===t&&we.flatten()[r].getModelKey()===n){""===we.flatten()[r].title?this.setVertexTreePath("Unnamed Vertex"):this.setVertexTreePath(we.flatten()[r].title);var s={text:we.flatten()[r].title,children:[],data:we.flatten()[r],renderkey:we.flatten()[r].getRenderKey(),modelkey:we.flatten()[r].getModelKey(),state:{opened:!1}};""===s.text&&(s.text="Unnamed Vertex"),i.push(s)}return{text:"Vertices &#128193",children:i,data:null,state:{opened:!0},type:"Vertex Folder"}}if("Arrow Folder"===e){for(var l=0;l<we.flatten().length;l++)if("Vertex"!==we.flatten()[l].typeName&&we.flatten()[l].getRenderKey()===t&&we.flatten()[l].getModelKey()===n){for(var o,c=we.flatten()[l].pathData[1][1],d=we.flatten()[l].pathData[0][1],u="N/A",h="N/A",f=0;f<we.flatten().length;f++){var m=we.flatten()[f];"Vertex"===m.typeName&&(c===m.semanticIdentity.UUID?(console.log("Matched1"),h=m.title):d===m.semanticIdentity.UUID&&(console.log("Matched2"),u=m.title))}var y=[!1,!1,!1,!1];y[0]=we.flatten()[l].getNavigable(0),y[1]=we.flatten()[l].getNavigable(1),y[2]=we.flatten()[l].getAggregation(0),y[3]=we.flatten()[l].getAggregation(1),console.log(y);var v="";!0===y[2]?v="&#9670":!0===y[0]&&(v="&#10229"),v+="&#8213",!0===y[3]?v+="&#9670":!0===y[1]&&(v+="&#10230"),o=u+" "+v+" "+h;var g={text:we.flatten()[l].typeName+" - "+o,children:[],data:we.flatten()[l],renderkey:we.flatten()[l].getRenderKey(),modelkey:we.flatten()[l].getModelKey(),state:{opened:!1}};a.push(g)}return{text:"Arrows &#128193",children:a,data:null,state:{opened:!0},type:"Arrow Folder"}}}},{key:"setTreeViewElement",value:function(e){return{text:e,children:[],state:{opened:!0}}}},{key:"setVertexTreePath",value:function(e){this.vertexObjectPath=this.cleanObjectPath+"/"+e}},{key:"returnVertexTreePath",value:function(){return this.vertexObjectPath}}]),e}(),pe=function(){function e(t,n){Object(o.a)(this,e),this.arrow=n,this.updateVertices(t)}return Object(c.a)(e,[{key:"updateVertices",value:function(e){if(this.sourceVertexNodeObject=null,this.destVertexNodeObject=null,null!==this.arrow){var t,n=null===this.arrow.sourceVertexUUID,a=null===this.arrow.destVertexUUID,i=Object(l.a)(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(n&&a)break;null!==r&&(r.vertex.semanticIdentity.UUID===this.arrow.sourceVertexUUID?(this.sourceVertexNodeObject=r,n=!0):r.vertex.semanticIdentity.UUID===this.arrow.destVertexUUID&&(this.destVertexNodeObject=r,a=!0))}}catch(s){i.e(s)}finally{i.f()}}}},{key:"sourceVertexNode",set:function(e){this.sourceVertexNodeObject=e,this.arrow.sourceVertexUUID=null!==e?e.vertex.semanticIdentity.UUID:null},get:function(){return this.sourceVertexNodeObject}},{key:"sourceVertex",get:function(){return null!==this.sourceVertexNodeObject?this.sourceVertexNodeObject.vertex:null}},{key:"destVertexNode",set:function(e){this.destVertexNodeObject=e,this.arrow.destVertexUUID=null!==e?e.vertex.semanticIdentity.UUID:null},get:function(){return this.destVertexNodeObject}},{key:"destVertex",get:function(){return null!==this.destVertexNodeObject?this.destVertexNodeObject.vertex:null}}]),e}(),be=function(){function e(t,n){Object(o.a)(this,e),this.rootVertices=new Set,void 0!==t&&this.add(t),this.arrows=new Set,void 0!==n&&this.add(n)}return Object(c.a)(e,[{key:"add",value:function(e){Array.isArray(e)||(e=[e]);var t,n=Object(l.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;switch(a.constructor.name){case"Vertex":console.log("add vert trigs"),this.addVertex(a);break;case"Arrow":this.addArrow(a);break;case"VertexNode":this.rootVertices.add(a);break;case"ArrowEdge":this.arrows.add(a);break;default:console.error("Attempted to add object to unknown type %s to Graph",a.constructor.name),console.log(a),console.log(a.constructor)}}}catch(i){n.e(i)}finally{n.f()}}},{key:"addVertex",value:function(e){null===this.getVertexNode(e)?(e=new ge(e),this.rootVertices.add(e)):console.error("Attempted to add duplicate vertex")}},{key:"addArrow",value:function(e){if(null===this.getArrowEdge(e)){if(e=new pe(this.flattenVertexNodes(),e),this.arrows.add(e),null!==e.destVertexNode&&null!==e.sourceVertexNode&&(e.destVertexNode.add(e.sourceVertexNode),this.rootVertices.has(e.sourceVertexNode))){var t,n=!1,a=Object(l.a)(this.rootVertices);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.vertex.semanticIdentity.UUID!==e.sourceVertex.semanticIdentity.UUID&&(i.has(new Set,e.sourceVertexNode)&&(n=!0))}}catch(r){a.e(r)}finally{a.f()}n&&this.rootVertices.delete(e.sourceVertexNode)}}else console.error("Attempted to add duplicate arrow")}},{key:"ArrowUUIDSource",value:function(e){e=this.getVertexNode(e);var t,n=[],a=0,i=Object(l.a)(this.arrows);try{for(i.s();!(t=i.n()).done;){var r=t.value;null!==r.sourceVertexNode&&r.sourceVertex.semanticIdentity.UUID===e.vertex.semanticIdentity.UUID&&(n[a]=r,a+=1)}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"ArrowUUIDDest",value:function(e){e=this.getVertexNode(e);var t,n=[],a=0,i=Object(l.a)(this.arrows);try{for(i.s();!(t=i.n()).done;){var r=t.value;null!==r.destVertexNode&&r.destVertex.semanticIdentity.UUID===e.vertex.semanticIdentity.UUID&&(n[a]=r,a+=1)}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"remove",value:function(e){if(console.log("remove 2 is called"),console.log(this.rootVertices),"Vertex"===e.constructor.name){var t=this.getVertexNode(e),n=this.rootVertices.has(t);console.log(n),this.rootVertices.delete(t);var a,i=Object(l.a)(t.children);try{for(i.s();!(a=i.n()).done;){var r=a.value;this.rootVertices.add(r)}}catch(w){i.e(w)}finally{i.f()}var s,o=new Set,c=Object(l.a)(this.rootVertices);try{for(c.s();!(s=c.n()).done;){var d=s.value;o.has(d)||(o.add(d),d.remove(o,t),console.log(n))}}catch(w){c.e(w)}finally{c.f()}if(n){var u,h=Object(l.a)(this.arrows);try{for(h.s();!(u=h.n()).done;){var f=u.value;null!==f.sourceVertexNode&&f.sourceVertex.semanticIdentity.UUID===t.vertex.semanticIdentity.UUID&&(f.sourceVertexNode=null),null!==f.destVertexNode&&f.destVertex.semanticIdentity.UUID===t.vertex.semanticIdentity.UUID&&(f.destVertexNode=null)}}catch(w){h.e(w)}finally{h.f()}}return n}if("Arrow"===e.constructor.name){var m=this.getArrowEdge(e);if(null!==m){if(this.arrows.delete(m),null!==m.sourceVertexNode&&null!==m.destVertexNode){var y,v=!1,g=!1,p=Object(l.a)(this.arrows);try{for(p.s();!(y=p.n()).done;){var b=y.value,E=null!==b.sourceVertexNode&&b.sourceVertex.semanticIdentity.UUID===m.sourceVertex.semanticIdentity.UUID,x=null!==b.destVertexNode&&b.destVertex.semanticIdentity.UUID===m.destVertex.semanticIdentity.UUID;E&&x&&(v=!0),E&&null!==b.destVertexNode&&(g=!0)}}catch(w){p.e(w)}finally{p.f()}v||m.destVertexNode.removeFromChildren(m.sourceVertexNode),g||this.add(m.sourceVertexNode),m.sourceVertexNode.has(new Set,m.destVertexNode)&&this.rootVertices.delete(m.destVertexNode)}return!0}}else null!==e?console.error("Attempted to remove object of invalid type %s to Graph",e.constructor.name):console.error("Attempted to remove null from Graph");return!1}},{key:"has",value:function(e){if(this.rootVertices.has(e))return!0;var t,n=new Set,a=Object(l.a)(this.rootVertices);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!n.has(i)&&(n.add(i),i.has(n,e)))return!0}}catch(r){a.e(r)}finally{a.f()}return!1}},{key:"getVertexNode",value:function(e){var t,n=new Set,a=Object(l.a)(this.rootVertices);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!n.has(i)){if(n.add(i),i.vertex.semanticIdentity.UUID===e.semanticIdentity.UUID)return i;var r=i.getVertexNode(n,e);if(null!==r)return r}}}catch(s){a.e(s)}finally{a.f()}return null}},{key:"getArrowEdge",value:function(e){var t,n=Object(l.a)(this.arrows);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.arrow.semanticIdentity.UUID===e.semanticIdentity.UUID)return a}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"flatten",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new Set,a=new Set,i=new Set;if(e){var r,s=Object(l.a)(this.rootVertices);try{for(s.s();!(r=s.n()).done;){var o=r.value;if(!i.has(o)&&(i.add(o),n.add(o.vertex),null!==o)){var c,d=Object(l.a)(o.flatten(i));try{for(d.s();!(c=d.n()).done;){var u=c.value;n.add(u)}}catch(v){d.e(v)}finally{d.f()}}}}catch(v){s.e(v)}finally{s.f()}}if(t){var h,f=Object(l.a)(this.arrows);try{for(f.s();!(h=f.n()).done;){var m=h.value;a.add(m.arrow)}}catch(v){f.e(v)}finally{f.f()}}var y=Array.from(n);return y.concat(Array.from(a))}},{key:"flattenVertexNodes",value:function(){var e,t=new Set,n=new Set,a=Object(l.a)(this.rootVertices);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(!n.has(i)&&(n.add(i),t.add(i),null!==i)){var r,s=Object(l.a)(i.flattenVertexNodes(n));try{for(s.s();!(r=s.n()).done;){var o=r.value;t.add(o)}}catch(c){s.e(c)}finally{s.f()}}}}catch(c){a.e(c)}finally{a.f()}return Array.from(t)}}]),e}(),Ee=70,xe=200,we=new be,ke=[],Ie=0,Ne=0,Se=0,Ce=0;function Me(){return Ie}function Ve(e){Ie=e}function Oe(){return Ne}function je(){Ne=Ne+=1}function Le(){return Se}function Ue(e){Se=e}function De(){return Ce}function Te(){Ce=Ce+=1}var Ae,Be=[],Ke=0,Fe=0,Re=!1,Pe=0,He=!0,Ye=!1,Xe=[],ze=[],We=!1;function Ge(){var e=document.getElementById("ModelName");return null===e||""===e.value||null===e.value||void 0===e.value?"Root":e.value}function Je(){try{var e=ie.getBoundingClientRect();ce=e.left,de=e.top,function(){var e=document.getElementsByClassName("Canvas")[0],t=+getComputedStyle(e).getPropertyValue("height").slice(0,-2),n=+getComputedStyle(e).getPropertyValue("width").slice(0,-2);ie.setAttribute("height",t*Ct()),ie.setAttribute("width",n*Ct()),ue=ie.width,he=ie.height}(),Mt()}catch(t){console.error("Failed to acquire canvas element")}_e()}function _e(){pt(),Mt(),re.resetTransform(),re.scale(Ct(),Ct()),we.flatten().forEach((function(e){null!==e&&e.getModelKey()===Se&&e.draw(re)}))}function qe(e){null!==e?we.remove(e)||console.error("Failed to delete object with UUID %s",e.semanticIdentity.UUID):console.error("Attempted to delete a null element"),_e()}function Ze(e,t){var n=he/Ee*xe/100*200/xe;return n*Math.floor(e/n)+n/2*+t}function $e(e,t){for(var n=we.flatten(),a=0;a<n.length;a++){var i=n[a];if("Vertex"===i.constructor.name){var r=i.getBounds(),s=r[0],l=r[1],o=r[2],c=r[3],d=Math.abs(l-t)<10,u=Math.abs(c-t)<10,h=Math.abs(s-e)<10,f=Math.abs(o-e)<10,m=t>l&&t<c,y=e>s&&e<o;if(f&&m)return[i,"right"];if(d&&h)return[i,"topLeft"];if(d&&f)return[i,"topRight"];if(u&&h)return[i,"bottomLeft"];if(u&&f)return[i,"bottomRight"];if(h&&m)return[i,"left"];if(f&&m)return[i,"right"];if(d&&y)return[i,"top"];if(u&&y)return[i,"bottom"]}}return[null,null]}var Qe=15;function et(e,t){var n=null,a=0;we.flatten().forEach((function(i){if(null!==i&&"Vertex"===i.constructor.name){var r=i.getNearestSideFrom(e,t,Ke,Fe);null!==r&&r[0]<Qe&&(null===n||r[0]<a)&&(n=[0,i.semanticIdentity.UUID,r[1],r[2]],a=r[0])}}));var i=n;if(null===n&&(i=[1,e,t]),Be.length<1||0===i[0])return{coord:i,snapped:null!==n,nearest:n};var r=Be[Be.length-1][1],s=Be[Be.length-1][2],l=i[1]-r,o=i[2]-s,c=Math.atan2(o,l)*(180/Math.PI),d=(c=(c+360)%360)%90;if(d>82||d<8){for(var u=wt(0,0,l,o),h=[0,90,180,270,360],f=h[0],m=1;m<h.length;m++)Math.abs(h[m]-c)<Math.abs(f-c)&&(f=h[m]);var y=f*(Math.PI/180),v=u*Math.cos(y),g=u*Math.sin(y);i=[i[0],r+v,s+g]}return{coord:i,snapped:null!==n,nearest:n}}function tt(e){return e.props.mainState.selectedObject}function nt(e,t){var n=Nt(e);t[0].expandSide(t[1],n[0],n[1],re),function(){var e=0;we.flatten().forEach((function(t){"Arrow"===t.constructor.name&&(e=et(t.path[1][0],t.path[1][1]),t.pathData[1]=e.nearest,st(e,t,0))}))}()}function at(e){null!==e&&void 0!==e&&we.add(e)}function it(){return Pe===fe.Visibility||Pe===fe.Edge||Pe===fe.Specialisation}function rt(e){var t;return we.flatten().forEach((function(n){n.semanticIdentity.UUID===e&&(t=n)})),t}function st(e,t,n){if(!1===e.snapped){var a=e.coord;t.path[n]=[a[1],a[2]]}else{void 0!==rt(e.nearest[1])&&(t.path[n]=t.rebuildPath())}}function lt(e,t,n){var a=$e(t,n);if(e.tool===fe.Vertex||e.tool===fe.Select){if(null!==a[0]&&a[0]===tt(e))return ot(e,t,n),Re=!0,void(ie.onmousemove=function(e){nt(e,a)});var i=kt(t,n);if(e.tool===fe.Vertex&&null!==i)return e.props.setLeftMenu(i),e.props.setMode(fe.Select),void(Ye=!0)}if(e.tool===fe.Select){var r,s,l=function(e,t){var n,a=-1,i=30,r=null;return we.flatten().forEach((function(s){"Arrow"===s.constructor.name&&s.path.forEach((function(l){n=Math.hypot(e-l[0],t-l[1]),console.log(n),n<i&&(i=n,a=s.path.indexOf(l),r=s)}))})),[a,r]}(t,n),o=Object(m.a)(l,2);if(r=o[0],(s=o[1])===tt(e)&&-1!==r){Re=!0;var c=function(e){!function(e,t,n){var a=Nt(e),i=Object(m.a)(a,2),r=et(i[0],i[1]);n.pathData[t]=r.nearest,st(r,n,t)}(e,r,s)};ie.addEventListener("mousemove",c),ie.addEventListener("mouseup",(function(){ie.removeEventListener("mousemove",c),console.log("removed")}))}}se=t,le=n,ie.onmousemove=function(t){yt(t,e)}}function ot(e,t,n){Ae=tt(e),null===tt(e)&&(Ae=kt(t,n)),null!==Ae&&(We=!0,Xe=[Ae.x,Ae.y],ze=[Ae.width,Ae.height])}function ct(e){var t,n,a=[],i=[],r=[];return t=e.semanticIdentity.UUID,console.log(t),we.flatten().forEach((function(s){"Arrow"===s.constructor.name&&(t===s.destVertexUUID?(((n=rt(s.sourceVertexUUID)).height+10)*n.width<(e.height+10)*e.width&&r.push(n),s.path[0][1]<e.y||s.path[0][1]>e.y+e.height+10?a.push(s):(s.path[0][0]<e.x||s.path[0][0]>e.x+e.width)&&i.push(s)):t===s.sourceVertexUUID&&(((n=rt(s.destVertexUUID)).height+10)*n.width<(e.height+10)*e.width&&r.push(n),s.path[1][1]<e.y||s.path[1][1]>e.y+e.height+10?a.push(s):(s.path[1][0]<e.x||s.path[1][0]>e.x+e.width)&&i.push(s)))})),[r,a,i]}function dt(e,t,n,a,i){if(n.semanticIdentity.UUID===a.destVertexUUID){var r=rt(a.sourceVertexUUID);n.y*i+r.y*(1-i)>(r.y+r.height+10)*i+(n.y+n.height+10)*(1-i)&&(e.push(r),t.push(a))}else if(n.semanticIdentity.UUID===a.sourceVertexUUID){var s=rt(a.destVertexUUID);n.y*i+s.y*(1-i)>(s.y+s.height+10)*i+(n.y+n.height+10)*(1-i)&&(e.push(s),t.push(a))}return[e,t]}function ut(e,t,n,a){if(t.length>=2){for(var i=0,r=e.x,s=e.y+(e.height+30)*(1-a);i<t.length;i++)t[i].x=r,t[i].y=s-(t[i].height+30)*a,r=r+t[i].width+20,t[i].x+t[i].width>e.x+e.width&&(e.width=e.width+t[i].width);for(i=0;i<t.length;i++){console.log(n[i]);var l=et(t[i].x+t[i].width/2,e.y+(e.height+10)*(1-a));n[i].pathData[1]=l.nearest,st(l,n[i],1)}}}function ht(e,t,n,a,i){if(n.semanticIdentity.UUID===a.destVertexUUID){var r=rt(a.sourceVertexUUID);n.x*i+r.x*(1-i)>(r.x+r.width)*i+(n.x+n.width)*(1-i)&&(e.push(r),t.push(a))}else if(n.semanticIdentity.UUID===a.sourceVertexUUID){var s=rt(a.destVertexUUID);n.x*i+s.x*(1-i)>(s.x+s.width)*i+(n.x+n.width)*(1-i)&&(e.push(s),t.push(a))}return[e,t]}function ft(e,t,n,a){if(t.length>=2){for(var i=0,r=e.x+(e.width+30)*(1-a),s=e.y;i<t.length;i++)t[i].x=r-(t[i].width+30)*a,t[i].y=s,s=s+t[i].height+20,t[i].y+t[i].height+10>e.y+e.height+10&&(e.height=e.height+t[i].height);for(i=0;i<t.length;i++){console.log(n[i]);var l=et(e.x+e.width*(1-a),t[i].y+(t[i].height+10)/2);n[i].pathData[1]=l.nearest,st(l,n[i],1)}}}function mt(e,t,n){if(Ye)Ye=!1;else{if(!0===Re)return Re=!1,void(ie.onmousemove=null);if(ie.onmousemove=null,it())if(et(t,n).snapped&&!He){var a=kt(t,n),i=null;null!==Be[0]&&null!==a&&null!==ke&&(i=It(e,se,le,t,n)),Be=[],He=!0,null!==i&&at(i),_e();var r=0;we.flatten().forEach((function(e){"Arrow"===e.constructor.name&&(ke[r]=e.path,r++)})),null!==i&&e.props.setLeftMenu(i),e.props.setMode(fe.Select),null!==oe&&null!==a&&function(e){var t,n,a=[],i=[],r=[],s=[],l=[],o=[],c=[],d=[],u=(n=e,(t=oe).width*(t.height+10)<=n.width*(n.height+10)?[n,t]:[t,n]),h=Object(m.a)(u,2),f=h[0],y=h[1];we.flatten().forEach((function(e){if("Arrow"===e.constructor.name)if(f.y+f.height+10<y.y&&y.x>f.x&&y.x+y.width<f.x+f.width){var t=dt(r,s,f,e,0),n=Object(m.a)(t,2);r=n[0],s=n[1]}else if(f.y>y.y+y.height+10&&y.x>f.x&&y.x+y.width<f.x+f.width){var u=dt(a,i,f,e,1),h=Object(m.a)(u,2);a=h[0],i=h[1]}else if(f.x>y.x+y.width&&y.y>f.y&&y.y+y.height+10<f.y+f.height+10){console.log("left ran");var v=ht(l,o,f,e,1),g=Object(m.a)(v,2);l=g[0],o=g[1]}else if(f.x+f.width<y.x&&y.y>f.y&&y.y+y.height+10<f.y+f.height+10){console.log("right ran");var p=ht(c,d,f,e,0),b=Object(m.a)(p,2);c=b[0],d=b[1]}})),ut(f,r,s,0),ut(f,a,i,1),ft(f,l,o,1),ft(f,c,d,0)}(a),oe=null}else oe=kt(t,n),Be.push(et(t,n).coord),Ke=t,Fe=n,ie.onmousemove=function(t){yt(t,e)},He=!1;if(e.tool===fe.Vertex){var s=It(e,se,le,t,n);at(s),e.props.setLeftMenu(s),e.props.setMode(fe.Select)}if(e.tool===fe.Artifact){var l=function(e,t,n){we.flatten();if(e.tool===fe.Artifact){var a=St(t,n,t+450,n+50),i=Ze(a[1],0),r=Ze(a[3],0);return new g("",[""],a[0],Ze(n,1),a[2]-a[0],r-i)}return null}(e,se,le);at(l),e.props.setLeftMenu(l),e.props.setMode(fe.Select)}if(e.tool===fe.Container){var o=function(e,t,n){we.flatten();if(e.tool===fe.Container){var a=St(t,n,t+100,n+60),i=Ze(a[1],0),r=Ze(a[3],0);return new g("",[""],a[0],Ze(n,1),a[2]-a[0],r-i)}return null}(e,se,le);o.setColour("#FFFFFF"),at(o),e.props.setLeftMenu(o),e.props.setMode(fe.Select)}_e()}}function yt(e,t){var n=Nt(e);_e();var a=It(t,se,le,n[0],n[1]);re.globalAlpha=.75,null!==a&&a.draw(re),re.globalAlpha=1}function vt(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t,n;var r=kt(t,n),s=ct(r),l=Object(m.a)(s,3),o=l[0],c=l[1],d=l[2];if(null!==o||o.length>=1){for(var u=o,h=[],f=0;f<u.length;f++){var y=ct(u[f]),v=Object(m.a)(y,3),g=v[0];v[1],v[2];if(null!==g){for(var p=0;p<g.length;p++){console.log(u.length);for(var b=0;b<u.length;b++)g[p].semanticIdentity.UUID===u[b].semanticIdentity.UUID&&g.splice(p,1)}if(g.length>=1)for(var E=0;E<g.length;E++)h.push(g[E]),o.push(g[E])}}u=h}var x=[];if(null!==o)for(var w=0;w<o.length;w++)x.push([t-o[w].x,n-o[w].y]);var k=[];if(null!==a)for(var I=0;I<a.length;I++)k.push([t-a[I].x,n-a[I].y]);if(null!==r){ot(e,t,n);var N=t-r.x,S=n-r.y;ie.onmousemove=function(e){gt(e,r,o,x,a,k,N,S,c,d,i)}}}function gt(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,o=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0;if(null!=t)if("Vertex"===t.constructor.name){var u=Nt(e),h=u[0]-s,f=u[1]-l;if(d&&null!==n)for(var m=0;m<n.length;m++)n[m].x=u[0]-a[m][0],n[m].y=u[1]-a[m][1];if(null!==i)for(var y=0;y<i.length;y++)i[y].x=u[0]-r[y][0],i[y].y=u[1]-r[y][1];if(null!==o)for(var v=0,g=0;g<o.length;g++)o[g].path[1][0]=o[g].path[0][0],null!==(v=et(o[g].path[1][0],o[g].path[1][1])).nearest?(o[g].pathData[1]=v.nearest,st(v,o[g],0)):qe(o[g]);if(null!==c)for(var p=0,b=0;b<c.length;b++)c[b].path[1][1]=c[b].path[0][1],null!==(p=et(c[b].path[1][0],c[b].path[1][1])).nearest?(c[b].pathData[1]=p.nearest,st(p,c[b],0)):qe(c[b]);t.x=h,t.y=f,pt()}else if("Arrow"===t.constructor.name)return}function pt(){we.flatten().forEach((function(e){null!==e&&"Arrow"===e.constructor.name&&e.rebuildPath()}))}function bt(){ie.onmousemove=null}function Et(e){xe=e,Je(),_e()}function xt(e,t){var n=re.lineWidth;re.lineWidth=.5;var a=re.strokeStyle;re.strokeStyle="#007ACC";var i=re.fillStyle;re.fillStyle="#007ACC55",re.globalAlpha=1,re.beginPath(),re.arc(e,t,2,0,2*Math.PI,!1),re.fill(),re.stroke(),re.closePath(),re.lineWidth=n,re.strokeStyle=a,re.fillStyle=i}function wt(e,t,n,a){return Math.sqrt(Math.pow(n-e,2)+Math.pow(a-t,2))}function kt(e,t){var n=null;return we.flatten().forEach((function(a){null!==a&&a.intersects(e,t)&&(n=a)})),n}function It(e,t,n,a,i){var r,s=we.flatten();if("Vertex"===e.tool){var l=St(t,n,a+10,i),o=Ze(l[1],0),c=Ze(l[3],0);return new g("",[""],l[0],Ze(n,1),l[2]-l[0],c-o)}if(it()){if(0!==(r=Be.concat([et(a,i).coord]))[0][0])return null;var d=new ye(s,r,Pe);return d.rebuildPath(s),d}return null}function Nt(e){return Je(),[(e.clientX-ce)/Ct(),(e.clientY-de)/Ct()]}function St(e,t,n,a){return[Math.min(e,n),Math.min(t,a),Math.max(e,n),Math.max(t,a)]}function Ct(){return xe/100}function Mt(){re.fillStyle="#ffffff",re.fillRect(0,0,ue,he)}var Vt,Ot=n(26),jt=n.n(Ot),Lt=n(59),Ut=n(111),Dt=n(215),Tt=n(463),At=n(474),Bt=n(471),Kt=n(467),Ft=n(414),Rt=n(468),Pt=n(472),Ht=n(469),Yt=n(7),Xt=n(8),zt=n(192),Wt=n.n(zt),Gt=n(135),Jt=n(213),_t=n(75),qt=n(193),Zt=n(53),$t=n(1),Qt=null,en=null,tn=i.a.createRef(),nn=[],an=function(e){e.xlsx.writeBuffer().then((function(e){Wt()(new Blob([e],{type:"application/octet-stream"}),"DataGrid.xlsx")}))},rn=function(e){return e.id},sn=function(){return{input:{fontSize:"14px",width:"90px"},label:{fontSize:"14px"},container:{maxWidth:"18em"},selector:{height:"32px"}}},ln=Object(Yt.a)(sn,{name:"StartEditActionSelector"})((function(e){var t=e.defaultAction,n=e.changeAction,a=e.classes;return i.a.createElement(Rt.a,{container:!0,alignItems:"center",className:a.container},i.a.createElement(Ft.a,{className:a.label},"Start Edit Action: \xa0"),i.a.createElement(Bt.a,{onChange:function(e){return n(e.target.value)},value:t,className:a.selector,input:i.a.createElement(At.a,{classes:{input:a.input},labelWidth:0,margin:"dense"})},i.a.createElement(Kt.a,{value:"click"},"Click"),i.a.createElement(Kt.a,{value:"doubleClick"},"Double Click")))})),on=Object(Yt.a)(sn,{name:"SelectTextChecker"})((function(e){var t=e.isSelectText,n=e.changeSelectText,a=e.classes;return i.a.createElement(Ht.a,{control:i.a.createElement(Pt.a,{checked:t,onChange:function(e){return n(e.target.checked)},color:"primary"}),classes:{label:a.label},label:"Select Text On Focus"})})),cn=function(e){return i.a.createElement($t.g,{name:"EditPropsPanel"},i.a.createElement($t.k,{name:"toolbarContent"},i.a.createElement(on,e),i.a.createElement($t.m,null),i.a.createElement(ln,e)))},dn=function(e){var t=e.onClick,n=Object(Dt.a)(e,["onClick"]);return i.a.createElement(Zt.c.Cell,Object.assign({},n,{tabIndex:0,onFocus:t}))},un=function(){var e=Object(a.useState)(mn()),t=Object(m.a)(e,2),n=t[0],r=t[1];en=r;var s=Object(a.useState)([{columnName:"UUID",editingEnabled:!1},{columnName:"type",editingEnabled:!1}]),o=Object(m.a)(s,1)[0],c=Object(a.useState)([]),d=Object(m.a)(c,2),u=d[0],h=d[1];Vt=u,Qt=h;var f=Object(a.useState)([{columnName:"UUID",wordWrapEnabled:!0},{columnName:"type",wordWrapEnabled:!0},{columnName:"name",wordWrapEnabled:!0},{columnName:"description",wordWrapEnabled:!0},{columnName:"abbreviation",wordWrapEnabled:!0},{columnName:"shortAbbreviation",wordWrapEnabled:!0}]),y=Object(m.a)(f,1)[0],v=Object(a.useState)("click"),g=Object(m.a)(v,2),p=g[0],b=g[1],E=Object(a.useState)(!0),x=Object(m.a)(E,2),w=x[0],k=x[1],I=Object(a.useRef)(null),N=Object(a.useCallback)((function(){I.current.exportGrid()}),[I]);return i.a.createElement(Tt.a,null,i.a.createElement(Gt.a,null,i.a.createElement(Jt.a,{ref:tn,placeholder:"Column name","aria-label":"Column name","aria-describedby":"basic-addon2"}),i.a.createElement(Gt.a.Append,null,i.a.createElement(_t.a,{variant:"outline-secondary",onClick:function(){return function(){var e=tn.current.value;if(tn.current.value="",""===e||null===e||void 0===e)return;nn.push(e),hn()}()}},"Add"),i.a.createElement(_t.a,{variant:"outline-secondary",onClick:function(){return function(){var e=tn.current.value;tn.current.value="";var t,n=Object(l.a)(we.flatten());try{for(n.s();!(t=n.n()).done;){t.value.semanticIdentity.translations.delete(e)}}catch(a){n.e(a)}finally{n.f()}nn.splice(nn.indexOf(e),1),hn()}()}},"Remove"))),i.a.createElement(Zt.b,{rows:Vt,columns:n,getRowId:rn},i.a.createElement(Xt.c,{onCommitChanges:function(e){var t,n=e.added,a=e.changed,i=e.deleted;if(n){var r=Vt.length>0?Vt[Vt.length-1].id+1:0;t=[].concat(Object(ve.a)(Vt),Object(ve.a)(n.map((function(e,t){return Object(Ut.a)({id:r+t},e)}))))}if(a&&function(e){for(var t=we.flatten(),n=0;n<e.length;n++)for(var a=0;a<t.length;a++)e[n]=yn(t[a],e[n]),"Arrow"===t[a].constructor.name&&(e[n]=yn(t[a].sourceEdgeEnd,e[n]),e[n]=yn(t[a].destEdgeEnd,e[n]))}(t=Vt.map((function(e){return a[e.id]?Object(Ut.a)(Object(Ut.a)({},e),a[e.id]):e}))),i){var s=new Set(i);t=Vt.filter((function(e){return!s.has(e.id)}))}Qt(t)},columnExtensions:o}),i.a.createElement(Zt.c,{cellComponent:dn,columnExtensions:y}),i.a.createElement(Zt.d,null),i.a.createElement(Zt.f,null),i.a.createElement(cn,{defaultAction:p,changeAction:b,isSelectText:w,changeSelectText:k}),i.a.createElement(Zt.a,{startExport:N}),i.a.createElement(Zt.e,{startEditAction:p,selectTextOnEditStart:w})),i.a.createElement(qt.a,{ref:I,rows:Vt,columns:n,onSave:an}))};function hn(){en(mn())}function fn(e){var t={};t.id=e.semanticIdentity.UUID,t.UUID=e.semanticIdentity.UUID,t.type=e.constructor.name,t.name=e.semanticIdentity.name,t.description=e.semanticIdentity.description,t.abbreviation=e.semanticIdentity.abbreviation,t.shortAbbreviation=e.semanticIdentity.shortAbbreviation;for(var n=0;n<e.semanticIdentity.translations.length;n++){var a=e.semanticIdentity.translations[n];t[a[0]]=a[1]}return t}function mn(){var e,t=[{name:"UUID",title:"UUID"},{name:"type",title:"Type"},{name:"name",title:"Name"},{name:"description",title:"Description"},{name:"abbreviation",title:"Abbreviation"},{name:"shortAbbreviation",title:"Short Abbreviation"}],n=Object(l.a)(nn);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push({name:a,title:a})}}catch(i){n.e(i)}finally{n.f()}return t}function yn(e,t){if(e.semanticIdentity.UUID===t.UUID){e.semanticIdentity.abbreviation=t.abbreviation,e.semanticIdentity.shortAbbreviation=t.shortAbbreviation,e.semanticIdentity.name=t.name,e.semanticIdentity.description=t.description;var n,a=Object(l.a)(nn);try{for(a.s();!(n=a.n()).done;){for(var i=n.value,r=!1,s=0;s<e.semanticIdentity.translations.length;s++)if(e.semanticIdentity.translations[s][0]===i){e.semanticIdentity.translations[s][1]=t[i],r=!0;break}r||e.semanticIdentity.translations.push([i,t[i]])}}catch(o){a.e(o)}finally{a.f()}}return t}function vn(){var e=function(){var e=we.flatten(!0,!1),t=we.flatten(!1,!0);return{version:An,translationColumns:nn,vertices:e,arrows:t,modelName:Ge()}}(),t=JSON.stringify(e),n=document.createElement("a"),a=new Blob([t],{type:"text/json"});n.href=URL.createObjectURL(a);var i=Ge();""===i&&(i="untitled"),n.download=i+".json",document.body.appendChild(n),n.click()}function gn(e,t){switch(e.typeName){case"Vertex":return new g(e.title,e.content,e.x,e.y,e.width,e.height,e.semanticIdentity);case"Arrow":case"Edge":case"Specialisation":case"Visibility":var n=new ye(t,e.pathData,e.edgeType,gn(e.semanticIdentity));return n.sourceEdgeEnd=gn(e.sourceEdgeEnd),n.destEdgeEnd=gn(e.destEdgeEnd),n;case"Cardinality":return new A(e.numLowerBound,e.numUpperBound,e.attachedToUUID,e.isVisible,gn(e.semanticIdentity));case"EdgeEnd":return new B(e.attachedToUUID,e.headType,gn(e.cardinality),e.label,gn(e.semanticIdentity));case"SemanticIdentity":return new y(e.name,e.description,e.abbreviation,e.shortAbbreviation,e.UUID,e.translations);default:console.error("Unknown object to deserialise ",e)}}function pn(e){var t,n;if(null!=e)try{var a=JSON.parse(e);n=a.translationColumns,nn=n,hn();var i,r=[],s=[],o=Object(l.a)(a.vertices);try{for(o.s();!(i=o.n()).done;){var c=i.value;null!==c&&r.push(gn(c))}}catch(f){o.e(f)}finally{o.f()}var d,u=Object(l.a)(a.arrows);try{for(u.s();!(d=u.n()).done;){var h=d.value;null!==h&&s.push(gn(h,r))}}catch(f){u.e(f)}finally{u.f()}t=new be(r,s),we=t,_e(),pt()}catch(m){alert(m)}}var bn=n(212),En=!1,xn=!1,wn=[],kn=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).ocm=function(e){e.preventDefault()},a.mouseDown=function(e,t){var n=Nt(e),i=n[0],r=n[1];if(a.setState({startX:i,startY:r}),e.shiftKey&&!xn&&(xn=!0),0===e.button&&!En){var s=kt(i,r);null!==s&&t.tool===fe.Select&&"Vertex"===s.constructor.name?(e.preventDefault(),a.props.setLeftMenu(kt(i,r)),vt(t,i,r,null,xn)):(a.props.setLeftMenu(kt(i,r)),ot(t,i,r),lt(t,i,r))}if(e.ctrlKey&&!En&&(En=!0),0===e.button&&En){var l=kt(i,r);if(null===l&&(a.props.setLeftMenu(l,!1,wn),wn=[],En=!1),null!==l){for(var o=0;o<wn.length-1;){for(var c=o+1;c<wn.length;c++)wn[o].x===wn[c].x&&wn[o].y===wn[c].y&&wn.splice(c);o++}console.log(wn),wn.push(kt(i,r)),vt(t,i,r,wn);for(var d=0;d<wn.length;d++)a.props.setLeftMenu(wn[d],En)}}1===e.button&&(e.preventDefault(),vt(t,i,r))},a.mouseUp=function(e,t){bt();var n=Nt(e),a=n[0],i=n[1];0===e.button&&(t.tool===fe.Select?_e():mt(t,a,i)),e.button,e.shiftKey&&xn&&(xn=!1),1===e.button&&window.setTimeout((function(){bt()}),200),!0===We&&function(e,t,n){var a=Ae,i=0;null!==we.flatten()&&null!==a&&(we.flatten().forEach((function(e){"Vertex"===e.constructor.name&&(a.x===e.x&&a.y===e.y||a.y>e.y+e.height+10||a.x>e.x+e.width||e.x>a.x+a.width||e.y>a.y+a.height+10||(a.x=Xe[0],a.y=Xe[1],a.width=ze[0],a.height=ze[1],i++))})),0===i&&(Xe=[a.x,a.y],ze=[a.width,a.height]),We=!1,_e())}()},a.canvasRef=i.a.createRef(),a.state={},a}return Object(c.a)(n,[{key:"componentWillReceiveProps",value:function(e,t){this.zoom=e.mainState.zoomLevel,this.tool=e.mainState.drawMode}},{key:"componentDidMount",value:function(){this.zoom=this.props.mainState.zoomLevel,this.tool=this.props.mainState.drawMode}},{key:"mouseLeave",value:function(){ie.onmousemove={},He=!0,_e()}},{key:"render",value:function(){var e=this;return i.a.createElement("canvas",{ref:this.canvasRef,id:"drawCanvas",onContextMenu:function(t){return e.ocm(t)},onMouseDown:function(t){return e.mouseDown(t,e)},onMouseUp:function(t){return e.mouseUp(t,e)},onMouseLeave:function(t){return e.mouseLeave(t,e)}},i.a.createElement("p",null," HTML5 Canvas elements are not supported by your browser"))}}]),n}(i.a.Component);window.addEventListener("resize",Je);var In=n(205),Nn=n.n(In),Sn=n(206),Cn=n.n(Sn),Mn=n(207),Vn=n.n(Mn),On=n(208),jn=n.n(On),Ln=n(209),Un=n.n(Ln),Dn=n(210),Tn=n.n(Dn),An=1,Bn="Unnamed Folder",Kn=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).updateFolderName=function(){Bn=document.getElementById("FolderName").value},a.addFolder=function(){Object(Lt.a)(jt.a.mark((function e(){return jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ea(Bn,Zn());case 2:a.setLeftMenuToTree();case 3:case"end":return e.stop()}}),e)})))()},a.deleteFolder=function(){Object(Lt.a)(jt.a.mark((function e(){return jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ta(Zn());case 2:a.setLeftMenuToTree();case 3:case"end":return e.stop()}}),e)})))()},a.editFolderName=function(){Object(Lt.a)(jt.a.mark((function e(){return jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ia(Bn,Zn());case 2:a.setLeftMenuToTree();case 3:case"end":return e.stop()}}),e)})))()},a.addModel=function(){Object(Lt.a)(jt.a.mark((function e(){return jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ra(Bn);case 2:a.setLeftMenuToTree();case 3:case"end":return e.stop()}}),e)})))()},a.deleteModel=function(){Object(Lt.a)(jt.a.mark((function e(){return jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sa(Le());case 2:a.setLeftMenuToTree();case 3:case"end":return e.stop()}}),e)})))()},a.editModelName=function(){Object(Lt.a)(jt.a.mark((function e(){return jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,la(Bn,Le());case 2:a.setLeftMenuToTree();case 3:case"end":return e.stop()}}),e)})))()},a.zoom=function(e){var t=a.state.zoomLevel;"+"===e?a.state.zoomLevel<500&&(a.setState({zoomLevel:t+=25}),Et(t)):"-"===e?a.state.zoomLevel>100&&(a.setState({zoomLevel:t-=25}),Et(t)):console.log("Invalid Zoom Type")},a.setModelName=function(){a.setState({modelName:document.getElementById("ModelName").value})},a.showFile=function(){if(window.File&&window.FileReader&&window.FileList&&window.Blob)try{var e=document.querySelector("input[type=file]").files[0],t=new FileReader;t.readAsText(e),t.onload=function(){pn(t.result)}}catch(n){alert(n.text()+" did you select a file?")}else alert("Your browser is too old to support HTML5 File API")},a.toggleSemanticDomainState=function(){a.semanticTableEnabled?(a.semanticTableEnabled=!1,_e(),a.setState(a.state),console.log("Semantic Domain disabled")):(a.semanticTableEnabled=!0,function(){for(var e=[],t=we.flatten(),n=0;n<t.length;n++)e.push(fn(t[n])),"Arrow"===t[n].constructor.name&&(e.push(fn(t[n].sourceEdgeEnd)),e.push(fn(t[n].destEdgeEnd)));null!==Qt?Qt(e):console.error("Cannot set rows")}(),a.setState(a.state),console.log("Semantic Domain enabled"))},a.state={zoomLevel:200,drawMode:fe.Vertex,menu:te.TreeView,selectedObject:null},a.setMode=a.setMode.bind(Object(K.a)(a)),a.setLeftMenu=a.setLeftMenu.bind(Object(K.a)(a)),a.setLeftMenuToTree=a.setLeftMenuToTree.bind(Object(K.a)(a)),a.semanticTableEnabled=!1,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.setMode(fe.Select),console.log("Mounted")}},{key:"componentDidUpdate",value:function(e,t,n){var a,i=document.getElementById(t.SelectedTool);null!==i&&(i.style.backgroundColor="#FFFFFF"),(i=document.getElementById(this.state.SelectedTool)).style.backgroundColor="#CFFFFF",null!==this.state.selectedObject&&"Vertex"===this.state.selectedObject.typeName&&(a=this.state.selectedObject,we.flatten().length>0&&(Rn=a,!1===Pn?Pn=!0:!0===Pn&&(Pn=!1)),this.state.selectedObject.setPath(Fn))}},{key:"setMode",value:function(e){e===fe.Visibility||e===fe.Edge||e===fe.Specialisation?this.setState({drawMode:"Arrow"}):e===fe.Vertex?this.setState({drawMode:"Vertex"}):e===fe.Select?this.setState({drawMode:"Select"}):e===fe.Artifact?this.setState({drawMode:"Artifact"}):e===fe.Container&&this.setState({drawMode:"Container"}),this.setState({SelectedTool:fe[e]}),Pe=e}},{key:"setLeftMenu",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null!==n)for(var a=0;a<n.length;a++)n[a].setSelected(!1);null!==this.state.selectedObject&&!1===t&&this.state.selectedObject.setSelected(!1),null===e?this.setState({menu:te.TreeView,selectedObject:null}):null!==ae[e.constructor.name]?(this.setState({menu:e.constructor.name,selectedObject:e}),console.log("below should be selectedObject"),console.log(this.state.selectedObject),e.setSelected(!0)):(null!==this.state.selectedObject&&_e(),this.setState({menu:te.TreeView,selectedObject:null}))}},{key:"setLeftMenuToTree",value:function(){null!==this.state.selectedObject&&_e(),this.setState({menu:te.None}),this.setState({menu:te.TreeView,selectedObject:null}),console.log("set left menu To Tree enacted")}},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(va,{setLeftMenuToTree:this.setLeftMenuToTree}),i.a.createElement("div",{className:"Program"},i.a.createElement("div",{className:this.semanticTableEnabled?"SemanticDomain":"hidden"},i.a.createElement(un,null)),i.a.createElement("div",{className:"TopMenus"},i.a.createElement(ee.a,{variant:"Primary",id:"File-Menu",title:"File",size:"lg"},i.a.createElement(bn.a.Item,null,i.a.createElement("div",{className:"TopBar"},i.a.createElement("button",{id:"file",onClick:function(){return!0===window.confirm("Are you sure, this will clear the current canvas!")?(console.log("Clearing canvas"),window.location.reload()):console.log("User opted to not clear the canvas"),void _e()}},"New File"))),i.a.createElement(bn.a.Item,null,i.a.createElement("div",{className:"TopBar"},i.a.createElement("button",{id:"downloader",onClick:function(){return function(){var e=document.createElement("a");e.href=ie.toDataURL("image/png").replace(/^data:image\/[^;]/,"data:application/octet-stream"),e.download="Graph.png",document.body.appendChild(e),e.click()}()},download:"image.png"},"Export as .png"))),i.a.createElement("div",{className:"TopBar"},i.a.createElement("label",null,"Load"),i.a.createElement("input",{type:"file",id:"File-Select",onChange:this.showFile})),i.a.createElement(bn.a.Item,null,i.a.createElement("div",{className:"TopBar"},i.a.createElement("button",{id:"json-downloader",onClick:function(){return vn()}},"Save (as Json)")))),i.a.createElement("div",{className:"TopBar",onClick:function(){return e.toggleSemanticDomainState()}},"Semantic Editor"),i.a.createElement("input",{className:"TopBarSearch",id:"ModelName",type:"text",name:"modelName",placeholder:"Graph Name",onChange:function(t){return e.setModelName(t)}}),i.a.createElement("input",{className:"TopBarSearch",id:"FolderName",type:"text",name:"folderName",placeholder:"New Container/Model",onChange:function(t){return e.updateFolderName(t)}}),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.zoom("-")}}," - "),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.zoom("+")}}," + "),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.addFolder()}},i.a.createElement("img",{src:Nn.a,alt:"Add Container"})),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.deleteFolder()}},i.a.createElement("img",{src:Cn.a,alt:"Delete Container"})),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.editFolderName()}},i.a.createElement("img",{src:Vn.a,alt:"Edit Container"})),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.addModel()}},i.a.createElement("img",{src:jn.a,alt:"Add Model"})),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.deleteModel()}},i.a.createElement("img",{src:Un.a,alt:"Delete Model"})),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.editModelName()}},i.a.createElement("img",{src:Tn.a,alt:"Edit Model"}))),i.a.createElement("div",{className:"LowerPanel"},i.a.createElement(me,{setMode:this.setMode,setLeftMenu:this.setLeftMenu,mainState:this.state,className:"LeftMenus"}),i.a.createElement("input",{className:"SelectedFolder",id:"SelectedFolder",type:"text",name:"selectedFolder",readonly:"readonly"}),i.a.createElement("input",{className:"SelectedContainer",id:"SelectedContainer",type:"text",name:"selectedContainer",readonly:"readonly"}),i.a.createElement("input",{className:"SelectedModel",id:"SelectedModel",type:"text",name:"selectedModel",readonly:"readonly"}),i.a.createElement("div",{className:"Canvas"},i.a.createElement(kn,{setLeftMenu:this.setLeftMenu,setMode:this.setMode,mainState:this.state})))))}}]),n}(i.a.Component),Fn="",Rn=null,Pn=!1,Hn=[],Yn=[],Xn=[],zn=0,Wn=[],Gn=[],Jn=[],_n=!1;function qn(e){zn=e}function Zn(){return zn}function $n(){return Yn}function Qn(){Ve(Gn[0].data.renderKey),Ue(Gn[0].data.modelKey),qn(Gn[0].data.renderKey);var e,t=Object(l.a)(we.flatten());try{for(t.s();!(e=t.n()).done;){var n=e.value;"Vertex"===n.typeName&&n.getModelKey()===Le()?n.setPresent():n.getModelKey()!==Le()&&"Vertex"===n.typeName&&n.setAway()}}catch(a){t.e(a)}finally{t.f()}_e(),document.getElementById("SelectedFolder").value=Yn.find((function(e){return e.renderKey===Zn()})).text,document.getElementById("SelectedContainer").value=Yn.find((function(e){return e.renderKey===Me()})).text,document.getElementById("SelectedModel").value=Gn.find((function(e){return e.modelKey===Le()})).text}function ea(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;je();var n={text:e+" \ud83d\udcc1",children:Hn[Oe()],data:NaN,state:{opened:!0},type:"Folder",renderKey:Oe(),parentRenderKey:t};Wn.push(n);var a={text:e+" \ud83d\udcc1",children:Hn[Oe()],data:Wn[Yn.length],state:{opened:!0},type:"Folder",renderKey:Oe(),parentRenderKey:t};Yn.push(a),_n=!0}function ta(e){if(console.log("below is the selected render key"),console.log(e),Yn.length>1){for(var t=0;t<Yn.length;t++)Yn[t].renderKey===e&&(console.log("below is folderdata"),console.log(Yn),na(Yn[t]),Wn.splice(t,1),Yn.splice(t,1));_n=!0}else console.log("Cannot delete only folder");Qn()}function na(e){for(var t=e.children,n=0;n<t.length;n++){if("Folder"===t.type)ta(t[n].renderKey);else if("Model"===t.type){sa(t[n].modelKey)}}}function aa(e){if(e.children.length>0)for(var t=e.children,n=0;n<t.length;n++)for(var a=t[n].children,i=0;i<a.length;i++){if(a[i].modelkey===e.modelKey)qe(a[i].data)}}function ia(e,t){if(""!=e){for(var n=0;n<Yn.length;n++)if(Yn[n].renderKey===t){Yn[n].text=e+" \ud83d\udcc1";break}}else console.log("Cannot have empty name")}function ra(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zn();Te();var n={text:e+" \ud83d\udcc8",children:["Vertices \ud83d\udcc1","Arrows \ud83d\udcc1"],data:NaN,state:{opened:!0},type:"Model",renderKey:t,modelKey:De()};Jn.push(n);var a={text:e+" \ud83d\udcc8",children:["Vertices \ud83d\udcc1","Arrows \ud83d\udcc1"],data:Jn[Gn.length],state:{opened:!0},type:"Model",renderKey:t,modelKey:De()};Gn.push(a),console.log(Gn),!0}function sa(e){for(var t=0;t<Gn.length;t++)Gn[t].modelKey===e&&(console.log("model deleted below"),console.log(Gn[t]),aa(Gn[t]),Gn.splice(t,1),Jn.splice(t,1));Qn()}function la(e,t){for(var n=0;n<Gn.length;n++)if(Gn[n].modelKey===t){Gn[n].text=e+" \ud83d\udcc8";break}}function oa(e){for(var t=0;t<Gn.length;t++)if(Gn[t].modelKey===e)return Gn[t].renderKey}function ca(e){var t,n=[],a=0,i=Object(l.a)(Hn);try{for(i.s();!(t=i.n()).done;){var r=t.value;void 0!==r&&"Model"===r.type&&r.renderKey===e&&n.push(Hn[a]),a+=1}}catch(s){i.e(s)}finally{i.f()}return n}function da(e){var t,n=[],a=Object(l.a)(Yn);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.parentRenderKey===e&&n.push(i)}}catch(r){a.e(r)}finally{a.f()}return n}var ua=!1,ha=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(o.a)(this,n),a=t.call(this,e),Hn=[],!1===ua&&(Ve(1),Ue(1),qn(1),ea("Folder"),ra("Model",1),ua=!0,ea("Subfolder",Me()));var i,r=Object(l.a)(Gn);try{for(r.s();!(i=r.n()).done;){var s=i.value;Hn.push(s)}}catch(K){r.e(K)}finally{r.f()}var c,d=Object(l.a)(Yn);try{for(d.s();!(c=d.n()).done;){var u=c.value,h=ca(u.renderKey),f=da(u.renderKey),m=h.concat(f);u.children=m}}catch(K){d.e(K)}finally{d.f()}var y,v=Object(l.a)(Yn);try{for(v.s();!(y=v.n()).done;){var g,p=y.value,b=Object(l.a)(Hn);try{for(b.s();!(g=b.n()).done;){var E=g.value,x=new ge;void 0!==x.toTreeViewElement("Vertex Folder",p.renderKey,E.modelKey)&&E.renderKey===p.renderKey&&(E.children[0]=x.toTreeViewElement("Vertex Folder",p.renderKey,E.modelKey)),void 0!==x.toTreeViewElement("Arrow Folder",p.renderKey,E.modelKey)&&E.renderKey===p.renderKey&&(E.children[1]=x.toTreeViewElement("Arrow Folder",p.renderKey,E.modelKey))}}catch(K){b.e(K)}finally{b.f()}}}catch(K){v.e(K)}finally{v.f()}Xn=[];var w,k=Object(l.a)(Yn);try{for(k.s();!(w=k.n()).done;){var I=w.value;0===I.parentRenderKey&&Xn.push(I)}}catch(K){k.e(K)}finally{k.f()}if(a.state={data:{core:{data:[{text:Ge(),children:Xn,state:{opened:!0},root:!0}]}},selectedVertex:null},!0===Pn){var N,S=Ge(),C="",M="",V="",O=0,j=Object(l.a)(Yn);try{for(j.s();!(N=j.n()).done;){var L,U=N.value,D=Object(l.a)(U.children);try{for(D.s();!(L=D.n()).done;){var T=L.value;if(0===O){var A,B=Object(l.a)(T.children);try{for(B.s();!(A=B.n()).done;){A.value.text===Rn.title&&(C=U.text,M="Vertices",V=Rn.title,Fn=S+"::"+C+"::"+M+"::"+V,O=1)}}catch(K){B.e(K)}finally{B.f()}}}}catch(K){D.e(K)}finally{D.f()}}}catch(K){j.e(K)}finally{j.f()}}return!0===_n&&(_n=!1),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){}}]),Object(c.a)(n,[{key:"handleElementSelect",value:function(e,t){try{if("Vertex Folder"===t.node.type);else if("Folder"===t.node.data.type)qn(t.node.data.renderKey);else if("Model"===t.node.data.type){Ue(t.node.data.modelKey),Ve(t.node.data.renderKey),qn(t.node.data.renderKey);var n,a=Object(l.a)(we.flatten());try{for(a.s();!(n=a.n()).done;){var i=n.value;"Vertex"===i.typeName&&i.getModelKey()===Le()?i.setPresent():i.getModelKey()!==Le()&&"Vertex"===i.typeName&&i.setAway()}}catch(f){a.e(f)}finally{a.f()}}else if(1===t.selected.length&&null!==t.node.data&&void 0===t.node.data.type){var r,s=t.node.data.semanticIdentity.UUID,o=Object(l.a)(we.flatten());try{for(o.s();!(r=o.n()).done;){var c=r.value;if(c.semanticIdentity.UUID===s){this.setState({selectedVertex:c}),Ve(c.vertexRenderKey),Ue(c.vertexModelKey),qn(c.vertexRenderKey);var d,u=Object(l.a)(we.flatten());try{for(u.s();!(d=u.n()).done;){var h=d.value;"Vertex"===h.typeName&&h.getModelKey()===Le()?h.setPresent():h.getModelKey()!==Le()&&"Vertex"===h.typeName&&h.setAway()}}catch(f){u.e(f)}finally{u.f()}this.props.setLeftMenu(this.state.selectedVertex)}}}catch(f){o.e(f)}finally{o.f()}}else this.setState({selectedVertex:null});_e()}catch(e){}try{!0===t.node.original.root&&qn(0)}catch(e){}0===Zn()?document.getElementById("SelectedFolder").value="Root":document.getElementById("SelectedFolder").value=Yn.find((function(e){return e.renderKey===Zn()})).text,document.getElementById("SelectedContainer").value=Yn.find((function(e){return e.renderKey===Me()})).text,document.getElementById("SelectedModel").value=Gn.find((function(e){return e.modelKey===Le()})).text}},{key:"handleContextMenu",value:function(){console.log("CM triggered for tree")}},{key:"render",value:function(){var e=this,t=this.state.data;return i.a.createElement("div",null,i.a.createElement(f.a,{treeData:t,onChange:function(t,n){return e.handleElementSelect(t,n)},className:"treeview"}))}}]),n}(i.a.Component),fa="Default",ma=0,ya="Default",va=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={xPos:"0px",yPos:"0px",showMenu:!1},a.handleClick=function(e){if(a.state.showMenu)if("MoveModel"===e.target.id)ya="MoveModel",a.setState({showMenu:!0});else if(e.target.id.includes("Folder")){var t=e.target.id.replace("Folder","");!function(e,t){console.log("Rebase test"),console.log(Gn);var n,a=Object(l.a)(Gn);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.modelKey===e){var r,s=Object(l.a)(i.children);try{for(s.s();!(r=s.n()).done;){var o,c=r.value.children,d=Object(l.a)(c);try{for(d.s();!(o=d.n()).done;){var u=o.value;u.renderkey=t,"Vertex"===u.data.typeName?u.data.vertexRenderKey=t:u.data.arrowRenderKey=t}}catch(h){d.e(h)}finally{d.f()}}}catch(h){s.e(h)}finally{s.f()}console.log(i),i.renderKey=t,console.log(i)}}}catch(h){a.e(h)}finally{a.f()}console.log(Gn),1}(ma,parseInt(t)),console.log("model ",ma," moved to folder id ",t),a.setState({showMenu:!1}),a.props.setLeftMenuToTree()}else"Rename"===e.target.id?(ya="Rename",a.setState({showMenu:!0})):"RenameBox"===e.target.id||"CMSelected"===e.target.id||a.setState({showMenu:!1})},a.handleKey=function(e){if("Enter"===e.key&&"Rename"===ya){ia(document.getElementById("RenameBox").value,ma),console.log("menu change");try{a.props.setLeftMenuToTree()}catch(e){console.log(e)}console.log("menu change fin"),a.setState({showMenu:!1})}},a.handleContextMenu=function(e){if(e.preventDefault(),e.target.click(),ya="Default",fa="Default",ma=0,"jstree-anchor jstree-hovered jstree-clicked"===e.target.className){if(e.target.text.includes("\ud83d\udcc1")){var t,n=Object(l.a)($n());try{for(n.s();!(t=n.n()).done;){var i=t.value;e.target.text===i.text&&(ya="Folder",fa=e.target.text,ma=Zn())}}catch(c){n.e(c)}finally{n.f()}}if(e.target.text.includes("\ud83d\udcc8")){var r,s=Object(l.a)(Gn);try{for(s.s();!(r=s.n()).done;){var o=r.value;e.target.text===o.text&&(ya="Model",fa=e.target.text,ma=Le())}}catch(c){s.e(c)}finally{s.f()}}}a.setState({xPos:"".concat(e.pageX,"px"),yPos:"".concat(e.pageY,"px"),showMenu:!0})},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleClick),document.addEventListener("contextmenu",this.handleContextMenu),document.addEventListener("keypress",this.handleKey)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClick),document.removeEventListener("contextmenu",this.handleContextMenu),document.removeEventListener("keypress",this.handleKey)}},{key:"render",value:function(){var e=this.state,t=e.showMenu,n=e.yPos,a=e.xPos;if(!t)return null;if("Default"===ya)return i.a.createElement("div",{className:"ContextMenu",style:{top:n,left:a}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},"Default"));if("Folder"===ya)return i.a.createElement("div",{className:"ContextMenu",style:{top:n,left:a}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},fa),i.a.createElement("div",{className:"CMitem",id:"Rename"}," Rename"));if("Model"===ya)return i.a.createElement("div",{className:"ContextMenu",style:{top:n,left:a}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",fa," "),i.a.createElement("div",{className:"CMitem",id:"Navigate"}," Navigate (not implemented) "),i.a.createElement("div",{className:"CMitem",id:"MoveModel"}," Move To "));if("MoveModel"===ya){var r=$n().map((function(e){return i.a.createElement("div",{className:"CMitem",id:"Folder"+e.renderKey,key:e.text}," ",e.text," ")}));return i.a.createElement("div",{className:"ContextMenu",style:{top:n,left:a}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},' Move "',fa,'" To:'),i.a.createElement("div",null,r))}return"Rename"===ya?i.a.createElement("div",{className:"ContextMenu",style:{top:n,left:a}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",fa," "),i.a.createElement("input",{className:"CMText",id:"RenameBox",type:"text",name:"renameItem",placeholder:"new Name"})):void 0}}]),n}(i.a.Component);var ga,pa=function(){return i.a.createElement("div",{className:"App"},i.a.createElement("div",{id:"program"}),i.a.createElement(va,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(pa,null)),document.getElementById("root")),s.a.render(i.a.createElement(Kn,null),document.getElementById("program")),ga="drawCanvas",ie=document.getElementById(ga),re=ie.getContext("2d"),Je(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[232,1,2]]]);
//# sourceMappingURL=main.18308827.chunk.js.map