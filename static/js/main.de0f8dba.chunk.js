(this.webpackJsonps23mgrapheditor=this.webpackJsonps23mgrapheditor||[]).push([[0],{139:function(e,t,a){},188:function(e,t,a){e.exports=a.p+"static/media/vertex.4937cefd.svg"},189:function(e,t,a){e.exports=a.p+"static/media/edge.09e9d9dc.svg"},190:function(e,t,a){e.exports=a.p+"static/media/select.8b3cad47.svg"},191:function(e,t,a){e.exports=a.p+"static/media/specialisation.3320bc80.svg"},192:function(e,t,a){e.exports=a.p+"static/media/visibility.5452d398.svg"},199:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAe4AAAGaCAMAAAD+elCzAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAAAQz/zdM/1Fg/2Vy/3aB/4KL/4aP/5Sc/5ef/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFjhjVYAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOYUlEQVR4Xu2d0XajOBBEd2aTnd3//+Aslso2NgYkQN3VUt2HMdL4nFZ0g0TZ2PnrRwyEdA+FdA+FdA+FdA+FdA+FdA+FdA+FdA+FdA+FdA+FdA+FdPPzjccLkG5+vr9wcB7p5uf7Fw7OI938fP+6zLd08zPp/o3Ds0g3P5PuXxddrkk3PzfdFy3n0s1P0n2Nb+nmJ+u+JI1JNz9Z9yWnt3TzA91X+JZufu66L0hj0s3PXfevP+g4jnTz89B9fjmXbn6euk8v59LNz1P36TQm3fzMdJ9dzqWbn7nuk76lm58X3ee2b+nm50X3uTQm3fy86j61nEs3P2+6zyzn0s3Pm+4zaWxf97dw5jc0P4CZA+zrRglBBNTUI90R+RtuqpHukBxNY9IdE8ipRbpjcjCNSXdQjqUx6Y4K9NQh3WGBnyqkOyxH0ph0x+VAGpPuwMBQBdIdmPo0Jt2Rqf4YsHSHBo6Kke7YQFIp0h2byjQm3cH5F5rKkO7oQFMZ0h2dqjQm3eGpSWPSHR+IKkG6OwCmCpDuDii/1UG6ewCq9pHuLoCrXaS7C0rTmHT3QWEak+5OgK0dpLsXoGsb6e6FojQm3d0AX5tIdz9A2BbS3Q8FaUy6O2L/xnPp7gkoW0e6e2J3OZfurthLY9LdF5C2hnR3BqytIN2dsb19S3dvbKYx6e4OePuIdHfH1nIu3f2xkcaku0Ng7gPS3R8Q9wnp7o6tV9akuzc2g7d09wa0fUa6O2P7PW/p7oudt0Cluy8gbQ3p7go4W0W6e2L3XnPp7ojde5ekuydgbAPp7oeCL7yW7m7YX8qluyPgaxPp7gXo2ka6O6Ho877S3QuwtYN09wFk7SHdXVD6vajS3QMlGSwh3T0AVftIdwfAVAHSHZ+yDJaQ7vhAVAnSHR54KkK6o1P1lwIpdP/BoxP/4pGQry8crFKcwRIUup2XkB9e398/v3G0BiwVQqL7G0cu/Pz8jSM6ppUaRyvU/dU4Ft27v8QtsfkhDzHp3tzpav9CP4tuzwl3Lr/F7Tpsa+m5Db0GGt2OE36rvntJ5EO67MbxB27/WwWPbr8JT+U9d5N1cspCY0H+3xp4dPud3s7lt8hCV86EugyWINLtNuG5unP4/wzO389LT/6/Kph0e6UxlGdMY/flGs0XKjNYgkm31/6J6m6rywZ33R+WntoMlqDS7TThKM7o+3ExtjwT8B91cOn2eTUTxRnT2EP3QgO6K+HS7bN/ovYEXRp76n7zUHFLwxwy3RbVFqD0DfTQMNP9svQcyGAJHt249ECXJalu/vgkWxpLuuF8vvTknnp4dCNYOKSxVBczSLacZ92LM6Hgo72fIdLtNuGp7H19RB8JWTf0PpaeQxkssa/biuMb0iUcvvppz7Tg5YP7mZBbR2DSPb8wMefULLZl0v2y9OTjQ1Dp9pxw5/Jb3C5nsPTcRnlmFeLS7Tjht+quu8k66eo1H05p7NQgyXT77Z+p/OEr3qbksJKPT54RZLr9Tm/n8ltk3bgcP/cbyabbbcJzdcrlPOu+ZOmh0+014SjPmMag+4ozgU63VxpDdcbl/K77gjOBT7fThKM4o++77gvOBELdPhOO2mdeoWzFQ/f5mWHU7bJ/ovYEXRp76j7tm1G3y+mN0jfQQ8NM99mlh1K3x4Sj8g22NDbTfej20xmcuh0mHJUTZGlsrvvkmcCp22H/ROEM+kh40X3uTCDVbT/hqAvQycGL7nNpjFW3+XKOuoAqjb3qPvWryKrbfP9E2TsnL4ku5U33Gd+0uq3XU1R9gG4G3nWfWHr2dX8bgZ/lSS7/D/67MYsPkDx3EzzDj8XNmhjYAXZ1LzVYgQlHy5zHJRHaTGBk9RDrfr/d1ppUfQJNJg5fyDLrxoS73emfyzPqPpzGqHU7L+e4JEKLizy0aqh139MYWua4fYypgDS0arh144dy+9x1Lk/2ubHMsdclyHVjwtEwx3k32SQPrRJ23c77Z74k4vyK3DS0Sth1I425jSJV5/yK3CNpjF639/6Zy6PBxYE0xq/bef90Dgeb5KHVwK/be8Jzdb4vZZqoX84D6Pae8Fy+jzQWQbfz/tlTGguhmyKNUX5Fbq3vELq9X81M1btIYzF0e++fuTwaXNTdsxtEt9LYKnlohQTR7f1qZqreQRqLott7/8zlw6exMLqd989O0lgc3c5pzPnGuU3S0IqIo5sjjVEu5+U3ngfS7TzhzMt5cRqLpFtpbJU8tH0i6fZ+NTNVj53GQunGhCuNLSlMY7F0Y8LRMCd+Ggum23n/DJ/GgunGD6VbHZYUpbFoup0nPHoaC6dbaWyVPLRNwulWGlulII3F040Jd05jaHCxf+N5QN3OE+78Vs0meWgbRNRNkcYI52UiDW2DiLrxQymNLdlLYyF1O084cxrb+T64mLqVxlbJQ1sjpm7vVzNT9YhpLKhu7/0zl0eDi800FlW383IeNY1F1e29fwb9Uqawur33z1w+WhqLqzuf3vpcyQfy2D4RVrc271Xy0D4SVncenS7Nl2xdmkfVTRG8433iO6hu56U8n0ABv10vqO48Nr1ovmT7RfOYuvPQFMKW7LwlFlK3XmJZJQ1tnYi6lcFWyUNbJ6LuPDBlsCW7N6sF1K03P9fYzGCJeLqdl/K4tzbciKc7D0sZbMnOjUs3wunOo1IGW7KTwRLRdDuvpZFvOr4RTXceFBrmRM5giWC685j0gaElWPZ2iKU750plsCX7GSwRSrcy2Cp5aLuE0p1HpAy2JF9C7hNJdx6QMtiSkgyWCKSbIoO5XTdskoZWQiDdeTxomMO8lOehlRBHdx6OvkJvSVkGS4TR7Xx7WKq+vG74IjjdCzNYIopu0gzGsLrnoZURRXceDFsG+9RnTWkGSwTR7Xx7WKq+/GW7bTA4dKNmKY+i2/mtiZUMlmYax26koRUTQ3ceChrmbCzl7rrTGMoJoTuPhC2D5Q0GDScqMlgigm7ODMbw3nfdxj0RQPfaWmrEegb73G8JxlBOAN15HG6vZ+XyaDzJ3b66qzJYgl83RQZbXDc8buBH24PqpTyAbuctcuX+medMo8MDjKAGet15FGiYs5nBEuhwAAOogl13HgTbLQ2zG/jRY09tBkuQ6167LDYiV1/LYAl02YP6dXDrps5g+QFd5qTi1XDrzkPgzGBfrrofyaAOat05V7qNIFVfCn2c83jw4EAGSzDrpshgi/rPDeb+6EAqfQBm3XkAaJjzOIHQvpM7bxtMOsidxqTKRyDWnes7Z7AJtMFsg0lHqdOYQxkssavbDPwoD47/TIdA1Qfbn41PT8FxcxZnHPoPQKv76MXIUVD2zjxaL8nPQaM577rRfQRa3eg1A2XvoPcz2GDQas6b7oMZLMGqu/69vZOgLkDnCkVPuo5X3aeWPVLd1kv5W/ntEwhPctKNzmOQ6kafISic2P5le7zIh3ZzXnRvX0LuwakbXZagcgJdn3m+942O5sx1b19C7kKp2ziDJVD6RkEGS6CjOXPd6DoKo277jXsCtSe2T6DZ+zXoac5MN3oOw6gbHbag9gQ6PjN/kQ9dzXnqPpPBEoS6zTNYAsX3JOJJCXQ156H7/LLHp9tlKX+W375uwJMy6GvOQzfaJ+DTjaY1qF6YwRLobM5/qHcugyXodKNlTkn5t/uP0dueXO5kBkuw6fbIYIlcfvu6IT/nAXrbc105Nt1o2JOqF2ewBLrbc101Mt04dmC//OJGC/S351bsmmWPS/fpXHmcW3kcrnB7hjV5QqaDi/IKlW6nDJaYyldkMCseutPjeah048iFvV82n++OuOu+6qUnJt048GGnvNN3oUL3FRksQaTbLYMl6jKYFdCd/r0CIt14dKLm5TQ7su7r4NHNjNvN7tLtASbfHul2AHPvgHTb4/b9fdLtgNv3901ItzmYeRek2xqvDJaQbmPmd/3aI93GYN6dkG5bMO1eSLcpjhksId2WeGawhHRbgkn3Q7oNcc1gCem2wzeDJaTbDky5J9JtBmbcFem2wu2WhjnSbQUm3BfpNgLz7Yx02+CfwRLSbQJBBktItwmYbXek2wJMtj/SbQBFBktItwGYawKkuz2YagakuzkkGSwh3a1x+mjvZ6S7NZhoDqS7MUxLuXS3hieDJaS7LZhmFqS7KZhlGqS7JVwb94R0N4QqgyWkuyGYYyKkux10S7l0N4TlloY50t0OTDET0t0Ovis16W4J3+Yt3S3BJPMg3U3BLNMg3U0he4dEuhtDtn1Ld2MwzyRId2O40ph0t4ZqOZfu5mCmKZDu9mCqGZDu9hClMek2AHNNgHRbgMn2R7otoHnrW7pNYElj0m0Dptsb6TYC8+2MdBvBkcak2wpMuC/SbQZm3BXpNoMhjUm3HQRpTLoNwZw7It2GuP/lGek2xfvvSkm3LZh1N6TbFky7F9Jti3Mak25jfNOYdFuDifdBuq1xTWPSbY5nGpNuezD1Hki3A5h7B6TbAb9bHaTbA7c0Jt0uYPbNkW4XvD4GLN0+OKUx6XYC82+MdHsBAbZItxcuaUy63Vikse/2oPRlSHc5sPwA3ZGQ7nLe0xi6IyHdFbwt5+iNhHTXAM8AnZGQ7iogOoO+SEh3FS9pDH2RkO465ts3uiIh3ZVA9Q30REK6K5mlMfREQrpreS7n6IiEdFcD2dI9CLAt3WNwT2NoRkK6DyDdYyHdQ5E/BoxGJKT7ECmN4TgS0n0M6R4L6R6KKY3hKBLSfRTpHgvpHorL7wo2QLqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQrqHQroH4ufnf49ILFFF/WsBAAAAAElFTkSuQmCC"},200:function(e,t,a){e.exports=a.p+"static/media/redo.a80ea341.svg"},201:function(e,t,a){e.exports=a.p+"static/media/undo.5858a028.svg"},202:function(e,t,a){e.exports=a.p+"static/media/help.80a7660b.svg"},224:function(e,t,a){e.exports=a(405)},229:function(e,t,a){},405:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(13),s=a.n(r);a(229),a(139);var l=function(){return i.a.createElement("div",{className:"App"},i.a.createElement("div",{id:"program"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=a(44),c=a.n(o),d=a(73),h=a(18),u=a(20),f=a(39),m=a(37),A=a(35),y=a(7),v=a(23),g=a(176),p=a.n(g),b=a(66);var x=function e(t,a,n,i,r,s){Object(h.a)(this,e),this.typeName="SemanticIdentity",this.UUID=void 0!==r?r:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})),this.name=t,this.description=a,this.abbreviation=n,this.shortAbbreviation=i,this.translations=void 0!==s?s:[]},E=function(){function e(t){Object(h.a)(this,e),this.vertex=t,this.children=new Set,this.typeName="VertexNode",this.cleanObjectPath="Vertices",this.vertexObjectPath="Vertices"}return Object(u.a)(e,[{key:"add",value:function(e){this.children.add(e)}},{key:"remove",value:function(e,t){var a=!1;e.add(this),a=this.children.has(t),this.children.delete(t);var n,i=Object(y.a)(this.children);try{for(i.s();!(n=i.n()).done;){var r=n.value;e.has(r)||(e.add(r),a=r.remove(e,t))}}catch(s){i.e(s)}finally{i.f()}return a}},{key:"getVertexNode",value:function(e,t){var a,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Object(y.a)(this.children);try{for(i.s();!(a=i.n()).done;){var r=a.value;if(!e.has(r)){if(e.add(r),r.vertex.semanticIdentity.UUID===t.semanticIdentity.UUID)return r;if(n){var s=r.getVertexNode(e,t);if(null!==s)return s}}}}catch(l){i.e(l)}finally{i.f()}return null}},{key:"removeFromChildren",value:function(e){return!!this.children.has(e)&&(this.children.delete(e),!0)}},{key:"flatten",value:function(e){var t,a=[],n=Object(y.a)(this.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.has(i)||(e.add(i),a.push(i.vertex),null!==i&&a.push.apply(a,Object(b.a)(i.flatten(e))))}}catch(r){n.e(r)}finally{n.f()}return a}},{key:"flattenVertexNodes",value:function(e){var t,a=[],n=Object(y.a)(this.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.has(i)||(e.add(i),a.push(i),null!==i&&a.push.apply(a,Object(b.a)(i.flattenVertexNodes(e))))}}catch(r){n.e(r)}finally{n.f()}return a}},{key:"has",value:function(e,t){if(this.children.has(t))return!0;var a,n=Object(y.a)(this.children);try{for(n.s();!(a=n.n()).done;){var i=a.value;if(!e.has(i)&&(e.add(i),i.has(e,t)))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"toTreeViewElement",value:function(e,t){var a=[],n=[];if("Vertex Package"===e){for(var i=0;i<oa.flatten().length;i++)if("Vertex"===oa.flatten()[i].typeName&&oa.flatten()[i].getContainerKey()===t){""===oa.flatten()[i].title?this.setVertexTreePath("Unnamed Vertex"):this.setVertexTreePath(oa.flatten()[i].title);var r={text:oa.flatten()[i].title,children:[],data:oa.flatten()[i],containerKey:oa.flatten()[i].getContainerKey(),graphKey:oa.flatten()[i].getGraphKey(),state:{opened:!1}};""===r.text&&(r.text="Unnamed Vertex"),n.push(r)}return{text:"Vertices &#128193",children:n,data:null,state:{opened:!0},type:"Vertex Package"}}if("Arrow Package"===e){for(var s=0;s<oa.flatten().length;s++)if("Vertex"!==oa.flatten()[s].typeName&&oa.flatten()[s].getContainerKey()===t){for(var l=oa.flatten()[s].pathData[1][1],o=oa.flatten()[s].pathData[0][1],c="N/A",d="N/A",h=0;h<oa.flatten().length;h++){var u=oa.flatten()[h];"Vertex"===u.typeName&&(l===u.semanticIdentity.UUID?d=u.title:o===u.semanticIdentity.UUID&&(c=u.title))}var f=[!1,!1,!1,!1];f[0]=oa.flatten()[s].getNavigable(0),f[1]=oa.flatten()[s].getNavigable(1),f[2]=oa.flatten()[s].getAggregation(0),f[3]=oa.flatten()[s].getAggregation(1);var m="";!0===f[2]?m="&#9670":!0===f[0]&&(m="&#10229"),m+="&#8213",!0===f[3]?m+="&#9670":!0===f[1]&&(m+="&#10230");var A={text:c+" "+m+" "+d,children:[],data:oa.flatten()[s],containerKey:oa.flatten()[s].getContainerKey(),graphKey:oa.flatten()[s].getGraphKey(),state:{opened:!1}};a.push(A)}return 0===a.length?void 0:{text:"Relations \u2b72",children:a,data:null,state:{opened:!0},type:"Arrow Package"}}}},{key:"setTreeViewElement",value:function(e){return{text:e,children:[],state:{opened:!0}}}},{key:"setVertexTreePath",value:function(e){this.vertexObjectPath=this.cleanObjectPath+"/"+e}},{key:"returnVertexTreePath",value:function(){return this.vertexObjectPath}}]),e}(),w=function(){function e(t,a){Object(h.a)(this,e),this.arrow=a,this.updateVertices(t)}return Object(u.a)(e,[{key:"updateVertices",value:function(e){if(this.sourceVertexNodeObject=null,this.destVertexNodeObject=null,null!==this.arrow){var t,a=null===this.arrow.sourceVertexUUID,n=null===this.arrow.destVertexUUID,i=Object(y.a)(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(a&&n)break;null!==r&&(r.vertex.semanticIdentity.UUID===this.arrow.sourceVertexUUID?(this.sourceVertexNodeObject=r,a=!0):r.vertex.semanticIdentity.UUID===this.arrow.destVertexUUID&&(this.destVertexNodeObject=r,n=!0))}}catch(s){i.e(s)}finally{i.f()}}}},{key:"sourceVertexNode",set:function(e){this.sourceVertexNodeObject=e,this.arrow.sourceVertexUUID=null!==e?e.vertex.semanticIdentity.UUID:null},get:function(){return this.sourceVertexNodeObject}},{key:"sourceVertex",get:function(){return null!==this.sourceVertexNodeObject?this.sourceVertexNodeObject.vertex:null}},{key:"destVertexNode",set:function(e){this.destVertexNodeObject=e,this.arrow.destVertexUUID=null!==e?e.vertex.semanticIdentity.UUID:null},get:function(){return this.destVertexNodeObject}},{key:"destVertex",get:function(){return null!==this.destVertexNodeObject?this.destVertexNodeObject.vertex:null}}]),e}(),N=function(){function e(t,a){Object(h.a)(this,e),this.rootVertices=new Set,void 0!==t&&this.add(t),this.arrows=new Set,void 0!==a&&this.add(a)}return Object(u.a)(e,[{key:"add",value:function(e){Array.isArray(e)||(e=[e]);var t,a=Object(y.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;switch(n.typeName){case"Vertex":this.addVertex(n);break;case"Arrow":this.addArrow(n);break;case"VertexNode":this.rootVertices.add(n);break;case"ArrowEdge":this.arrows.add(n)}}}catch(i){a.e(i)}finally{a.f()}}},{key:"addVertex",value:function(e){if(null===this.getVertexNode(e))e.originalUUID=e.semanticIdentity.UUID,e=new E(e),this.rootVertices.add(e);else{var t=" :: "+e.title;e.title=t,e.originalVertex=!1,e.originalUUID=e.semanticIdentity.UUID;var a=new x(e.title,"","","",void 0,[]);e.semanticIdentity=a,e=new E(e),this.rootVertices.add(e)}}},{key:"addArrow",value:function(e){if(null===this.getArrowEdge(e)){if(e=new w(this.flattenVertexNodes(),e),this.arrows.add(e),null!==e.destVertexNode&&null!==e.sourceVertexNode&&(e.destVertexNode.add(e.sourceVertexNode),this.rootVertices.has(e.sourceVertexNode))){var t,a=!1,n=Object(y.a)(this.rootVertices);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.vertex.semanticIdentity.UUID!==e.sourceVertex.semanticIdentity.UUID&&(i.has(new Set,e.sourceVertexNode)&&(a=!0))}}catch(r){n.e(r)}finally{n.f()}a&&this.rootVertices.delete(e.sourceVertexNode)}}else console.error("Attempted to add duplicate arrow")}},{key:"ArrowUUIDSource",value:function(e){e=this.getVertexNode(e);var t,a=[],n=0,i=Object(y.a)(this.arrows);try{for(i.s();!(t=i.n()).done;){var r=t.value;null!==r.sourceVertexNode&&r.sourceVertex.semanticIdentity.UUID===e.vertex.semanticIdentity.UUID&&(a[n]=r,n+=1)}}catch(s){i.e(s)}finally{i.f()}return a}},{key:"ArrowUUIDDest",value:function(e){e=this.getVertexNode(e);var t,a=[],n=0,i=Object(y.a)(this.arrows);try{for(i.s();!(t=i.n()).done;){var r=t.value;null!==r.destVertexNode&&r.destVertex.semanticIdentity.UUID===e.vertex.semanticIdentity.UUID&&(a[n]=r,n+=1)}}catch(s){i.e(s)}finally{i.f()}return a}},{key:"remove",value:function(e){if("Vertex"===e.typeName){var t=this.getVertexNode(e),a=this.rootVertices.has(t);this.rootVertices.delete(t);var n,i=Object(y.a)(t.children);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.rootVertices.add(r)}}catch(E){i.e(E)}finally{i.f()}var s,l=new Set,o=Object(y.a)(this.rootVertices);try{for(o.s();!(s=o.n()).done;){var c=s.value;l.has(c)||(l.add(c),c.remove(l,t))}}catch(E){o.e(E)}finally{o.f()}if(a){var d,h=Object(y.a)(this.arrows);try{for(h.s();!(d=h.n()).done;){var u=d.value;null!==u.sourceVertexNode&&u.sourceVertex.semanticIdentity.UUID===t.vertex.semanticIdentity.UUID&&(u.sourceVertexNode=null),null!==u.destVertexNode&&u.destVertex.semanticIdentity.UUID===t.vertex.semanticIdentity.UUID&&(u.destVertexNode=null)}}catch(E){h.e(E)}finally{h.f()}}return a}if("Arrow"===e.typeName){var f=this.getArrowEdge(e);if(null!==f){if(this.arrows.delete(f),null!==f.sourceVertexNode&&null!==f.destVertexNode){var m,A=!1,v=!1,g=Object(y.a)(this.arrows);try{for(g.s();!(m=g.n()).done;){var p=m.value,b=null!==p.sourceVertexNode&&p.sourceVertex.semanticIdentity.UUID===f.sourceVertex.semanticIdentity.UUID,x=null!==p.destVertexNode&&p.destVertex.semanticIdentity.UUID===f.destVertex.semanticIdentity.UUID;b&&x&&(A=!0),b&&null!==p.destVertexNode&&(v=!0)}}catch(E){g.e(E)}finally{g.f()}A||f.destVertexNode.removeFromChildren(f.sourceVertexNode),v||this.add(f.sourceVertexNode),f.sourceVertexNode.has(new Set,f.destVertexNode)&&this.rootVertices.delete(f.destVertexNode)}return!0}}else null!==e?console.error("Attempted to remove object of invalid type %s to Graph",e.typeName):console.error("Attempted to remove null from Graph");return!1}},{key:"has",value:function(e){if(this.rootVertices.has(e))return!0;var t,a=new Set,n=Object(y.a)(this.rootVertices);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!a.has(i)&&(a.add(i),i.has(a,e)))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"getVertexNode",value:function(e){var t,a=new Set,n=Object(y.a)(this.rootVertices);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!a.has(i)){if(a.add(i),i.vertex.semanticIdentity.UUID===e.semanticIdentity.UUID)return i;var r=i.getVertexNode(a,e);if(null!==r)return r}}}catch(s){n.e(s)}finally{n.f()}return null}},{key:"getArrowEdge",value:function(e){var t,a=Object(y.a)(this.arrows);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.arrow.semanticIdentity.UUID===e.semanticIdentity.UUID)return n}}catch(i){a.e(i)}finally{a.f()}return null}},{key:"flatten",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=new Set,n=new Set,i=new Set;if(e){var r,s=Object(y.a)(this.rootVertices);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(!i.has(l)&&(i.add(l),a.add(l.vertex),null!==l)){var o,c=Object(y.a)(l.flatten(i));try{for(c.s();!(o=c.n()).done;){var d=o.value;a.add(d)}}catch(A){c.e(A)}finally{c.f()}}}}catch(A){s.e(A)}finally{s.f()}}if(t){var h,u=Object(y.a)(this.arrows);try{for(u.s();!(h=u.n()).done;){var f=h.value;n.add(f.arrow)}}catch(A){u.e(A)}finally{u.f()}}var m=Array.from(a);return m.concat(Array.from(n))}},{key:"flattenVertexNodes",value:function(){var e,t=new Set,a=new Set,n=Object(y.a)(this.rootVertices);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!a.has(i)&&(a.add(i),t.add(i),null!==i)){var r,s=Object(y.a)(i.flattenVertexNodes(a));try{for(s.s();!(r=s.n()).done;){var l=r.value;t.add(l)}}catch(o){s.e(o)}finally{s.f()}}}}catch(o){n.e(o)}finally{n.f()}return Array.from(t)}}]),e}(),C=a(111),k=a(207),I=a(454),S=a(465),M=a(462),V=a(458),O=a(406),D=a(459),L=a(463),U=a(460),T=a(8),j=a(9),K=a(177),P=a.n(K),B=a(134),G=a(205),F=a(77),H=a(178),R=a(53),Q=a(1);var Y;var z=null,q=null,X=i.a.createRef(),J=[],W=function(e){e.xlsx.writeBuffer().then((function(e){P()(new Blob([e],{type:"application/octet-stream"}),"DataGrid.xlsx")}))},Z=function(e){return e.id},_=function(){return{input:{fontSize:"14px",width:"90px"},label:{fontSize:"14px"},container:{maxWidth:"18em"},selector:{height:"32px"}}},$=Object(T.a)(_,{name:"StartEditActionSelector"})((function(e){var t=e.defaultAction,a=e.changeAction,n=e.classes;return i.a.createElement(D.a,{container:!0,alignItems:"center",className:n.container},i.a.createElement(O.a,{className:n.label},"Start Edit Action: \xa0"),i.a.createElement(M.a,{onChange:function(e){return a(e.target.value)},value:t,className:n.selector,input:i.a.createElement(S.a,{classes:{input:n.input},labelWidth:0,margin:"dense"})},i.a.createElement(V.a,{value:"click"},"Click"),i.a.createElement(V.a,{value:"doubleClick"},"Double Click")))})),ee=Object(T.a)(_,{name:"SelectTextChecker"})((function(e){var t=e.isSelectText,a=e.changeSelectText,n=e.classes;return i.a.createElement(U.a,{control:i.a.createElement(L.a,{checked:t,onChange:function(e){return a(e.target.checked)},color:"primary"}),classes:{label:n.label},label:"Select Text On Focus"})})),te=function(e){return i.a.createElement(Q.g,{name:"EditPropsPanel"},i.a.createElement(Q.k,{name:"toolbarContent"},i.a.createElement(ee,e),i.a.createElement(Q.m,null),i.a.createElement($,e)))},ae=function(e){var t=e.onClick,a=Object(k.a)(e,["onClick"]);return i.a.createElement(R.c.Cell,Object.assign({},a,{tabIndex:0,onFocus:t}))},ne=function(){var e=Object(n.useState)(se()),t=Object(v.a)(e,2),a=t[0],r=t[1];q=r;var s=Object(n.useState)([{columnName:"UUID",editingEnabled:!1},{columnName:"type",editingEnabled:!1}]),l=Object(v.a)(s,1)[0],o=Object(n.useState)([]),c=Object(v.a)(o,2),d=c[0],h=c[1];Y=d,z=h;var u=Object(n.useState)([{columnName:"UUID",wordWrapEnabled:!0},{columnName:"type",wordWrapEnabled:!0},{columnName:"name",wordWrapEnabled:!0},{columnName:"description",wordWrapEnabled:!0},{columnName:"abbreviation",wordWrapEnabled:!0},{columnName:"shortAbbreviation",wordWrapEnabled:!0}]),f=Object(v.a)(u,1)[0],m=Object(n.useState)("click"),A=Object(v.a)(m,2),g=A[0],p=A[1],x=Object(n.useState)(!0),E=Object(v.a)(x,2),w=E[0],N=E[1],k=Object(n.useRef)(null),S=Object(n.useCallback)((function(){k.current.exportGrid()}),[k]);return i.a.createElement(I.a,null,i.a.createElement(B.a,null,i.a.createElement(G.a,{ref:X,placeholder:"Column name","aria-label":"Column name","aria-describedby":"basic-addon2"}),i.a.createElement(B.a.Append,null,i.a.createElement(F.a,{variant:"outline-secondary",onClick:function(){return function(){var e=X.current.value;if(X.current.value="",""===e||null===e||void 0===e)return;J.push(e),ie()}()}},"Add"),i.a.createElement(F.a,{variant:"outline-secondary",onClick:function(){return function(){var e=X.current.value;X.current.value="";var t,a=Object(y.a)(oa.flatten());try{for(a.s();!(t=a.n()).done;){t.value.semanticIdentity.translations.delete(e)}}catch(n){a.e(n)}finally{a.f()}J.splice(J.indexOf(e),1),ie()}()}},"Remove"))),i.a.createElement(R.b,{rows:Y,columns:a,getRowId:Z},i.a.createElement(j.c,{onCommitChanges:function(e){var t,a=e.added,n=e.changed,i=e.deleted;if(a){var r=Y.length>0?Y[Y.length-1].id+1:0;t=[].concat(Object(b.a)(Y),Object(b.a)(a.map((function(e,t){return Object(C.a)({id:r+t},e)}))))}if(n&&function(e){for(var t=oa.flatten(),a=yt(),n=0;n<e.length;n++){for(var i=0;i<a.length;i++)e[n]=le(a[i],e[n]);for(var r=0;r<t.length;r++)e[n]=le(t[r],e[n]),"Arrow"===t[r].typeName&&(e[n]=le(t[r].sourceEdgeEnd,e[n]),e[n]=le(t[r].destEdgeEnd,e[n]))}}(t=Y.map((function(e){return n[e.id]?Object(C.a)(Object(C.a)({},e),n[e.id]):e}))),i){var s=new Set(i);t=Y.filter((function(e){return!s.has(e.id)}))}z(t)},columnExtensions:l}),i.a.createElement(R.c,{cellComponent:ae,columnExtensions:f}),i.a.createElement(R.d,null),i.a.createElement(R.f,null),i.a.createElement(te,{defaultAction:g,changeAction:p,isSelectText:w,changeSelectText:N}),i.a.createElement(R.a,{startExport:S}),i.a.createElement(R.e,{startEditAction:g,selectTextOnEditStart:w})),i.a.createElement(H.a,{ref:k,rows:Y,columns:a,onSave:W}))};function ie(){q(se())}function re(e){var t={};t.id=e.semanticIdentity.UUID,t.UUID=e.semanticIdentity.UUID,t.type=e.typeName,t.name=e.semanticIdentity.name,t.description=e.semanticIdentity.description,t.abbreviation=e.semanticIdentity.abbreviation,t.shortAbbreviation=e.semanticIdentity.shortAbbreviation;for(var a=0;a<e.semanticIdentity.translations.length;a++){var n=e.semanticIdentity.translations[a];t[n[0]]=n[1]}return t}function se(){var e,t=[{name:"UUID",title:"UUID"},{name:"type",title:"Type"},{name:"name",title:"Name"},{name:"description",title:"Description"},{name:"abbreviation",title:"Abbreviation"},{name:"shortAbbreviation",title:"Short Abbreviation"}],a=Object(y.a)(J);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push({name:n,title:n})}}catch(i){a.e(i)}finally{a.f()}return t}function le(e,t){if(e.semanticIdentity.UUID===t.UUID){e.semanticIdentity.abbreviation=t.abbreviation,e.semanticIdentity.shortAbbreviation=t.shortAbbreviation,e.semanticIdentity.name=t.name,e.title=t.name,e.semanticIdentity.description=t.description,e.text=t.name+" \ud83d\udfe7";var a,n=Object(y.a)(J);try{for(n.s();!(a=n.n()).done;){for(var i=a.value,r=!1,s=0;s<e.semanticIdentity.translations.length;s++)if(e.semanticIdentity.translations[s][0]===i){e.semanticIdentity.translations[s][1]=t[i],r=!0;break}r||e.semanticIdentity.translations.push([i,t[i]])}}catch(l){n.e(l)}finally{n.f()}}return t}function oe(e){J=e,ie()}var ce="None",de="Arrow",he="Triangle",ue="Filled Triangle",fe="Diamond",me="Filled Diamond",Ae={};Ae[ce]="None",Ae[de]="Arrow",Ae[he]="Triangle",Ae[ue]="FilledTriangle",Ae[fe]="Diamond",Ae[me]="FilledDiamond";var ye={};ye.None=ce,ye.Arrow=de,ye.Triangle=he,ye.FilledTriangle=ue,ye.Diamond=fe,ye.FilledDiamond=me;var ve="#000000",ge="#FF0000",pe="#0000FF",be="#00FF00",xe={};xe[ve]="Black",xe[ge]="Red",xe[pe]="Blue",xe[be]="Green";var Ee={};Ee.Black=ve,Ee.Red=ge,Ee.Blue=pe,Ee.Green=be;var we=1,Ne=2,Ce={};Ce[we]="Solid",Ce[Ne]="Dashed";var ke={};ke.Solid=we,ke.Dashed=Ne;var Ie=function(){function e(t,a,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;Object(h.a)(this,e),this.typeName="Cardinality",this.numLowerBound=t,this.numUpperBound=a,this.attachedToUUID=n,this.isVisible=i,this.semanticIdentity=void 0!==r?r:new x(this.toString(),this.getDescription())}return Object(u.a)(e,[{key:"toggleVisibility",value:function(){this.isVisible=!this.isVisible}},{key:"toString",value:function(){var e,t;return(e="-1"===this.lowerBound?"n":this.lowerBound)===(t="-1"===this.upperBound?"n":this.upperBound)?e:e+" .. "+t}},{key:"getDescription",value:function(){return"Cardinality of Edge End ".concat(this.attachedToUUID)}},{key:"lowerBound",set:function(e){this.numLowerBound=e,this.semanticIdentity.name=this.toString()},get:function(){return this.numLowerBound}},{key:"upperBound",set:function(e){this.numUpperBound=e,this.semanticIdentity.name=this.toString()},get:function(){return this.numUpperBound}}]),e}(),Se=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ce,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4?arguments[4]:void 0;Object(h.a)(this,e),this.attachedToUUID=t,this.typeName="EdgeEnd",this.semanticIdentity=void 0!==r?r:new x(this.toString(),this.getDescription()),this.headType=a,this.cardinality=void 0!==n?n:new Ie(1,1,this.semanticIdentity.UUID),this.label=i,this.edgeEndContainerKey=ya(),this.edgeEndGraphKey=ba()}return Object(u.a)(e,[{key:"setGraphKey",value:function(e){this.edgeEndGraphKey=e}},{key:"getGraphKey",value:function(){return this.edgeEndGraphKey}},{key:"setContainerKey",value:function(e){this.edgeEndContainerKey=e}},{key:"getContainerKey",value:function(e){return this.edgeEndContainerKey}},{key:"toString",value:function(){return"".concat(this.type," type Edge End")}},{key:"getDescription",value:function(){return"Edge end of ".concat(this.attachedToUUID)}},{key:"updateCardinality",value:function(e,t,a){this.cardinality.lowerBound=e,this.cardinality.upperBound=t,this.cardinality.visibility=a}},{key:"drawLines",value:function(e,t,a,n){e.strokeStyle=a,void 0!==n&&(e.fillStyle=n),e.beginPath(),e.moveTo(t[0].X,t[0].Y);for(var i=1;i<t.length;i++)e.lineTo(t[i].X,t[i].Y);void 0!==n&&(e.closePath(),e.fill()),e.stroke(),e.fillStyle="#000",e.strokeStyle="#000"}},{key:"drawArrowEnd",value:function(e,t,a,n,i){var r=Math.PI/6,s=n+Math.PI,l=[];l.push({X:t+7*Math.cos(s-r),Y:a+7*Math.sin(s-r)}),l.push({X:t,Y:a}),l.push({X:t+7*Math.cos(s+r),Y:a+7*Math.sin(s+r)}),this.drawLines(e,l,i)}},{key:"drawTriangleEnd",value:function(e,t,a,n,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#FFF",s=7,l=Math.PI/6,o=n+Math.PI,c=[];c.push({X:t,Y:a}),c.push({X:t+s*Math.cos(o-l),Y:a+s*Math.sin(o-l)}),c.push({X:t+s*Math.cos(o+l),Y:a+s*Math.sin(o+l)}),c.push({X:t,Y:a}),this.drawLines(e,c,i,r)}},{key:"drawDiamondEnd",value:function(e,t,a,n,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#FFF",s=7,l=Math.PI/9,o=n+Math.PI,c=[];c.push({X:t,Y:a}),c.push({X:t+s*Math.cos(o-l),Y:a+s*Math.sin(o-l)}),c.push({X:t+2*s*Math.cos(o),Y:a+2*s*Math.sin(o)}),c.push({X:t+s*Math.cos(o+l),Y:a+s*Math.sin(o+l)}),c.push({X:t,Y:a}),this.drawLines(e,c,i,r)}},{key:"draw",value:function(e,t,a,n,i){switch(this.type){case ce:break;case de:this.drawArrowEnd(e,t,a,n,i);break;case he:this.drawTriangleEnd(e,t,a,n,i);break;case ue:this.drawTriangleEnd(e,t,a,n,i,i);break;case fe:this.drawDiamondEnd(e,t,a,n,i);break;case me:this.drawDiamondEnd(e,t,a,n,i,i);break;default:console.log("EdgeEnd had unexpected type: %s",this.type)}}},{key:"type",set:function(e){this.headType=e,this.semanticIdentity.name=this.toString()},get:function(){return this.headType}}]),e}(),Me=a(187),Ve=a(188),Oe=a.n(Ve),De=a(189),Le=a.n(De),Ue=a(190),Te=a.n(Ue),je=a(191),Ke=a.n(je),Pe=a(192),Be=a.n(Pe),Ge=a(135),Fe={TreeView:"TreeView",Vertex:"Vertex",Arrow:"Arrow",Artifact:"Artifact",Container:"Container"},He={};He[Fe.TreeView]="TreeView",He[Fe.Vertex]="Vertex",He[Fe.Arrow]="Arrow",He[Fe.Arrow]="Artifact",He[Fe.Arrow]="Container";var Re={};He.TreeView=Fe.TreeView,He.Vertex=Fe.Vertex,He.Arrow=Fe.Arrow,He.Artifact=Fe.Artifact,He.Container=Fe.Container;var Qe={Select:"Select",Vertex:"Vertex",Visibility:"Visibility",Edge:"Edge",Specialisation:"Specialisation",Artifact:"Artifact",Container:"Container"},Ye=function(e){Object(m.a)(a,e);var t=Object(A.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).getVertexColour=function(){return n.state.selectedObject.getColour()},n.setVertexColour=function(e){n.state.selectedObject.setColour(e.hex),un(n.state.selectedObject),Ta()},n.deleteTitle=function(){n.setState({title:""})},n.getMenu=function(){var e,t=i.a.createElement("div",{id:"Toolbar",className:"Toolbar"},i.a.createElement("div",{id:"Select",className:"ToolbarItem",onClick:function(){return n.props.setMode(Qe.Select)}},i.a.createElement("img",{src:Te.a,alt:"Select"})),i.a.createElement("div",{id:"Vertex",className:"ToolbarItem",onClick:function(){n.props.setMode(Qe.Vertex)},onKeyDown:function(){return n.onKeyPressed()}},i.a.createElement("img",{src:Oe.a,alt:"Vertex"})),i.a.createElement("div",{id:"Edge",className:"ToolbarItem",onClick:function(){return n.props.setMode(Qe.Edge)}},i.a.createElement("img",{src:Le.a,alt:"Edge"})),i.a.createElement("div",{id:"Specialisation",className:"ToolbarItem",onClick:function(){return n.props.setMode(Qe.Specialisation)}},i.a.createElement("img",{src:Ke.a,alt:"Specialisation"})),i.a.createElement("div",{id:"Visibility",className:"ToolbarItem",onClick:function(){return n.props.setMode(Qe.Visibility)}},i.a.createElement("img",{src:Be.a,alt:"Visibility"})));return n.state.menu===Fe.TreeView?e=i.a.createElement(Ft,{setLeftMenu:n.props.setLeftMenu}):n.state.menu===Fe.Vertex?(Ta(),e=i.a.createElement("div",{id:"VertexMenu"},i.a.createElement("div",{className:"LeftHeader"},"Vertex Properties"),i.a.createElement("label",{className:"LeftLabel"},"Title"),i.a.createElement("input",{id:"LeftTitle",className:"LeftTitle",value:n.state.selectedObject.title,onInput:n.handleChange}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Content"),i.a.createElement("textarea",{id:"LeftContent",className:"LeftContent",value:n.state.selectedObject.getContentAsString(),onInput:n.handleChange}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),n.getS23MIconsSelector(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),n.getColourPicker(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Is Abstract?"),i.a.createElement("input",{type:"checkbox",id:"IsAbstract",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getAbstract(),onClick:function(){return n.toggleAbstract()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return n.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){Ka(n.state.selectedObject),n.deselectElement()}},"Remove"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"))):n.state.menu===Fe.Artifact?(Ta(),e=i.a.createElement("form",{id:"VertexMenu"},i.a.createElement("div",{className:"LeftHeader"},"Vertex Properties"),i.a.createElement("label",{className:"LeftLabel"},"Title"),i.a.createElement("input",{id:"LeftTitle",className:"LeftTitle",defaultValue:n.state.selectedObject.title,onKeyUp:function(){return n.setTitle()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Content"),i.a.createElement("textarea",{id:"LeftContent",className:"LeftContent",defaultValue:n.state.selectedObject.getContentAsString(),onKeyUp:function(){return n.setContent()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),n.getS23MIconsSelector(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),n.getColourPicker(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Is Abstract?"),i.a.createElement("input",{type:"checkbox",id:"IsAbstract",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getAbstract(),onClick:function(){return n.toggleAbstract()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return n.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){ja(n.state.selectedObject),n.setState({menu:"TreeView"})},placeholder:"NoTabIndex"},"Remove"))):n.state.menu===Fe.Container?(Ta(),e=i.a.createElement("form",{id:"VertexMenu"},i.a.createElement("div",{className:"LeftHeader"},"Vertex Properties"),i.a.createElement("label",{className:"LeftLabel"},"Title"),i.a.createElement("input",{id:"LeftTitle",className:"LeftTitle",defaultValue:n.state.selectedObject.title,onKeyUp:function(){return n.setTitle()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Content"),i.a.createElement("textarea",{id:"LeftContent",className:"LeftContent",defaultValue:n.state.selectedObject.getContentAsString(),onKeyUp:function(){return n.setContent()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),n.getS23MIconsSelector(),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Is Abstract?"),i.a.createElement("input",{type:"checkbox",id:"IsAbstract",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getAbstract(),onClick:function(){return n.toggleAbstract()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return n.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){ja(n.state.selectedObject),n.setState({menu:"TreeView"})},placeholder:"NoTabIndex"},"Remove"))):n.state.menu===Fe.Arrow&&(e=n.state.selectedObject.edgeType===Qe.Edge?i.a.createElement("form",{id:"ArrowMenu"},i.a.createElement("div",{className:"LeftHeader"},"Edge Properties"),i.a.createElement("label",{className:"LeftLabel"},"Source Is Navigable?"),i.a.createElement("input",{type:"checkbox",id:"SourceIsNavigable",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getNavigable(0),onClick:function(){return n.setNavigable(0)}}),i.a.createElement("label",{className:"LeftLabel"},"Destination Is Navigable?"),i.a.createElement("input",{type:"checkbox",id:"DestIsNavigable",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getNavigable(1),onClick:function(){return n.setNavigable(1)}}),i.a.createElement("label",{className:"LeftLabel"},"Source Is Aggregation?"),i.a.createElement("input",{type:"checkbox",id:"SourceIsAggregation",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getAggregation(0),onClick:function(){return n.setAggregation(0)}}),i.a.createElement("label",{className:"LeftLabel"},"Destination Is Aggregation?"),i.a.createElement("input",{type:"checkbox",id:"DestIsAggregation",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getAggregation(1),onClick:function(){return n.setAggregation(1)}}),i.a.createElement("label",{className:"LeftLabel"},"Line Colour"),i.a.createElement("select",{name:"LineColour",id:"LineColour",className:"LeftSelector",defaultValue:xe[n.state.selectedObject.lineColour],onChange:function(){return n.setColour()}},i.a.createElement("option",{value:"Black"},"Black"),i.a.createElement("option",{value:"Red"},"Red"),i.a.createElement("option",{value:"Blue"},"Blue"),i.a.createElement("option",{value:"Green"},"Green")),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Source Cardinality"),i.a.createElement("div",{className:"CardinalityArea"}," ",i.a.createElement("div",{className:"LeftCheckboxLabel"}," Visible: ")," ",i.a.createElement("input",{type:"checkbox",id:"sourceCardinalityShown",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getSourceCardinalityVisibility(),onChange:function(){n.toggleSourceCardinalityVisibility(),Ta()}}),i.a.createElement("input",{type:"number",id:"sourceFromCardindality",className:"CardinalityBox",defaultValue:n.state.selectedObject.getSourceCardinalityLowerBound(),min:"0",max:"25",onChange:function(){return n.updateCardinality()}}),i.a.createElement("label",null,".."),i.a.createElement("input",{type:"number",id:"sourceToCardindality",className:"CardinalityBox",defaultValue:n.state.selectedObject.getSourceCardinalityUpperBound(),min:"-1",max:"25",onChange:function(){return n.updateCardinality()}})),i.a.createElement("label",{className:"LeftLabel"},"Destination Cardinality"),i.a.createElement("div",{className:"CardinalityArea"}," ",i.a.createElement("div",{className:"LeftCheckboxLabel"},"Visible:")," ",i.a.createElement("input",{type:"checkbox",id:"destCardinalityShown",className:"LeftCheckbox",defaultChecked:n.state.selectedObject.getDestCardinalityVisibility(),onChange:function(){n.toggleDestCardinalityVisibility(),Ta()}}),i.a.createElement("input",{type:"number",id:"destFromCardindality",className:"CardinalityBox",defaultValue:n.state.selectedObject.getDestCardinalityLowerBound(),min:"0",max:"25",onChange:function(){return n.updateCardinality()}}),i.a.createElement("label",null,".."),i.a.createElement("input",{type:"number",id:"destToCardindality",className:"CardinalityBox",defaultValue:n.state.selectedObject.getDestCardinalityUpperBound(),min:"-1",max:"25",onChange:function(){return n.updateCardinality()}})),i.a.createElement("label",{className:"LeftLabel"},"Source Label"),i.a.createElement("input",{id:"SourceLabel",className:"LeftTitle",defaultValue:n.state.selectedObject.sourceEdgeEnd.label,onKeyUp:function(){return n.setStartLabel()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("label",{className:"LeftLabel"},"Destination Label"),i.a.createElement("input",{id:"DestLabel",className:"LeftTitle",defaultValue:n.state.selectedObject.destEdgeEnd.label,onKeyUp:function(){return n.setEndLabel()}}),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){ja(n.state.selectedObject),n.deselectElement()}},"Remove"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return n.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0")):i.a.createElement("form",{id:"ArrowMenu"},i.a.createElement("div",{className:"LeftHeader"},"Selected Edge"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){return n.deselectElement()}},"Deselect"),i.a.createElement("label",{className:"LeftSpacer"},"\xa0"),i.a.createElement("button",{className:"LeftMenuButton",onClick:function(){ja(n.state.selectedObject),n.setState({menu:Fe.TreeView,selectedObject:null})}},"Remove"))),i.a.createElement("div",null,t,i.a.createElement("form",{ref:n.setFormRef,className:n.props.className},e))},n.state={menu:Fe.TreeView,selectedObject:null,fileNames:[],title:"",content:[]},n.setTitle=n.setTitle.bind(Object(f.a)(n)),n.setContent=n.setContent.bind(Object(f.a)(n)),n.handleChange=n.handleChange.bind(Object(f.a)(n)),n.formRef=null,n.setFormRef=function(e){n.formRef=e},n}return Object(u.a)(a,[{key:"handleChange",value:function(e){this.setState({title:e.target.value}),this.setState({title:""}),this.setTitle(),this.setContent()}},{key:"componentDidMount",value:function(){this.menu=this.props.mainState.menu,this.selectedItem=this.props.mainState.drawMode,this.props.setMode(this.selectedItem),document.addEventListener("keydown",this.onKeyPressed.bind(this)),this.setIconsStatic()}},{key:"onKeyPressed",value:function(e){46===e.keyCode&&("Vertex"===this.state.selectedObject.typeName?Ka(this.state.selectedObject):ja(this.state.selectedObject),this.setState({menu:"TreeView"}),Ta())}},{key:"componentDidUpdate",value:function(e,t,a){var n=document.getElementById("VertexMenu");null===n&&(n=document.getElementById("ArrowMenu")),null!==n&&n.addEventListener("keypress",(function(e){"Enter"===e.key&&e.preventDefault()}))}},{key:"setIcons",value:function(){var e=this;fetch(On+"/icons/list",{method:"GET",headers:{Accept:"*/*"}}).then((function(e){return e.json()})).then((function(t){var a=[];t.icons.forEach((function(e){a.push(e)})),console.log(a),e.setState({fileNames:a})}))}},{key:"setIconsStatic",value:function(){var e=Object(d.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=["Activity.png","Agent.png","BioSphere.png","Critical.png","Designed.png","Ecosystem.png","Error.png","Event.png","Grow_n.png","Human.png","Make_n.png","Move_n.png","Organic.png","Organisation.png","Play_n.png","Resource.png","SaaS_n.png","Social.png","Software.png","Sustain_n.png","Symbolic.png","Tacit Knowledge.png","Team.png","Trust.png","UI Device.png"],console.log(t),this.setState({fileNames:t}),console.log(this.state.fileNames);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setTitle",value:function(){var e=document.getElementById("LeftTitle").value;this.state.selectedObject.setTitle(e),un(this.state.selectedObject),Ta()}},{key:"setContent",value:function(){var e=document.getElementById("LeftContent").value;e=e.split("\n"),this.state.selectedObject.setContent(e),un(this.state.selectedObject),Ta()}},{key:"setLineType",value:function(){var e=document.getElementById("LineType").value;this.state.selectedObject.setLineType(e),Ta()}},{key:"setColour",value:function(){var e=document.getElementById("LineColour").value;this.state.selectedObject.setLineColour(e),Ta()}},{key:"setStartLabel",value:function(){var e=document.getElementById("SourceLabel").value;this.state.selectedObject.setStartLabel(e),Ta()}},{key:"setEndLabel",value:function(){var e=document.getElementById("DestLabel").value;this.state.selectedObject.setEndLabel(e),Ta()}},{key:"updateCardinality",value:function(){var e=document.getElementById("sourceFromCardindality").value,t=document.getElementById("sourceToCardindality").value,a=this.state.selectedObject.getSourceCardinalityVisibility(),n=document.getElementById("destFromCardindality").value,i=document.getElementById("destToCardindality").value,r=this.state.selectedObject.getDestCardinalityVisibility();this.state.selectedObject.updateSourceCardinality(e,t,a),this.state.selectedObject.updateDestCardinality(n,i,r),Ta()}},{key:"toggleSourceCardinalityVisibility",value:function(){this.state.selectedObject.toggleSourceCardinalityVisibility(),Ta()}},{key:"toggleDestCardinalityVisibility",value:function(){this.state.selectedObject.toggleDestCardinalityVisibility(),Ta()}},{key:"toggleAbstract",value:function(){this.state.selectedObject.toggleAbstract(),Ta()}},{key:"getS23MIconsSelector",value:function(){var e=this,t=[i.a.createElement("div",{className:"DropdownItem"},i.a.createElement("div",{className:"dropdownLabel"},"Name"),i.a.createElement("div",{className:"checkBoxContainer"},"Text"),i.a.createElement("div",{className:"checkBoxContainer"},"Icon"))],a="";return this.state.fileNames.forEach((function(n){"_n"===n.slice(-6,-4)?(a=n.slice(0,-6),t.push(i.a.createElement("div",{className:"DropdownItem",ref:n}," ",i.a.createElement("div",{className:"dropdownLabel"},a)," ",i.a.createElement("div",{className:"checkBoxContainer"},i.a.createElement("input",{type:"checkbox",disabled:"disabled"})," "),"  ",i.a.createElement("div",{className:"checkBoxContainer"},i.a.createElement("input",{type:"checkbox",defaultChecked:e.shouldIconBeSelected(n),onClick:function(){e.setIcon(n)}}))," "))):(a=n.slice(0,-4),t.push(i.a.createElement("div",{className:"DropdownItem",ref:n}," ",i.a.createElement("div",{className:"dropdownLabel"},a)," ",i.a.createElement("div",{className:"checkBoxContainer"},i.a.createElement("input",{type:"checkbox",defaultChecked:e.shouldTextBeSelected(n),onClick:function(){e.setText(n)}})," "),"  ",i.a.createElement("div",{className:"checkBoxContainer"},i.a.createElement("input",{type:"checkbox",defaultChecked:e.shouldIconBeSelected(n),onClick:function(){e.setIcon(n)}}))," ")))})),console.log("icon selector fired"),i.a.createElement(Ge.a,{title:"Category Selector",name:"Icons",id:"IconSelector",className:"IconSelector"},t)}},{key:"getColourPicker",value:function(){return i.a.createElement(Ge.a,{title:"Colour Selector",id:"ColourSelector"},i.a.createElement(Me.SketchPicker,{color:this.getVertexColour,onChangeComplete:this.setVertexColour,presetColors:["#FFD5A9","#F5B942","#FFFFFF"]}))}},{key:"shouldTextBeSelected",value:function(e){return this.state.selectedObject.isTextSet(e)}},{key:"shouldIconBeSelected",value:function(e){return this.state.selectedObject.isIconSet(e)}},{key:"setText",value:function(e){this.state.selectedObject.setText(e),Ta()}},{key:"setIcon",value:function(e){this.state.selectedObject.setIcon(e),Ta()}},{key:"setNavigable",value:function(e){this.state.selectedObject.toggleNavigable(e),document.getElementById("SourceIsNavigable").checked=this.state.selectedObject.getNavigable(0),document.getElementById("DestIsNavigable").checked=this.state.selectedObject.getNavigable(1),Ta()}},{key:"setAggregation",value:function(e){this.state.selectedObject.getNavigable(e)||this.state.selectedObject.toggleNavigable(e),this.state.selectedObject.toggleAggregation(e);var t=this.state.selectedObject.getAggregation(0),a=this.state.selectedObject.getAggregation(1);t&&(document.getElementById("SourceIsNavigable").checked=!0),a&&(document.getElementById("DestIsNavigable").checked=!0),document.getElementById("SourceIsAggregation").checked=t,document.getElementById("DestIsAggregation").checked=a,Ta()}},{key:"deselectElement",value:function(){this.props.setLeftMenu(null),Ta()}},{key:"showTreeView",value:function(){this.state.selectedObject(null),Ta()}},{key:"stripElement",value:function(e){e.preventDefault(),this.state.selectedObject.trimPath(),Ta()}},{key:"render",value:function(){var e=this.getMenu();return null!==this.formRef&&(this.formRef=null),e}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{menu:e.mainState.menu,selectedObject:e.mainState.selectedObject}}}]),a}(i.a.Component),ze=function(){function e(t,a,n,i){Object(h.a)(this,e),this.typeName="Arrow",void 0!==i||null===t?this.semanticIdentity=i:t.length>1?this.semanticIdentity=new x("Arrow from "+t[0].semanticIdentity.UUID+" to "+t[1].semanticIdentity.UUID,"","","",void 0,[]):1===t.length?this.semanticIdentity=new x("Arrow connecting "+t[0].semanticIdentity.UUID,"","","",void 0,[]):this.semanticIdentity=new x("Arrow connecting 1 or less vertices","","","",void 0,[]),this.sourceEdgeEnd=new Se(this.semanticIdentity.UUID),this.destEdgeEnd=new Se(this.semanticIdentity.UUID),1===a.length&&a.push(a[0]),this.pathData=a,this.sourceVertexUUID=null,this.destVertexUUID=null,this.updateAttachedVertices(),this.rebuildPath(),this.lineColour=ve,this.lineType=we,n===Qe.Edge||n===Qe.Specialisation||n===Qe.Visibility||console.log("Failed to find correct tool"),this.sourceEdgeEnd.type=ce,n===Qe.Edge?(this.destEdgeEnd.type=ce,this.typeName="Arrow"):n===Qe.Specialisation?(this.destEdgeEnd.type=he,this.typeName="Arrow"):n===Qe.Visibility?(this.destEdgeEnd.type=de,this.lineType=Ne,this.typeName="Arrow"):(console.log("Failed to find correct tool"),this.destEdgeEnd.type=ce),this.edgeType=n,this.selected=!1,this.sourceIsNavigable=!1,this.destIsNavigable=!1,this.sourceIsAggregation=!1,this.destIsAggregation=!1,this.arrowGraphKey=ba(),this.arrowContainerKey=Tt(this.arrowGraphKey)}return Object(u.a)(e,[{key:"setGraphKey",value:function(e){this.arrowGraphKey=e}},{key:"getGraphKey",value:function(){return this.arrowGraphKey}},{key:"setContainerKey",value:function(e){this.arrowContainerKey=e}},{key:"getContainerKey",value:function(){return this.arrowContainerKey}},{key:"toggleNavigable",value:function(e){0===e?this.sourceIsNavigable=!this.sourceIsNavigable:1===e&&(this.destIsNavigable=!this.destIsNavigable),this.sourceIsAggregation&&(this.sourceIsNavigable=!0),this.destIsAggregation&&(this.destIsNavigable=!0),this.sourceIsNavigable&&this.destIsNavigable?this.sourceIsAggregation?(this.sourceEdgeEnd.type=me,this.destEdgeEnd.type=de):this.destIsAggregation?(this.sourceEdgeEnd.type=de,this.destEdgeEnd.type=me):(this.sourceEdgeEnd.type=de,this.destEdgeEnd.type=de):this.sourceIsNavigable?this.sourceIsAggregation?(this.sourceEdgeEnd.type=me,this.destEdgeEnd.type=ce):(this.sourceEdgeEnd.type=de,this.destEdgeEnd.type=ce):this.destIsNavigable?this.destIsAggregation?(this.destEdgeEnd.type=me,this.sourceEdgeEnd.type=ce):(this.destEdgeEnd.type=de,this.sourceEdgeEnd.type=ce):(this.sourceEdgeEnd.type=ce,this.destEdgeEnd.type=ce)}},{key:"toggleAggregation",value:function(e){0===e?(this.sourceIsAggregation=!this.sourceIsAggregation,this.destIsAggregation&&this.sourceIsAggregation&&(this.destIsAggregation=!1)):(this.destIsAggregation=!this.destIsAggregation,this.destIsAggregation&&this.sourceIsAggregation&&(this.sourceIsAggregation=!1)),this.sourceIsAggregation?(this.sourceEdgeEnd.type=me,this.destIsNavigable?this.destEdgeEnd.type=de:this.destEdgeEnd.type=ce):this.destIsAggregation?(this.destEdgeEnd.type=me,this.sourceIsNavigable?this.sourceEdgeEnd.type=de:this.sourceEdgeEnd.type=ce):this.toggleNavigable(100)}},{key:"getNavigable",value:function(e){return 0===e?this.sourceIsNavigable:this.destIsNavigable}},{key:"getAggregation",value:function(e){return 0===e?this.sourceIsAggregation:this.destIsAggregation}},{key:"trimPath",value:function(){this.pathData=[this.pathData[0],this.pathData[this.pathData.length-1]],this.path=[this.path[0],this.path[this.path.length-1]]}},{key:"rebuildPath",value:function(){var e=this.getObjectUUIDList(),t=[];e.forEach((function(e){t.push(qa(e))})),this.path=[];for(var a=0;a<this.pathData.length;a++){var n=this.pathData[a];0===n[0]?this.path.push(this.getZerothCasePathItem(t,n)):1===n[0]?this.path.push([n[1],n[2]]):console.error("Invalid PathData case, wrong case",n)}}},{key:"getZerothCasePathItem",value:function(e,t){for(var a=0;a<e.length;a++){if(null!==e[a]&&void 0!==e[a])if(e[a].semanticIdentity.UUID===t[1])return[t[2]*e[a].width+e[a].x,t[3]*e[a].realHeight+e[a].y]}return console.log(" [Ignore this when importing] Could not find vertex to connect for pathItem",t),null}},{key:"getObjectUUIDList",value:function(){var e=this,t=[];return this.pathData.forEach((function(a){var n=e.pathData.indexOf(a);null==a&&(e.pathData[n]=[1,e.path[n][0],e.path[n][1]]),0===e.pathData[n][0]&&t.push(a[1])})),t}},{key:"updateAttachedVertices",value:function(){var e=this.pathData[0],t=this.pathData[this.pathData.length-1];0===e[0]?this.sourceVertexUUID=e[1]:this.sourceVertexUUID=null,0===t[0]?this.destVertexUUID=t[1]:this.destVertexUUID=null}},{key:"setSelected",value:function(e){this.selected=e}},{key:"updateSourceCardinality",value:function(e,t,a){this.sourceEdgeEnd.updateCardinality(e,t,a)}},{key:"getSourceCardinalityVisibility",value:function(){return this.sourceEdgeEnd.cardinality.isVisible}},{key:"toggleSourceCardinalityVisibility",value:function(){this.sourceEdgeEnd.cardinality.toggleVisibility()}},{key:"getSourceCardinalityLowerBound",value:function(){return this.sourceEdgeEnd.cardinality.lowerBound}},{key:"getSourceCardinalityUpperBound",value:function(){return this.sourceEdgeEnd.cardinality.upperBound}},{key:"updateDestCardinality",value:function(e,t,a){this.destEdgeEnd.updateCardinality(e,t,a)}},{key:"getDestCardinalityVisibility",value:function(){return this.destEdgeEnd.cardinality.isVisible}},{key:"toggleDestCardinalityVisibility",value:function(){this.destEdgeEnd.cardinality.toggleVisibility()}},{key:"getDestCardinalityLowerBound",value:function(){return this.destEdgeEnd.cardinality.lowerBound}},{key:"getDestCardinalityUpperBound",value:function(){return this.destEdgeEnd.cardinality.upperBound}},{key:"setStartLabel",value:function(e){this.sourceEdgeEnd.label=e}},{key:"setEndLabel",value:function(e){this.destEdgeEnd.label=e}},{key:"setLineColour",value:function(e){var t=Ee[e];void 0!==t?this.lineColour=t:console.log("Attempted to assign invalid lineColour: %s",e)}},{key:"setLineType",value:function(e){var t=ke[e];void 0!==t?this.lineType=t:console.log("Attempted to assign invalid lineType: %s",e)}},{key:"createPathNodesForVertex",value:function(e,t,a){var n=t++,i=t++,r=t++,s=t++,l=t++,o=t++,c=t++,d=t++,h=[];return h.push([n,e.x-a,e.y+e.height+a,[d,i]]),h.push([i,e.x+e.width/2,e.y+e.height+a,[n,r]]),h.push([r,e.x+e.width+a,e.y+e.height+a,[i,s]]),h.push([s,e.x+e.width+a,e.y+e.height/2,[r,l]]),h.push([l,e.x+e.width+a,e.y-a,[s,o]]),h.push([o,e.x+e.width/2,e.y-a,[l,c]]),h.push([c,e.x-a,e.y-a,[l,d]]),h.push([d,e.x-a,e.y+e.height/2,[c,n]]),[t,h]}},{key:"drawStartHead",value:function(e){var t=Math.atan2(this.getSY()-this.getNSY(),this.getSX()-this.getNSX());this.sourceEdgeEnd.draw(e,this.getSX(),this.getSY(),t,this.lineColour)}},{key:"drawEndHead",value:function(e){var t=Math.atan2(this.getEY()-this.getNEY(),this.getEX()-this.getNEX());this.destEdgeEnd.draw(e,this.getEX(),this.getEY(),t,this.lineColour)}},{key:"isPathSegmentLR",value:function(e,t){var a=this.path[e][0],n=this.path[t][0],i=this.path[e][1],r=this.path[t][1];return Math.abs(a-n)>Math.abs(i-r)}},{key:"getTextOffsets",value:function(e,t,a,n,i){var r,s,l,o,c,d,h,u,f=e.measureText(t).width,m=e.measureText(a).width,A=e.measureText(n).width,y=e.measureText(i).width,v=e.measureText("M").width,g=!0,p=!0,b=!0,x=!0,E=this.path.length-2,w=this.path.length-1,N=this.isPathSegmentLR(0,1),C=this.isPathSegmentLR(E,w),k=this.path[0][0],I=this.path[0][1],S=this.path[1][0],M=this.path[1][1],V=this.path[E][0],O=this.path[E][1],D=this.path[w][0],L=this.path[w][1];return N?k>S&&(g=!g):I>M&&(p=!p),C?V>D&&(b=!b):O>L&&(x=!x),g?(r=v/2,c=N?v/2:-1*(A+v/2)):(r=-1*(f+v/2),c=N?-1*(A+v/2):v/2),p?(s=15,d=N?-7.5:s):(s=-7.5,d=N?s:-7.5),(b=!b)?(l=v/2,h=C?v/2:-1*(y+v/2)):(l=-1*(m+v/2),h=C?-1*(y+v/2):v/2),(x=!x)?(o=15,u=C?-7.5:o):(o=-7.5,u=C?15:o),[r,s,l,o,c,d,h,u]}},{key:"drawLabelsAndCardinalities",value:function(e){var t=this.sourceEdgeEnd.cardinality.toString(),a=this.destEdgeEnd.cardinality.toString(),n=this.getTextOffsets(e,this.sourceEdgeEnd.label,this.destEdgeEnd.label,t,a);e.fillStyle="#000",e.fillText(this.sourceEdgeEnd.label,this.getSX()+n[0],this.getSY()+n[1]),e.fillText(this.destEdgeEnd.label,this.getEX()+n[2],this.getEY()+n[3]),this.getSourceCardinalityVisibility()&&e.fillText(t,this.getSX()+n[4],this.getSY()+n[5]),this.getDestCardinalityVisibility()&&e.fillText(a,this.getEX()+n[6],this.getEY()+n[7])}},{key:"draw",value:function(e){switch(this.lineType){case we:e.setLineDash([]);break;case Ne:e.setLineDash([5,5]);break;default:console.log("Arrow had invalid lineType: %s",this.lineType)}e.strokeStyle=this.lineColour;for(var t=0;t<this.path.length-1;t++){var a=this.path[t],n=this.path[t+1];e.beginPath(),e.moveTo(a[0],a[1]),e.lineTo(n[0],n[1]),e.stroke()}if(e.strokeStyle="#000",e.setLineDash([]),this.drawStartHead(e),this.drawEndHead(e),this.drawLabelsAndCardinalities(e),this.selected)for(var i=0;i<this.path.length;i++){var r=this.path[i];cn(r[0],r[1])}}},{key:"intersects",value:function(e,t){for(var a=0;a<this.path.length-1;a++){var n=this.path[a],i=this.path[a+1];if(this.intersectsSegment(e,t,n,i))return!0}return!1}},{key:"intersectsSegment",value:function(e,t,a,n){return dn(e,t,a[0],a[1])+dn(e,t,n[0],n[1])-1<dn(a[0],a[1],n[0],n[1])}},{key:"getSX",value:function(){return this.path[0][0]}},{key:"getSY",value:function(){return this.path[0][1]}},{key:"getNSX",value:function(){return this.path[1][0]}},{key:"getNSY",value:function(){return this.path[1][1]}},{key:"getNEX",value:function(){var e=this.path.length-2;return e<0&&(e=0),this.path[e][0]}},{key:"getNEY",value:function(){var e=this.path.length-2;return e<0&&(e=0),this.path[e][1]}},{key:"getEX",value:function(){return this.path[this.path.length-1][0]}},{key:"getEY",value:function(){return this.path[this.path.length-1][1]}}]),e}();function qe(){var e=oa.flatten(!0,!1),t=oa.flatten(!1,!0),a=JSON.parse(JSON.stringify(et)),n=JSON.parse(JSON.stringify(ut())),i=JSON.parse(JSON.stringify(mt())),r=JSON.parse(JSON.stringify(yt())),s=JSON.parse(JSON.stringify(gt())),l=JSON.parse(JSON.stringify(xt())),o=JSON.parse(JSON.stringify(wt())),c=ga(),d=Ea(),h=ya(),u=ya(),f=dt();return{translationColumns:J,vertices:e,arrows:t,tree:a,packages:n,dPackages:i,treeVertex:r,dTreeVertex:s,graph:l,dGraph:o,containerKeys:c,graphKeys:d,currentKey:u,currentGra:h,currentPack:f}}function Xe(e){if(null!=e){var t,a=JSON.parse(e),n=Object(y.a)(a.treeVertex);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.semanticIdentity=new x(i.semanticIdentity.name,i.semanticIdentity.description,i.semanticIdentity.abbreviation,i.semanticIdentity.shortAbbreviation,i.semanticIdentity.UUID,i.semanticIdentity.translations)}}catch(v){n.e(v)}finally{n.f()}var r,s=[],l=[],o=Object(y.a)(a.vertices);try{for(o.s();!(r=o.n()).done;){var c=r.value;ct(c.vertexContainerKey),va(c.vertexContainerKey),xa(c.vertexGraphKey),c.semanticIdentity=new x(c.semanticIdentity.name,c.semanticIdentity.description,c.semanticIdentity.abbreviation,c.semanticIdentity.shortAbbreviation,c.semanticIdentity.UUID,c.semanticIdentity.translations),c=new Qt({newConstructor:1,loadedVertex:c}),s.push(c)}}catch(v){o.e(v)}finally{o.f()}var d,h=Object(y.a)(a.arrows);try{for(h.s();!(d=h.n()).done;){var u=d.value;ct(u.arrowContainerKey),va(u.arrowContainerKey),xa(u.arrowGraphKey),u=A(u),l.push(u)}}catch(v){h.e(v)}finally{h.f()}oe(a.translationColumns),ft(a.packages),At(a.dPackages),vt(a.treeVertex),pt(a.dTreeVertex),Et(a.graph),Nt(a.dGrraph),ht(a.tree),ma(a.containerKeys),Aa(a.graphKeys),Ya(new N(s,l)),sn(),ct(1),va(1),xa(1),Ta(),console.log("load finished")}function f(e){return new x(e.name,e.description,e.abbreviation,e.shortAbbreviation,e.UUID,e.translations)}function m(e){return new Se(e.attachedToUUID,e.headType,(t=e.cardinality,new Ie(t.numLowerBound,t.numUpperBound,t.attachedToUUID,t.isVisible,f(t.semanticIdentity))),e.label,f(e.semanticIdentity));var t}function A(e){var t=new ze(s,e.pathData,e.edgeType,f(e.semanticIdentity));return t.sourceEdgeEnd=m(e.sourceEdgeEnd),t.destEdgeEnd=m(e.destEdgeEnd),t}}function Je(e){if(null!=e){var t,a=JSON.parse(e),n=[],i=[],r=[],s=ga(),l=Ea(),o=Object(y.a)(a.packages);try{for(o.s();!(t=o.n()).done;){var c=t.value;s++;var d={originalKey:c.containerKey,originalParentKey:c.parentContainerKey,newKey:s,newParentKey:0};n.push(d)}}catch(Ae){o.e(Ae)}finally{o.f()}var h,u=Object(y.a)(a.treeVertex);try{for(u.s();!(h=u.n()).done;){var f=h.value;s++;var m={originalKey:f.containerKey,originalParentKey:f.parentContainerKey,newKey:s,newParentKey:0};n.push(m)}}catch(Ae){u.e(Ae)}finally{u.f()}var A,v=Object(y.a)(a.graph);try{for(v.s();!(A=v.n()).done;){var g=A.value;l++;var p={originalGraphKey:g.graphKey,originalKey:g.containerKey,newGraphKey:l,newKey:0};i.push(p)}}catch(Ae){v.e(Ae)}finally{v.f()}for(var b=0,E=n;b<E.length;b++){var w,N=E[b],C=Object(y.a)(n);try{for(C.s();!(w=C.n()).done;){var k=w.value;N.originalParentKey===k.originalKey&&(N.newParentKey=k.newKey)}}catch(Ae){C.e(Ae)}finally{C.f()}}for(var I=0,S=i;I<S.length;I++){var M,V=S[I],O=Object(y.a)(n);try{for(O.s();!(M=O.n()).done;){var D=M.value;V.originalKey===D.originalKey&&(V.newKey=D.newKey)}}catch(Ae){O.e(Ae)}finally{O.f()}}for(var L=0;L<a.packages.length;L++)a.packages[L].containerKey=n[L].newKey,a.packages[L].parentContainerKey=n[L].newParentKey,a.packages[L].data.containerKey=n[L].newKey,a.packages[L].data.parentContainerKey=n[L].newParentKey,a.dPackages[L].containerKey=n[L].newKey,a.dPackages[L].parentContainerKey=n[L].newParentKey;for(var U=a.packages.length;U<a.packages.length+a.treeVertex.length;U++)a.treeVertex[U-a.packages.length].containerKey=n[U].newKey,a.treeVertex[U-a.packages.length].parentContainerKey=n[U].newParentKey,a.treeVertex[U-a.packages.length].data.containerKey=n[U].newKey,a.treeVertex[U-a.packages.length].data.parentContainerKey=n[U].newParentKey,a.dTreeVertex[U-a.packages.length].containerKey=n[U].newKey,a.dTreeVertex[U-a.packages.length].parentContainerKey=n[U].newParentKey;for(var T=0;T<a.graph.length;T++)a.graph[T].containerKey=i[T].newKey,a.graph[T].graphKey=i[T].newGraphKey,a.graph[T].data.containerKey=i[T].newKey,a.graph[T].data.graphKey=i[T].newGraphKey,a.dGraph[T].containerKey=i[T].newKey,a.dGraph[T].graphKey=i[T].newGraphKey;for(var j=0,K=n;j<K.length;j++){var P,B=K[j],G=Object(y.a)(a.vertices);try{for(G.s();!(P=G.n()).done;){var F=P.value;F.vertexContainerKey===B.originalKey&&(F.vertexContainerKey=B.newKey)}}catch(Ae){G.e(Ae)}finally{G.f()}var H,R=Object(y.a)(a.arrows);try{for(R.s();!(H=R.n()).done;){var Q=H.value;Q.arrowContainerKey!==B.originalKey||r.includes(Q)||(Q.arrowContainerKey=B.newKey,r.push(Q))}}catch(Ae){R.e(Ae)}finally{R.f()}}for(var Y=0,z=i;Y<z.length;Y++){var q,X=z[Y],J=Object(y.a)(a.vertices);try{for(J.s();!(q=J.n()).done;){var W=q.value;W.vertexGraphKey===X.originalGraphKey&&(W.vertexGraphKey=X.newGraphKey)}}catch(Ae){J.e(Ae)}finally{J.f()}var Z,_=Object(y.a)(a.arrows);try{for(_.s();!(Z=_.n()).done;){var $=Z.value;$.arrowGraphKey===X.originalGraphKey&&($.arrowGraphKey=X.newGraphKey)}}catch(Ae){_.e(Ae)}finally{_.f()}}var ee,te=[],ae=[],ne=Object(y.a)(a.vertices);try{for(ne.s();!(ee=ne.n()).done;){var ie=ee.value;ie.semanticIdentity=new x(ie.semanticIdentity.name,ie.semanticIdentity.description,ie.semanticIdentity.abbreviation,ie.semanticIdentity.shortAbbreviation,ie.semanticIdentity.UUID,ie.semanticIdentity.translations),ie=new Qt({newConstructor:1,loadedVertex:ie}),te.push(ie)}}catch(Ae){ne.e(Ae)}finally{ne.f()}var re,se=Object(y.a)(a.arrows);try{for(se.s();!(re=se.n()).done;){var le=re.value;le=me(le),ae.push(le)}}catch(Ae){se.e(Ae)}finally{se.f()}ft(ut().concat(a.packages)),At(mt().concat(a.dPackages)),vt(yt().concat(a.treeVertex)),pt(gt().concat(a.dTreeVertex)),Et(xt().concat(a.graph)),Nt(wt().concat(a.dGraph));for(var oe=0,ce=te;oe<ce.length;oe++){Qa(ce[oe])}for(var de=0,he=ae;de<he.length;de++){Qa(he[de])}ct(dt()),va(ya()),xa(ya()),ma(s),Aa(l),sn(),Ta()}function ue(e){return new x(e.name,e.description,e.abbreviation,e.shortAbbreviation,e.UUID,e.translations)}function fe(e){return new Se(e.attachedToUUID,e.headType,(t=e.cardinality,new Ie(t.numLowerBound,t.numUpperBound,t.attachedToUUID,t.isVisible,ue(t.semanticIdentity))),e.label,ue(e.semanticIdentity));var t}function me(e){var t=new ze(te,e.pathData,e.edgeType,ue(e.semanticIdentity));return t.setContainerKey(e.arrowContainerKey),t.setGraphKey(e.arrowGraphKey),t.sourceEdgeEnd=fe(e.sourceEdgeEnd),t.destEdgeEnd=fe(e.destEdgeEnd),t}}function We(e){oe(e.translationColumns),ft(e.packages),At(e.dPackages),vt(e.treeVertex),pt(e.dTreeVertex),Et(e.graph),Nt(e.dGrraph),ht(e.tree),ma(e.containerKeys),Aa(e.graphKeys),Ya(new N(e.vertices,e.arrows)),sn(),ct(e.currentCon),va(e.currentKey),xa(e.currentGra),Ta()}var Ze=[],_e=0;function $e(){var e=Object.assign({},qe());if(0!==_e){for(var t=0;t<_e;t++)Ze.shift();_e=0}Ze.unshift(e),Ze.length>10&&Ze.pop()}var et=[],tt=[],at=[],nt=[],it=[],rt=[],st=[],lt=[],ot=0;function ct(e){ot=e}function dt(){return ot}function ht(e){et=e}function ut(){return tt}function ft(e){tt=e}function mt(){return at}function At(e){at=e}function yt(){return nt}function vt(e){nt=e}function gt(){return it}function pt(e){it=e}function bt(){return tt.concat(nt)}function xt(){return rt}function Et(e){rt=e}function wt(){return st}function Nt(e){st=e}function Ct(){rt.length>0?(va(rt[0].data.containerKey),xa(rt[0].data.graphKey),ct(rt[0].data.containerKey)):(va(0),xa(-1),ct(0));var e,t=Object(y.a)(oa.flatten());try{for(t.s();!(e=t.n()).done;){var a=e.value;"Vertex"===a.typeName&&a.getGraphKey()===ba()?a.setPresent():a.getGraphKey()!==ba()&&"Vertex"===a.typeName&&a.setAway()}}catch(n){t.e(n)}finally{t.f()}Ta()}function kt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;pa();var a={text:e+" \ud83d\udcc1",children:et[ga()],data:NaN,state:{opened:!0},type:"Package",typeName:"Package",containerKey:ga(),parentContainerKey:t};at.push(a);var n={text:e+" \ud83d\udcc1",children:et[ga()],data:at[tt.length],state:{opened:!0},type:"Package",typeName:"Package",containerKey:ga(),parentContainerKey:t};tt.push(n)}function It(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;pa();var a=new x(e,"","","",void 0,[]),n={text:e+" \ud83d\udfe7",children:et[ga()],data:NaN,state:{opened:!0},type:"treeVertex",typeName:"VertexNode",originalVertex:!0,containerKey:ga(),parentContainerKey:t,content:"",colour:"#FFD5A9",height:50,width:70,icons:[[],[],[]],imageElements:{},fontSize:12,semanticIdentity:a};it.push(n);var i={text:e+" \ud83d\udfe7",children:et[ga()],data:it[nt.length],state:{opened:!0},type:"treeVertex",typeName:"VertexNode",originalVertex:!0,containerKey:ga(),parentContainerKey:t,content:"",colour:"#FFD5A9",height:50,width:70,icons:[[],[],[]],imageElements:{},fontSize:12,semanticIdentity:a};return nt.push(i),i}function St(e){for(var t=0;t<tt.length;t++)tt[t].containerKey===e&&(Vt(tt[t]),at.splice(t,1),tt.splice(t,1));Ct()}function Mt(e){var t,a=Object(y.a)(oa.flatten());try{for(a.s();!(t=a.n()).done;){var n=t.value;n.originalUUID===e&&oa.remove(n)}}catch(r){a.e(r)}finally{a.f()}for(var i=0;i<nt.length;i++)nt[i].semanticIdentity.UUID===e&&(nt.splice(i,1),it.splice(i,1));Ta()}function Vt(e){for(var t=e.children,a=0;a<t.length;a++){if("Package"===t[a].type)St(t[a].containerKey);else if("Graph"===t[a].type){Lt(t[a].graphKey)}else if("treeVertex"===t[a].type){Mt(t[a].semanticIdentity.UUID)}}}function Ot(e,t){if(""!==e){for(var a=0;a<tt.length;a++)if(tt[a].containerKey===t){tt[a].text=e+" \ud83d\udcc1",tt[a].data.text=e+" \ud83d\udcc1";break}}else console.log("Cannot have empty name")}function Dt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt();if(!(t<=0)){wa();var a={text:e+" \ud83d\udcc8",children:[],data:NaN,state:{opened:!0},type:"Graph",typeName:"Graph",containerKey:t,graphKey:Ea()};st.push(a);var n={text:e+" \ud83d\udcc8",children:[],data:st[rt.length],state:{opened:!0},type:"Graph",typeName:"Graph",containerKey:t,graphKey:Ea()};rt.push(n)}}function Lt(e){for(var t=0;t<rt.length;t++)rt[t].graphKey===e&&(rt.splice(t,1),st.splice(t,1));Ct()}function Ut(e,t){for(var a=0;a<rt.length;a++)if(rt[a].graphKey===t){rt[a].text=e+" \ud83d\udcc8",rt[a].data.text=e+" \ud83d\udcc8";break}}function Tt(e){for(var t=0;t<rt.length;t++)if(rt[t].graphKey===e)return rt[t].containerKey}function jt(e,t){var a,n=Object(y.a)(rt);try{for(n.s();!(a=n.n()).done;){var i=a.value;if(i.graphKey===e){var r,s=Object(y.a)(i.children);try{for(s.s();!(r=s.n()).done;){var l,o=r.value.children,c=Object(y.a)(o);try{for(c.s();!(l=c.n()).done;){var d=l.value;d.containerkey=t,"Vertex"===d.data.typeName?d.data.vertexContainerKey=t:d.data.arrowContainerKey=t}}catch(h){c.e(h)}finally{c.f()}}}catch(h){s.e(h)}finally{s.f()}i.containerKey=t}}}catch(h){n.e(h)}finally{n.f()}$e()}function Kt(e){var t,a=[],n=0,i=Object(y.a)(et);try{for(i.s();!(t=i.n()).done;){var r=t.value;void 0!==r&&"Graph"===r.type&&r.containerKey===e&&a.push(et[n]),n+=1}}catch(s){i.e(s)}finally{i.f()}return a}function Pt(e){var t,a=[],n=Object(y.a)(bt());try{for(n.s();!(t=n.n()).done;){var i=t.value;i.parentContainerKey===e&&a.push(i)}}catch(r){n.e(r)}finally{n.f()}return a}function Bt(e){return rt.find((function(t){return t.graphKey===e})).text}var Gt=!1,Ft=function(e){Object(m.a)(a,e);var t=Object(A.a)(a);function a(e){var n;Object(h.a)(this,a),n=t.call(this,e),et=[],!1===Gt&&(kt("Package"),Dt("Graph",1),kt("SubPackage",1),It("Vertex",1),It("Vertex 2",1),kt("Package 2"),Dt("Graph 2",5),It("Vertex 3",5),va(1),xa(1),ct(1),Gt=!0,$e());var i,r=Object(y.a)(rt);try{for(r.s();!(i=r.n()).done;){var s=i.value;et.push(s)}}catch(k){r.e(k)}finally{r.f()}var l,o=Object(y.a)(bt());try{for(o.s();!(l=o.n()).done;){var c=l.value,d=Kt(c.containerKey),u=Pt(c.containerKey),f=d.concat(u);c.children=f}}catch(k){o.e(k)}finally{o.f()}var m,A=Object(y.a)(bt());try{for(A.s();!(m=A.n()).done;){var v=m.value,g=new E;void 0!==g.toTreeViewElement("Arrow Package",v.containerKey)&&v.children.push(g.toTreeViewElement("Arrow Package",v.containerKey))}}catch(k){A.e(k)}finally{A.f()}var p,b=Object(y.a)(yt());try{for(b.s();!(p=b.n()).done;){var x=p.value;0===x.children.length?(x.text=x.text.replace(" \ud83d\udfe7",""),x.text=x.text.replace(" \ud83d\udcc2",""),x.text=x.text+" \ud83d\udfe7"):(x.text=x.text.replace(" \ud83d\udfe7",""),x.text=x.text.replace(" \ud83d\udcc2",""),x.text=x.text+" \ud83d\udcc2")}}catch(k){b.e(k)}finally{b.f()}lt=[];var w,N=Object(y.a)(bt());try{for(N.s();!(w=N.n()).done;){var C=w.value;0===C.parentContainerKey&&lt.push(C)}}catch(k){N.e(k)}finally{N.f()}return n.state={data:{core:{data:[{text:"Root",children:lt,state:{opened:!0},root:!0}]}},selectedVertex:null},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){document.getElementById("LowerPanel").addEventListener("dragstart",this.dragStart)}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){document.getElementById("LowerPanel").removeEventListener("dragstart",this.dragStart)}},{key:"dragStart",value:function(e){e.target.click();var t,a=0,n=Object(y.a)(bt());try{for(n.s();!(t=n.n()).done;){var i=t.value;dt()===i.containerKey&&(a=i)}}catch(s){n.e(s)}finally{n.f()}var r=a;"treeVertex"===a.type?e.dataTransfer.setData("text/plain",r.semanticIdentity.UUID):console.log("This object has no drag/drop feature")}}]),Object(u.a)(a,[{key:"handleElementSelect",value:function(e,t){try{if("Package"===t.node.data.type||"treeVertex"===t.node.data.type)ct(t.node.data.containerKey);else if("Graph"===t.node.data.type){xa(t.node.data.graphKey),va(t.node.data.containerKey),ct(t.node.data.containerKey);var a,n=Object(y.a)(oa.flatten());try{for(n.s();!(a=n.n()).done;){var i=a.value;"Vertex"===i.typeName&&i.getGraphKey()===ba()?i.setPresent():i.getGraphKey()!==ba()&&"Vertex"===i.typeName&&i.setAway()}}catch(u){n.e(u)}finally{n.f()}}else if(1===t.selected.length&&null!==t.node.data&&void 0===t.node.data.type){var r,s=t.node.data.semanticIdentity.UUID,l=Object(y.a)(oa.flatten());try{for(l.s();!(r=l.n()).done;){var o=r.value;if(o.semanticIdentity.UUID===s){this.setState({selectedVertex:o}),va(o.vertexContainerKey),xa(o.vertexGraphKey),ct(o.vertexContainerKey);var c,d=Object(y.a)(oa.flatten());try{for(d.s();!(c=d.n()).done;){var h=c.value;"Vertex"===h.typeName&&h.getGraphKey()===ba()?h.setPresent():h.getGraphKey()!==ba()&&"Vertex"===h.typeName&&h.setAway()}}catch(u){d.e(u)}finally{d.f()}this.props.setLeftMenu(this.state.selectedVertex)}}}catch(u){l.e(u)}finally{l.f()}}else this.setState({selectedVertex:null});Ta()}catch(e){console.log("If True,a null type error has been caught, If the selected object should be selectable, this is an issue")}try{!0===t.node.original.root&&ct(0)}catch(e){}}},{key:"render",value:function(){var e=this,t=this.state.data;return i.a.createElement("div",null,i.a.createElement(p.a,{treeData:t,onChange:function(t,a){return e.handleElementSelect(t,a)},className:"treeview",id:"treeview",draggable:"true"}))}}]),a}(i.a.Component),Ht=a(199),Rt=5,Qt=function(){function e(t){var a=t.title,n=void 0===a?"unnamed":a,i=t.content,r=t.colour,s=t.x,l=t.y,o=t.width,c=t.height,d=t.semanticIdentity,u=t.newConstructor,f=void 0===u?0:u,m=t.loadedVertex,A=void 0===m?0:m;Object(h.a)(this,e),1===f?(this.typeName=A.typeName,this.semanticIdentity=A.semanticIdentity,this.title=A.title,this.content=A.content,this.colour=A.colour,this.x=A.x,this.y=A.y,this.icons=A.icons,this.selected=!1,this.imageElements=A.imageElement,this.fontSize=12,this.orignalVertex=A.orignalVertex,this.originalUUID=A.originalUUID,this.Origin=A.Origin,this.width=A.width,this.height=A.height,this.realHeight=A.realHeight,this.isAbstract=A.isAbstract,this.vertexPath=A.vertexPath,this.vertexGraphKey=A.vertexGraphKey,this.vertexContainerKey=A.vertexContainerKey,this.renderedx=A.renderedx,this.renderedy=A.renderedy,this.awayx=A.awayx,this.awayy=A.awayy,this.status=A.status):(this.typeName="Vertex",this.semanticIdentity=void 0!==d?d:new x(n,"","","",void 0,[]),this.title=n,this.content=void 0===i?"":i,this.colour=r,this.x=s,this.y=l,this.icons=[[],[],[]],this.selected=!1,this.imageElements={},this.fontSize=12,this.orignalVertex=!0,this.isContainer=!1,this.Origin="",this.width=o,this.height=c,this.realHeight=c,this.width=Math.max(o,30),this.height=Math.max(c,30),this.isAbstract=!1,this.vertexPath="",this.vertexGraphKey=ba(),this.vertexContainerKey=Tt(this.vertexGraphKey),this.renderedx=s,this.renderedy=l,this.awayx=Math.floor(2e6*Math.random())+1e5,this.awayy=Math.floor(2e6*Math.random())+1e5,this.status="present")}return Object(u.a)(e,[{key:"setAway",value:function(){"present"===this.status&&(this.renderedx=this.x,this.renderedy=this.y,this.x=this.awayx,this.y=this.awayy,this.status="away")}},{key:"setPresent",value:function(){"away"===this.status&&(this.x=this.renderedx,this.y=this.renderedy,this.status="present")}},{key:"setGraphKey",value:function(e){this.vertexGraphKey=e}},{key:"getGraphKey",value:function(){return this.vertexGraphKey}},{key:"getSemantic",value:function(){return this.SemanticIdentity}},{key:"setSemantic",value:function(e){this.SemanticIdentity=e}},{key:"setContainerKey",value:function(e){this.vertexContainerKey=e}},{key:"getContainerKey",value:function(){return this.vertexContainerKey}},{key:"setPath",value:function(e){this.vertexPath=e}},{key:"getPath",value:function(){return this.vertexPath}},{key:"setSelected",value:function(e){this.selected=e}},{key:"getColour",value:function(){return this.colour}},{key:"setColour",value:function(e){this.colour=e}},{key:"setTitle",value:function(e){this.title=e,this.semanticIdentity.name=e}},{key:"setContent",value:function(e){this.content=e,this.semanticIdentity.description=e}},{key:"getAbstract",value:function(){return this.isAbstract}},{key:"toggleAbstract",value:function(){this.isAbstract=!this.isAbstract}},{key:"setOrigin",value:function(e){this.Origin=e}},{key:"getOrigin",value:function(){return this.Origin}},{key:"getContentAsString",value:function(){if(null!==this.content){for(var e="",t=0;t<this.content.length;t++)e=e.concat(this.content[t]),t<this.content.length-1&&(e=e.concat("\n"));return e}return""}},{key:"setIcon",value:function(e){var t=this.icons[0],a=this.icons[1],n=this.icons[2],i=t.indexOf(e);-1===i?(t.push(e),a.push(!0),n.push(!1)):a[i]=!a[i],!1===n[i]&&!1===a[i]&&(a.splice(i,1),n.splice(i,1),t.splice(i,1)),console.log("iconed")}},{key:"setText",value:function(e){var t=this.icons[0],a=this.icons[1],n=this.icons[2],i=t.indexOf(e);-1===i?(t.push(e),a.push(!1),n.push(!0)):n[i]=!n[i],!1===n[i]&&!1===a[i]&&(a.splice(i,1),n.splice(i,1),t.splice(i,1))}},{key:"isIconSet",value:function(e){var t=this.icons[0].indexOf(e);return-1!==t&&this.icons[1][t]}},{key:"isTextSet",value:function(e){var t=this.icons[0].indexOf(e);return-1!==t&&this.icons[2][t]}},{key:"getBounds",value:function(){return[this.x,this.y,this.x+this.width,this.y+this.realHeight-Rt]}},{key:"expandSide",value:function(e,t,a,n){var i=0,r=0,s=this.hasContent()?4*Rt:2*Rt;switch(e){case"topLeft":r+=this.y+this.height,this.y=a,this.height=r-this.y,i+=this.x+this.width,this.x=t,this.width=i-this.x;break;case"topRight":r+=this.y+this.height,this.y=a,this.height=r-this.y,this.width=t-this.x;break;case"bottomLeft":this.height=a-this.y-this.iconAreaHeight-this.contentHeight-s,i+=this.x+this.width,this.x=t,this.width=i-this.x;break;case"bottomRight":this.height=a-this.y-this.iconAreaHeight-this.contentHeight-s,this.width=t-this.x;break;case"left":i+=this.x+this.width,this.x=t,this.width=i-this.x;break;case"right":this.width=t-this.x;break;case"top":r+=this.y+this.height,this.y=a,this.height=r-this.y;break;case"bottom":this.height=a-this.y-this.iconAreaHeight-this.contentHeight-s}this.height=Math.max(this.height,12+Rt),this.draw(n)}},{key:"increaseWidthIfNecessary",value:function(e,t){t>this.width&&(this.width=t)}},{key:"hasContent",value:function(){return!(""===this.content[0]&&1===this.content.length)}},{key:"draw",value:function(e){for(var t=this,a=this.icons[0].length,n=0;n<this.icons[0].length;n++)!0===this.icons[1][n]?!0===this.icons[2][n]&&this.increaseWidthIfNecessary(e,20+e.measureText("<< "+this.icons[0][n]+" >>").width):!0===this.icons[2][n]&&this.increaseWidthIfNecessary(e,e.measureText("<< "+this.icons[0][n]+" >>").width);this.increaseWidthIfNecessary(e,e.measureText(this.title+this.Origin).width);for(var i=0;i<this.content.length;i++)this.increaseWidthIfNecessary(e,e.measureText(this.content[i]).width+2*Rt);Rt=5,this.is&&(e.font=this.fontSize+"px Segoe UI"),e.fontSize=this.fontSize;var r=e.measureText(this.title+this.Origin).width,s=Math.max(r+2*Rt,this.width);this.contentHeight=0;for(var l=0;l<this.content.length;l++){var o=e.measureText(this.content[l]);s=Math.max(s,o.width,r),this.contentHeight+=this.fontSize+Rt}this.hasContent()||(this.contentHeight=0),s>this.width&&(this.width=s),e.shadowOffsetX=2,e.shadowOffsetY=2,this.iconAreaHeight=24*a,""!==this.content[0]?this.realHeight=4*Rt+this.height+this.iconAreaHeight+this.contentHeight:this.realHeight=2*Rt+this.height+this.iconAreaHeight,e.fillStyle=this.colour,e.fillRect(this.x,this.y,this.width,this.realHeight),e.strokeRect(this.x,this.y,this.width,this.realHeight),""!==this.content[0]&&e.strokeRect(this.x,this.y,this.width,this.height+this.iconAreaHeight+2*Rt),this.selected&&(e.fillStyle="#000000",cn(this.x,this.y),cn(this.x+this.width,this.y),cn(this.x,this.y+this.realHeight),cn(this.x+this.width,this.y+this.realHeight));var c=this.y+2,d=this.x+this.width+2;function h(t){var a=t.height,n=t.width,i=20/a;e.drawImage(t,d-4-n*i,c,n*i,a*i),c+=24}for(var u=function(a){if(!0===t.icons[1][a]){!0===t.icons[2][a]&&t.increaseWidthIfNecessary(e,20+e.measureText("<< "+t.icons[0][a]+" >>").width);var n=t.imageElements[t.icons[0][a]];if(void 0===n){var i=new Image;i.crossOrigin="anonymous",i.src=Ht.Activity,console.log(t.icons[0][a]),i.onload=function(){h(i),t.imageElements[t.icons[0][a]]=i}}else h(n)}else c+=24},f=0;f<this.icons[0].length;f++)u(f);e.fillStyle="#000000";var m=Rt+this.fontSize;e.shadowOffsetX=0,e.shadowOffsetY=0;for(var A=this.x+2,y=this.y+20,v=0;v<this.icons[0].length;v++){if(!0===this.icons[2][v]){!0!==this.icons[1][v]&&this.increaseWidthIfNecessary(e,e.measureText("<< "+this.icons[0][v]+" >>").width);var g="<< "+this.icons[0][v].slice(0,-4)+" >>";"_n"===this.icons[0][v].slice(-6,-4)&&(g=""),e.fillText(g,A,y)}y+=24}this.increaseWidthIfNecessary(e,e.measureText(this.Origin+this.title).width),this.isAbstract?e.font="italic "+this.fontSize+"px Segoe UI":e.font=this.fontSize+"px Segoe UI",e.fillText(this.Origin+this.title,this.x+Rt,this.y+m+this.iconAreaHeight),m=2*Rt+this.height+this.contentHeight,e.font=this.fontSize+"px Segoe UI";for(var p=0;p<this.content.length;p++)this.increaseWidthIfNecessary(e,e.measureText(this.content[p]).width+2*Rt),e.fillText(this.content[p],this.x+Rt,this.y+m+this.iconAreaHeight),m+=this.fontSize+Rt;e.strokeStyle="black"}},{key:"intersects",value:function(e,t){return!(e<this.x)&&(!(t<this.y)&&(!(e>this.x+this.width)&&t<=this.y+this.realHeight))}},{key:"getNearestSideFrom",value:function(e,t){return this.getNearestSide(e,t)}},{key:"getNearestSide",value:function(e,t){var a=[];if(e>this.x&&e<this.x+this.width){var n=(e-this.x)/this.width;a.push([Math.abs(t-this.y),n,0]),a.push([Math.abs(t-(this.y+this.realHeight)),n,1])}else if(t>this.y&&t<this.y+this.realHeight){var i=(t-this.y)/this.realHeight;a.push([Math.abs(e-this.x),0,i]),a.push([Math.abs(e-(this.x+this.width)),1,i])}var r=!1;if(a.forEach((function(e){e[0]<Ga&&(r=!0)})),!1===r&&e>this.x&&e<this.x+this.width&&t>this.y&&t<this.y+this.realHeight){for(var s=(t-this.y)/this.realHeight,l=(e-this.x)/this.width,o=Math.abs(l-1)*this.width,c=s*this.realHeight,d=l*this.width,h=0,u=d,f=[d,o,c,s*this.realHeight],m=1;m<f.length-1;m++)f[m]<u&&(u=f[m],h=m);if(0===h)return[0,0,s];if(1===h)return[0,1,s];if(2===h)return[0,l,0];if(3===h)return[0,l,1]}if(0===a.length)return null;for(var A=a[0],y=1;y<a.length;y++)a[y][0]<A[0]&&(A=a[y]);return A}}]),e}(),Yt=!1,zt=!1,qt=[],Xt=null,Jt=function(e){Object(m.a)(a,e);var t=Object(A.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).ocm=function(e){e.preventDefault()},n.mouseDown=function(e,t){var a=mn(e),i=a[0],r=a[1];if(n.setState({startX:i,startY:r}),e.shiftKey&&!zt&&(zt=!0),0===e.button&&!Yt){var s=hn(i,r);Xt=s,null!==s&&t.tool===Qe.Select&&"Vertex"===s.typeName?(e.preventDefault(),n.props.setLeftMenu(hn(i,r)),nn(t,i,r,null,zt)):(n.props.setLeftMenu(hn(i,r)),Wa(t,i,r),Ja(t,i,r))}if(e.ctrlKey&&!Yt&&(Yt=!0),0===e.button&&Yt){var l=hn(i,r);if(null===l&&(n.props.setLeftMenu(l,!1,qt),qt=[],Yt=!1),null!==l){for(var o=0;o<qt.length-1;){for(var c=o+1;c<qt.length;c++)qt[o].x===qt[c].x&&qt[o].y===qt[c].y&&qt.splice(c);o++}qt.push(hn(i,r)),nn(t,i,r,qt);for(var d=0;d<qt.length;d++)n.props.setLeftMenu(qt[d],Yt)}}1===e.button&&(e.preventDefault(),nn(t,i,r))},n.mouseUp=function(e,t){ln();var a=mn(e),n=a[0],i=a[1];0===e.button&&(t.tool===Qe.Select?Ta():function(e,t,a){if(Va)return void(Va=!1);if(!0===Ia)return Ia=!1,void(Wt.onmousemove=null);if(Wt.onmousemove=null,za())if(Fa(t,a).snapped&&!Ma){var n=hn(t,a),i=null;null!==Na[0]&&null!==n&&null!==ca&&(i=fn(e,_t,$t,t,a)),Na=[],Ma=!0,null!==i&&Qa(i),Ta();var r=0;oa.flatten().forEach((function(e){"Arrow"===e.typeName&&(ca[r]=e.path,r++)})),null!==i&&e.props.setLeftMenu(i),e.props.setMode(Qe.Select),null!==ea&&null!==n&&function(e){var t=[],a=[],n=[],i=[],r=[],s=[],l=[],o=[],c=(f=ea,m=e,f.width*(f.height+10)<=m.width*(m.height+10)?[m,f]:[f,m]),d=Object(v.a)(c,2),h=d[0],u=d[1];var f,m;oa.flatten().forEach((function(e){if("Arrow"===e.typeName)if(h.y+h.height+10<u.y&&u.x>h.x&&u.x+u.width<h.x+h.width){var c=_a(n,i,h,e,0),d=Object(v.a)(c,2);n=d[0],i=d[1]}else if(h.y>u.y+u.height+10&&u.x>h.x&&u.x+u.width<h.x+h.width){var f=_a(t,a,h,e,1),m=Object(v.a)(f,2);t=m[0],a=m[1]}else if(h.x>u.x+u.width&&u.y>h.y&&u.y+u.height+10<h.y+h.height+10){console.log("left ran");var A=en(r,s,h,e,1),y=Object(v.a)(A,2);r=y[0],s=y[1]}else if(h.x+h.width<u.x&&u.y>h.y&&u.y+u.height+10<h.y+h.height+10){console.log("right ran");var g=en(l,o,h,e,0),p=Object(v.a)(g,2);l=p[0],o=p[1]}})),$a(h,n,i,0),$a(h,t,a,1),tn(h,r,s,1),tn(h,l,o,0)}(n),ea=null}else ea=hn(t,a),Na.push(Fa(t,a).coord),Ca=t,ka=a,Wt.onmousemove=function(t){an(t,e)},Ma=!1;if(e.tool===Qe.Vertex){var s=fn(e,_t,$t,t,a);Qa(s),e.props.setLeftMenu(s),e.props.setMode(Qe.Select),$e()}if(e.tool===Qe.Artifact){var l=function(e,t,a){if(e.tool===Qe.Artifact){var n=An(t,a,t+450,a+50),i=Pa(n[1],0),r=Pa(n[3],0);return new Qt({title:"",content:[""],x:n[0],y:Pa(a,1),width:n[2]-n[0],height:r-i})}return null}(e,_t,$t);Qa(l),e.props.setLeftMenu(l),e.props.setMode(Qe.Select)}if(e.tool===Qe.Container){var o=function(e,t,a){if(e.tool===Qe.Container){var n=An(t,a,t+100,a+60),i=Pa(n[1],0),r=Pa(n[3],0),s=new Qt({title:"new Container",content:[""],x:n[0],y:Pa(a,1),width:n[2]-n[0],height:r-i});return s.setIsContainer(!0),s}return null}(e,_t,$t);o.setColour("#FFFFFF"),Qa(o),e.props.setLeftMenu(o),e.props.setMode(Qe.Select)}Ta()}(t,n,i)),e.button,e.shiftKey&&zt&&(zt=!1),1===e.button&&window.setTimeout((function(){ln()}),200),!0===La&&function(e){var t=e,a=0;null!==oa.flatten()&&null!==t&&(oa.flatten().forEach((function(e){"Vertex"===e.typeName&&(t.x===e.x&&t.y===e.y||t.y>e.y+e.height+10||t.x>e.x+e.width||e.x>t.x+t.width||e.y>t.y+t.height+10||(t.x=Oa[0],t.y=Oa[1],t.width=Da[0],t.height=Da[1],a++))})),0===a&&(Oa=[t.x,t.y],Da=[t.width,t.height]),La=!1,Ta())}(Xt)},n.canvasRef=i.a.createRef(),n.state={},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.zoom=this.props.mainState.zoomLevel,this.tool=this.props.mainState.drawMode,document.getElementById("Canvas").addEventListener("dragenter",this.dragEnter),document.getElementById("Canvas").addEventListener("dragover",this.dragOver),document.getElementById("Canvas").addEventListener("dragleave",this.dragLeave),document.getElementById("Canvas").addEventListener("drop",this.drop)}},{key:"componentWillUnmount",value:function(){document.getElementById("Canvas").removeEventListener("dragenter",this.dragEnter),document.getElementById("Canvas").removeEventListener("dragover",this.dragOver),document.getElementById("Canvas").removeEventListener("dragleave",this.dragLeave),document.getElementById("Canvas").removeEventListener("drop",this.drop)}},{key:"componentDidUpdate",value:function(){this.zoom=this.props.mainState.zoomLevel,this.tool=this.props.mainState.drawMode}},{key:"dragEnter",value:function(e){e.preventDefault()}},{key:"dragOver",value:function(e){e.preventDefault()}},{key:"dragLeave",value:function(e){return 0}},{key:"drop",value:function(e){if(ba()<=0)console.log("attempted to drag and drop vertex while there are no available graphs to draw on"),window.alert("You need to create and select a graph first before you can start drawing!");else{var t,a=e.dataTransfer.getData("text/plain"),n=0,i=Object(y.a)(yt());try{for(i.s();!(t=i.n()).done;){var r=t.value;r.semanticIdentity.UUID===a&&(n=r)}}catch(E){i.e(E)}finally{i.f()}var s,l=mn(e),o=n.text.replace(" \ud83d\udfe7","");o=o.replace(" \ud83d\udcc2","");var c=!1;n.parentContainerKey!==ya()?(s="#FFFFFF",c=!0):s=n.colour;var d=(f=l[0],m=l[1],A=n.width,v=n.height,g=o,p=n.content,b=s,n.icons,n.imageElements,n.fontSize,x=n.semanticIdentity,new Qt({title:g,content:p,colour:b,x:f,y:Pa(m,1),width:A,height:v,semanticIdentity:x}));if(!0===c){var h=(u=n.parentContainerKey,bt().find((function(e){return e.containerKey===u})).text);h=(h=h.replace(" \ud83d\udfe7","")).replace(" \ud83d\udcc2",""),d.setOrigin(h+" :: ")}Qa(d),Ta(),$e()}var u,f,m,A,v,g,p,b,x}},{key:"mouseLeave",value:function(){Wt.onmousemove={},Ma=!0,Ta()}},{key:"render",value:function(){var e=this;return i.a.createElement("canvas",{ref:this.canvasRef,id:"drawCanvas",onContextMenu:function(t){return e.ocm(t)},onMouseDown:function(t){return e.mouseDown(t,e)},onMouseUp:function(t){return e.mouseUp(t,e)},onMouseLeave:function(t){return e.mouseLeave(t,e)}},i.a.createElement("p",null," HTML5 Canvas elements are not supported by your browser"))}}]),a}(i.a.Component);window.addEventListener("resize",Ua);var Wt,Zt,_t,$t,ea,ta,aa,na,ia,ra=!1,sa=70,la=200,oa=new N,ca=[],da=0,ha=0,ua=0,fa=0;function ma(e){ha=e}function Aa(e){fa=e}function ya(){return da}function va(e){da=e}function ga(){return ha}function pa(){ha=ha+=1}function ba(){return ua}function xa(e){ua=e;try{document.getElementById("SelectedGraph").value=Bt(e)}catch(t){}}function Ea(){return fa}function wa(){fa=fa+=1}var Na=[],Ca=0,ka=0,Ia=!1,Sa=0,Ma=!0,Va=!1,Oa=[],Da=[],La=!1;function Ua(){try{var e=Wt.getBoundingClientRect();ta=e.left,aa=e.top,function(){var e=document.getElementsByClassName("Canvas")[0],t=+getComputedStyle(e).getPropertyValue("height").slice(0,-2),a=+getComputedStyle(e).getPropertyValue("width").slice(0,-2);Wt.setAttribute("height",t*yn()),Wt.setAttribute("width",a*yn()),na=Wt.width,ia=Wt.height}(),vn()}catch(t){console.error("Failed to acquire canvas element")}Ta()}function Ta(){sn(),vn(),Zt.resetTransform(),Zt.scale(yn(),yn()),oa.flatten().forEach((function(e){null!==e&&e.getGraphKey()===ua&&e.draw(Zt)}))}function ja(e){null!==e?oa.remove(e)||console.error("Failed to delete object with UUID %s",e.semanticIdentity.UUID):console.error("Attempted to delete a null element"),Ta()}function Ka(e){console.log("vDeleteE occurs");var t=oa.ArrowUUIDSource(e),a=oa.ArrowUUIDDest(e);t.forEach((function(e){return oa.remove(e.arrow)})),a.forEach((function(e){return oa.remove(e.arrow)})),ja(e)}function Pa(e,t){var a=ia/sa*la/100*200/la;return a*Math.floor(e/a)+a/2*+t}function Ba(e,t){for(var a=oa.flatten(),n=0;n<a.length;n++){var i=a[n];if("Vertex"===i.typeName){var r=i.getBounds(),s=r[0],l=r[1],o=r[2],c=r[3],d=Math.abs(l-t)<10,h=Math.abs(c-t)<10,u=Math.abs(s-e)<10,f=Math.abs(o-e)<10,m=t>l&&t<c,A=e>s&&e<o;if(f&&m)return[i,"right"];if(d&&u)return[i,"topLeft"];if(d&&f)return[i,"topRight"];if(h&&u)return[i,"bottomLeft"];if(h&&f)return[i,"bottomRight"];if(u&&m)return[i,"left"];if(f&&m)return[i,"right"];if(d&&A)return[i,"top"];if(h&&A)return[i,"bottom"]}}return[null,null]}var Ga=15;function Fa(e,t){var a=null,n=0;oa.flatten().forEach((function(i){if(null!==i&&"Vertex"===i.typeName){var r=i.getNearestSideFrom(e,t,Ca,ka);null!==r&&r[0]<Ga&&(null===a||r[0]<n)&&(a=[0,i.semanticIdentity.UUID,r[1],r[2]],n=r[0])}}));var i=a;if(null===a&&(i=[1,e,t]),Na.length<1||0===i[0])return{coord:i,snapped:null!==a,nearest:a};var r=Na[Na.length-1][1],s=Na[Na.length-1][2],l=i[1]-r,o=i[2]-s,c=Math.atan2(o,l)*(180/Math.PI),d=(c=(c+360)%360)%90;if(d>82||d<8){for(var h=dn(0,0,l,o),u=[0,90,180,270,360],f=u[0],m=1;m<u.length;m++)Math.abs(u[m]-c)<Math.abs(f-c)&&(f=u[m]);var A=f*(Math.PI/180),y=h*Math.cos(A),v=h*Math.sin(A);i=[i[0],r+y,s+v]}return{coord:i,snapped:null!==a,nearest:a}}function Ha(e){return e.props.mainState.selectedObject}function Ra(e,t){var a=mn(e);t[0].expandSide(t[1],a[0],a[1],Zt),function(){var e=0;oa.flatten().forEach((function(t){"Arrow"===t.typeName&&(e=Fa(t.path[1][0],t.path[1][1]),t.pathData[1]=e.nearest,Xa(e,t,0))}))}()}function Qa(e){null!==e&&void 0!==e&&oa.add(e)}function Ya(e){oa=e,Ta()}function za(){return Sa===Qe.Visibility||Sa===Qe.Edge||Sa===Qe.Specialisation}function qa(e){var t;return oa.flatten().forEach((function(a){a.semanticIdentity.UUID===e&&(t=a)})),t}function Xa(e,t,a){if(!1===e.snapped){var n=e.coord;t.path[a]=[n[1],n[2]]}else{void 0!==qa(e.nearest[1])&&(t.path[a]=t.rebuildPath())}}function Ja(e,t,a){var n=Ba(t,a);if(e.tool===Qe.Vertex||e.tool===Qe.Select){if(null!==n[0]&&n[0]===Ha(e))return Wa(e,t,a),Ia=!0,void(Wt.onmousemove=function(e){Ra(e,n)});var i=hn(t,a);if(e.tool===Qe.Vertex&&null!==i)return e.props.setLeftMenu(i),e.props.setMode(Qe.Select),void(Va=!0)}if(e.tool===Qe.Select){var r,s,l=function(e,t){var a,n=-1,i=30,r=null;return oa.flatten().forEach((function(s){"Arrow"===s.typeName&&s.path.forEach((function(l){(a=Math.hypot(e-l[0],t-l[1]))<i&&(i=a,n=s.path.indexOf(l),r=s)}))})),[n,r]}(t,a),o=Object(v.a)(l,2);if(r=o[0],(s=o[1])===Ha(e)&&-1!==r){Ia=!0;var c=function(e){!function(e,t,a){var n=mn(e),i=Object(v.a)(n,2),r=Fa(i[0],i[1]);a.pathData[t]=r.nearest,Xa(r,a,t)}(e,r,s)};Wt.addEventListener("mousemove",c),Wt.addEventListener("mouseup",(function(){Wt.removeEventListener("mousemove",c)}))}}_t=t,$t=a,Wt.onmousemove=function(t){an(t,e)}}function Wa(e,t,a){null!==Xt&&(La=!0,Oa=[Xt.x,Xt.y],Da=[Xt.width,Xt.height])}function Za(e){var t,a,n=[],i=[],r=[],s=[];return t=e.semanticIdentity.UUID,oa.flatten().forEach((function(l){"Arrow"===l.typeName&&(t===l.destVertexUUID?(((a=qa(l.sourceVertexUUID)).height+10)*a.width<(e.height+10)*e.width&&r.push(a),l.path[0][1]<e.y||l.path[0][1]>e.y+e.height+10?n.push(l):(l.path[0][0]<e.x||l.path[0][0]>e.x+e.width)&&i.push(l)):t===l.sourceVertexUUID&&(((a=qa(l.destVertexUUID)).height+10)*a.width<(e.height+10)*e.width&&r.push(a),l.path[1][1]<e.y||l.path[1][1]>e.y+e.height+10?n.push(l):(l.path[1][0]<e.x||l.path[1][0]>e.x+e.width)&&i.push(l)),s.push(l))})),[r,n,i,s]}function _a(e,t,a,n,i){if(a.semanticIdentity.UUID===n.destVertexUUID){var r=qa(n.sourceVertexUUID);a.y*i+r.y*(1-i)>(r.y+r.height+10)*i+(a.y+a.height+10)*(1-i)&&(e.push(r),t.push(n))}else if(a.semanticIdentity.UUID===n.sourceVertexUUID){var s=qa(n.destVertexUUID);a.y*i+s.y*(1-i)>(s.y+s.height+10)*i+(a.y+a.height+10)*(1-i)&&(e.push(s),t.push(n))}return[e,t]}function $a(e,t,a,n){if(t.length>=2){for(var i=0,r=e.x,s=e.y+(e.height+30)*(1-n);i<t.length;i++)t[i].x=r,t[i].y=s-(t[i].height+30)*n,r=r+t[i].width+20,t[i].x+t[i].width>e.x+e.width&&(e.width=e.width+t[i].width);for(i=0;i<t.length;i++){var l=Fa(t[i].x+t[i].width/2,e.y+(e.height+10)*(1-n));a[i].pathData[1]=l.nearest,Xa(l,a[i],1)}}}function en(e,t,a,n,i){if(a.semanticIdentity.UUID===n.destVertexUUID){var r=qa(n.sourceVertexUUID);a.x*i+r.x*(1-i)>(r.x+r.width)*i+(a.x+a.width)*(1-i)&&(e.push(r),t.push(n))}else if(a.semanticIdentity.UUID===n.sourceVertexUUID){var s=qa(n.destVertexUUID);a.x*i+s.x*(1-i)>(s.x+s.width)*i+(a.x+a.width)*(1-i)&&(e.push(s),t.push(n))}return[e,t]}function tn(e,t,a,n){if(t.length>=2){for(var i=0,r=e.x+(e.width+30)*(1-n),s=e.y;i<t.length;i++)t[i].x=r-(t[i].width+30)*n,t[i].y=s,s=s+t[i].height+20,t[i].y+t[i].height+10>e.y+e.height+10&&(e.height=e.height+t[i].height);for(i=0;i<t.length;i++){var l=Fa(e.x+e.width*(1-n),t[i].y+(t[i].height+10)/2);a[i].pathData[1]=l.nearest,Xa(l,a[i],1)}}}function an(e,t){ra=!0;var a=mn(e);Ta();var n=fn(t,_t,$t,a[0],a[1]);Zt.globalAlpha=.75,null!==n&&n.draw(Zt),Zt.globalAlpha=1,ra=!1}function nn(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=hn(t,a),s=Za(r),l=Object(v.a)(s,4),o=l[0],c=l[1],d=l[2],h=l[3];if(null!==o||o.length>=1){for(var u=o,f=[],m=0;m<u.length;m++){var A=Za(u[m]),y=Object(v.a)(A,1),g=y[0];if(null!==g){for(var p=0;p<g.length;p++)for(var b=0;b<u.length;b++)g[p].semanticIdentity.UUID===u[b].semanticIdentity.UUID&&g.splice(p,1);if(g.length>=1)for(var x=0;x<g.length;x++)f.push(g[x]),o.push(g[x])}}u=f}var E=[];if(null!==o)for(var w=0;w<o.length;w++)E.push([t-o[w].x,a-o[w].y]);var N=[];if(null!==n)for(var C=0;C<n.length;C++)N.push([t-n[C].x,a-n[C].y]);if(null!==r){Wa();var k=t-r.x,I=a-r.y;Wt.onmousemove=function(e){rn(e,r,o,E,n,N,k,I,c,d,h,i)}}}function rn(e,t,a,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,o=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>11?arguments[11]:void 0;if(null!=t)if("Vertex"===t.typeName){var h=mn(e),u=h[0]-s,f=h[1]-l;if(d&&null!==a)for(var m=0;m<a.length;m++)a[m].x=h[0]-n[m][0],a[m].y=h[1]-n[m][1];if(null!==i)for(var A=0;A<i.length;A++)i[A].x=h[0]-r[A][0],i[A].y=h[1]-r[A][1];if(null!==o)for(var y=0;y<o.length;y++)o[y].path[1][0]=o[y].path[0][0],Xa(Fa(o[y].path[1][0],o[y].path[1][1]),o[y],0);else if(null!==c)for(var v=0;v<c.length;v++)c[v].path[1][1]=c[v].path[0][1],Xa(Fa(c[v].path[1][0],c[v].path[1][1]),c[v],0);t.x=u,t.y=f,sn()}else if("Arrow"===t.typeName)return}function sn(){oa.flatten().forEach((function(e){null!==e&&"Arrow"===e.typeName&&e.rebuildPath()}))}function ln(){Wt.onmousemove=null}function on(e){la=e,Ua(),Ta()}function cn(e,t){var a=Zt.lineWidth;Zt.lineWidth=.5;var n=Zt.strokeStyle;Zt.strokeStyle="#007ACC";var i=Zt.fillStyle;Zt.fillStyle="#007ACC55",Zt.globalAlpha=1,Zt.beginPath(),Zt.arc(e,t,2,0,2*Math.PI,!1),Zt.fill(),Zt.stroke(),Zt.closePath(),Zt.lineWidth=a,Zt.strokeStyle=n,Zt.fillStyle=i}function dn(e,t,a,n){return Math.sqrt(Math.pow(a-e,2)+Math.pow(n-t,2))}function hn(e,t){var a=null;return oa.flatten().forEach((function(n){null!==n&&n.intersects(e,t)&&(a=n)})),a}function un(e){var t;"treeVertex"!==e.type?((t=function(e){var t,a=Object(y.a)(yt());try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.semanticIdentity.UUID===e.originalUUID)return n}}catch(i){a.e(i)}finally{a.f()}}(e)).text=e.title+" \ud83d\udfe7",t.content=e.content,t.width=e.width,t.height=e.height):t=e;var a,n=Object(y.a)(oa.flatten());try{for(n.s();!(a=n.n()).done;){var i=a.value;t.semanticIdentity.UUID===i.originalUUID&&i!==e&&(t.parentContainerKey===i.vertexContainerKey?(i.title=t.text.replace(" \ud83d\udfe7",""),i.colour=t.colour,i.content=t.content):(i.title=t.text.replace(" \ud83d\udfe7",""),i.colour="#FFFFFF",i.content=t.content))}}catch(r){n.e(r)}finally{n.f()}}function fn(e,t,a,n,i){var r,s=oa.flatten();if("Vertex"===e.tool&&!1===ra){var l=An(t,a,n+10,i),o=Pa(l[1],0),c=Pa(l[3],0);console.log("draw vertex");var d=It("Drawn Vertex",ya());return new Qt({title:"Drawn Vertex",content:d,colour:d.colour,x:l[0],y:Pa(a,1),width:l[2]-l[0],height:c-o,semanticIdentity:d.semanticIdentity})}if(za()){if(0!==(r=Na.concat([Fa(n,i).coord]))[0][0])return null;var h=new ze(s,r,Sa);return h.rebuildPath(s),h}return null}function mn(e){return Ua(),[(e.clientX-ta)/yn(),(e.clientY-aa)/yn()]}function An(e,t,a,n){return[Math.min(e,a),Math.min(t,n),Math.max(e,a),Math.max(t,n)]}function yn(){return la/100}function vn(){Zt.fillStyle="#ffffff",Zt.fillRect(0,0,na,ia)}var gn,pn,bn=a(204),xn="Default",En=0,wn="Default",Nn=function(e){Object(m.a)(a,e);var t=Object(A.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={xPos:"0px",yPos:"0px",showMenu:!1},e.handleClick=function(t){if(e.state.showMenu)if("MoveGraph"===t.target.id)wn="MoveGraph",e.setState({showMenu:!0});else if("MoveGraph"===wn&&t.target.id.includes("Package")){var a=t.target.id.replace("Package","");jt(En,parseInt(a)),e.setState({showMenu:!1}),e.props.setLeftMenuToTree()}else if("Rename"===t.target.id)wn="Rename",e.setState({showMenu:!0});else if("RenameVertex"===t.target.id)wn="RenameVertex",e.setState({showMenu:!0});else if("RenameGraph"===t.target.id)wn="RenameGraph",e.setState({showMenu:!0});else if("AddVertex"===t.target.id)wn="AddVertex",e.setState({showMenu:!0});else if("AddGraph"===t.target.id)wn="AddGraph",e.setState({showMenu:!0});else if("AddPackage"===t.target.id)wn="AddPackage",e.setState({showMenu:!0});else if("DeletePackage"===t.target.id)wn="DeletePackage",e.setState({showMenu:!0});else if("DeleteVertex"===t.target.id)wn="DeleteVertex",e.setState({showMenu:!0});else if("DeleteGraph"===t.target.id)wn="DeleteGraph",e.setState({showMenu:!0});else if("DeleteVertexConfirmed"===t.target.id){var n,i=Object(y.a)(yt());try{for(i.s();!(n=i.n()).done;){var r=n.value;r.containerKey===En&&Mt(r.semanticIdentity.UUID)}}catch(m){i.e(m)}finally{i.f()}e.setState({showMenu:!1}),e.props.setLeftMenuToTree(),$e()}else if("DeletePackageConfirmed"===t.target.id){var s,l=Object(y.a)(ut());try{for(l.s();!(s=l.n()).done;){s.value.containerKey===En&&St(En)}}catch(m){l.e(m)}finally{l.f()}e.setState({showMenu:!1}),e.props.setLeftMenuToTree(),$e()}else if("DeleteGraphConfirmed"===t.target.id){var o,c=Object(y.a)(xt());try{for(c.s();!(o=c.n()).done;){o.value.graphKey===En&&Lt(En)}}catch(m){c.e(m)}finally{c.f()}e.setState({showMenu:!1}),e.props.setLeftMenuToTree(),$e()}else if("RenameBox"===t.target.id||"CMSelected"===t.target.id);else if("RenameVertexBox"===t.target.id||"CMSelected"===t.target.id);else if("RenameGraphBox"===t.target.id||"CMSelected"===t.target.id);else if("VertexNameBox"===t.target.id||"CMSelected"===t.target.id);else if("GraphNameBox"===t.target.id||"CMSelected"===t.target.id);else if("PackageNameBox"===t.target.id||"CMSelected"===t.target.id);else if("Create-Graph"===t.target.id)wn="AddContainerGraph",e.setState({showMenu:!0});else if("Bi-Nav"===t.target.id)wn="Bi-Nav",e.setState({showMenu:!0});else if("Bi-Nav"===wn&&t.target.id.includes("Nav")){var d=t.target.id.replace("Nav","");xa(parseInt(d[0])),va(d[1]),ct(d[1]);var h,u=Object(y.a)(oa.flatten());try{for(u.s();!(h=u.n()).done;){var f=h.value;"Vertex"===f.typeName&&f.getGraphKey()===ba()?f.setPresent():f.getGraphKey()!==ba()&&"Vertex"===f.typeName&&f.setAway()}}catch(m){u.e(m)}finally{u.f()}Ta(),e.props.setLeftMenuToTree(),e.setState({showMenu:!1})}else e.setState({showMenu:!1})},e.handleKey=function(t){if("Enter"===t.key)if("Rename"===wn){Ot(document.getElementById("RenameBox").value,En);try{e.props.setLeftMenuToTree()}catch(t){}e.setState({showMenu:!1}),$e()}else if("RenameGraph"===wn){Ut(document.getElementById("RenameGraphBox").value,En);try{e.props.setLeftMenuToTree()}catch(t){console.log(t)}e.setState({showMenu:!1}),$e()}else if("RenameVertex"===wn){var a=document.getElementById("RenameVertexBox").value;gn.text=a,gn.data.text=a;try{e.props.setLeftMenuToTree()}catch(t){console.log(t)}un(gn),e.setState({showMenu:!1}),Ta(),$e()}else if("AddVertex"===wn){It(document.getElementById("VertexNameBox").value,dt());try{e.props.setLeftMenuToTree()}catch(t){console.log(t)}e.setState({showMenu:!1}),$e()}else if("AddGraph"===wn){Dt(document.getElementById("GraphNameBox").value,dt());try{e.props.setLeftMenuToTree()}catch(t){console.log(t)}e.setState({showMenu:!1}),$e()}else if("AddPackage"===wn){kt(document.getElementById("PackageNameBox").value,dt());try{e.props.setLeftMenuToTree()}catch(t){console.log(t)}e.setState({showMenu:!1}),$e()}},e.handleContextMenu=function(t){if(t.preventDefault(),t.target.click(),wn="Default",xn="Default",En=0,gn=null,"jstree-anchor jstree-hovered jstree-clicked"===t.target.className){if(t.target.text.includes("\ud83d\udcc1")){var a,n=Object(y.a)(ut());try{for(n.s();!(a=n.n()).done;){var i=a.value;t.target.text===i.text&&(wn="Package",xn=t.target.text,En=dt())}}catch(p){n.e(p)}finally{n.f()}}if(t.target.text.includes("\ud83d\udcc8")){var r,s=Object(y.a)(xt());try{for(s.s();!(r=s.n()).done;){var l=r.value;t.target.text===l.text&&(wn="Graph",xn=t.target.text,En=ba())}}catch(p){s.e(p)}finally{s.f()}}if(t.target.text.includes("\ud83d\udfe7")||t.target.text.includes("\ud83d\udcc2")){var o,c=Object(y.a)(yt());try{for(c.s();!(o=c.n()).done;){var d=o.value;t.target.text===d.text&&(wn="Vertex",gn=d,xn=t.target.text,En=dt())}}catch(p){c.e(p)}finally{c.f()}}"Root"===t.target.text&&(wn="Root",xn=t.target.text,En=dt())}if("drawCanvas"===t.target.id){var h=mn(t),u=h[0],f=h[1];if(null!==(gn=hn(u,f)))if("Vertex"===gn.typeName)xn=gn.title,wn=!0===gn.isContainer?"Container":"CanvasVertex";else if("Arrow"===gn.typeName){var m=qa(gn.sourceVertexUUID),A=qa(gn.destVertexUUID),v=m.title,g=A.title;xn="Arrow from "+v+" to "+g,wn="Arrow"}}e.setState({xPos:"".concat(t.pageX,"px"),yPos:"".concat(t.pageY,"px"),showMenu:!0})},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleClick),document.addEventListener("contextmenu",this.handleContextMenu),document.addEventListener("keypress",this.handleKey)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClick),document.removeEventListener("contextmenu",this.handleContextMenu),document.removeEventListener("keypress",this.handleKey)}},{key:"render",value:function(){var e=this.state,t=e.showMenu,a=e.yPos,n=e.xPos;if(!t)return null;if("Default"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},"Default"));if("Package"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},i.a.createElement("b",null,xn)),i.a.createElement("div",{className:"CMitem",id:"Rename"}," Rename"),i.a.createElement("div",{className:"CMitem",id:"AddVertex"}," Add Vertex"),i.a.createElement("div",{className:"CMitem",id:"AddGraph"}," Add Graph"),i.a.createElement("div",{className:"CMitem",id:"AddPackage"}," Add Package"),i.a.createElement("div",{className:"CMitem",id:"DeletePackage"}," Delete Package"));if("Root"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},i.a.createElement("b",null,xn)),i.a.createElement("div",{className:"CMitem",id:"AddPackage"}," Add Package"));if("DeletePackage"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},i.a.createElement("b",null,"Are you sure you wish to delete: ",xn)),i.a.createElement("div",{className:"CMitem",id:"DeletePackageConfirmed"}," Yes, Delete this package"),i.a.createElement("div",{className:"CMitem",id:"DeletePackageCancel"}," No"));if("DeleteGraph"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},i.a.createElement("b",null,"Are you sure you wish to delete: ",xn)),i.a.createElement("div",{className:"CMitem",id:"DeleteGraphConfirmed"}," Yes, Delete this graph"),i.a.createElement("div",{className:"CMitem",id:"DeleteGraphCancel"}," No"));if("DeleteVertex"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},i.a.createElement("b",null,"Are you sure you wish to delete: ",xn)),i.a.createElement("div",{className:"CMitem",id:"DeleteVertexConfirmed"}," Yes, Delete this vertex"),i.a.createElement("div",{className:"CMitem",id:"DeleteVertexCancel"}," No"));if("Graph"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("div",{className:"CMitem",id:"RenameGraph"}," Rename "),i.a.createElement("div",{className:"CMitem",id:"MoveGraph"}," Move To "),i.a.createElement("div",{className:"CMitem",id:"DeleteGraph"}," Delete Graph "));if("MoveGraph"===wn){var r=ut().map((function(e){return i.a.createElement("div",{className:"CMitem",id:"Package"+e.containerKey,key:e.text}," ",e.text," ")}));return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"},' Move "',i.a.createElement("b",null,xn),'" To:'),i.a.createElement("div",null,r))}if("Rename"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("input",{className:"CMText",id:"RenameBox",type:"text",name:"renameItem",placeholder:"New Name"}));if("RenameGraph"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("input",{className:"CMText",id:"RenameGraphBox",type:"text",name:"renameItem",placeholder:"New Name"}));if("RenameVertex"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("input",{className:"CMText",id:"RenameVertexBox",type:"text",name:"renameItem",placeholder:"New Name"}));if("AddVertex"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("input",{className:"CMText",id:"VertexNameBox",type:"text",name:"nameVertex",placeholder:"Vertex Name"}));if("AddPackage"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("input",{className:"CMText",id:"PackageNameBox",type:"text",name:"namePackage",placeholder:"Package Name"}));if("AddGraph"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("input",{className:"CMText",id:"GraphNameBox",type:"text",name:"nameGraph",placeholder:"Graph Name"}));if("Vertex"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("div",{className:"CMitem",id:"Bi-Nav"}," Naviagte "),i.a.createElement("div",{className:"CMitem",id:"RenameVertex"}," Rename"),i.a.createElement("div",{className:"CMitem",id:"AddVertex"}," Add Vertex"),i.a.createElement("div",{className:"CMitem",id:"AddGraph"}," Add Graph"),i.a.createElement("div",{className:"CMitem",id:"AddPackage"}," Add Package"),i.a.createElement("div",{className:"CMitem",id:"DeleteVertex"}," Delete Vertex "));if("Arrow"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("div",{className:"CMitem",id:"Auto-Layout"}," Auto-Layout option (not implemented) "));if("CanvasVertex"===wn)return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," "),i.a.createElement("div",{className:"CMitem",id:"Auto-Layout"}," Auto-Layout option (not implemented) "),i.a.createElement("div",{className:"CMitem",id:"Bi-Nav"}," Naviagte "));if("Bi-Nav"===wn){var s=[],l=[],o=0;void 0===(o=gn.originalUUID)&&(o=gn.semanticIdentity.UUID);var c,d=Object(y.a)(oa.rootVertices);try{for(d.s();!(c=d.n()).done;){var h=c.value;h.vertex.originalUUID===o&&s.push(h)}}catch(g){d.e(g)}finally{d.f()}var u,f=Object(y.a)(xt());try{for(f.s();!(u=f.n()).done;){var m=u.value;m.semanticIdentity.UUID===o&&l.push(m)}}catch(g){f.e(g)}finally{f.f()}var A=s.map((function(e){return i.a.createElement("div",{className:"CMitem",id:"Nav"+e.vertex.vertexGraphKey+" "+e.vertex.vertexContainerKey,key:"Nav"+e.vertex.semanticIdentity.UUID+" "+e.vertex.awayx}," ",Bt(e.vertex.vertexGraphKey)," / ",e.vertex.title," ")})),v=l.map((function(e){return i.a.createElement("div",{className:"CMitem",id:"Nav"+e.graphKey+" "+e.containerKey,key:"Nav"+e.semanticIdentity.UUID}," ",e.text)}));return i.a.createElement("div",{className:"ContextMenu",style:{top:a,left:n}},i.a.createElement("div",{className:"CMSelected",id:"CMSelected"}," ",i.a.createElement("b",null,xn)," also appears at:"),i.a.createElement("div",null,A),i.a.createElement("div",null,v))}}}]),a}(i.a.Component),Cn=a(200),kn=a.n(Cn),In=a(201),Sn=a.n(In),Mn=a(202),Vn=a.n(Mn),On="http://localhost:8080",Dn=function(e){Object(m.a)(a,e);var t=Object(A.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).zoom=function(e){var t=n.state.zoomLevel;"+"===e?n.state.zoomLevel<500&&(n.setState({zoomLevel:t+=25}),on(t)):"-"===e?n.state.zoomLevel>100&&(n.setState({zoomLevel:t-=25}),on(t)):console.log("Invalid Zoom Type")},n.showFile=function(){n.loadImport("Load")},n.importFile=function(){n.loadImport("Import")},n.toggleSemanticDomainState=function(){n.semanticTableEnabled?(n.semanticTableEnabled=!1,Ta(),n.setState(n.state),console.log("Semantic Domain disabled")):(n.semanticTableEnabled=!0,function(){for(var e=[],t=oa.flatten(),a=0;a<yt().length;a++)e.push(re(yt()[a]));for(var n=0;n<t.length;n++)"Arrow"===t[n].typeName&&(e.push(re(t[n].sourceEdgeEnd)),e.push(re(t[n].destEdgeEnd)));null!==z?z(e):console.error("Cannot set rows")}(),n.setState(n.state),console.log("Semantic Domain enabled"))},n.state={zoomLevel:200,drawMode:Qe.Vertex,menu:Fe.TreeView,selectedObject:null},n.setMode=n.setMode.bind(Object(f.a)(n)),n.setLeftMenu=n.setLeftMenu.bind(Object(f.a)(n)),n.setLeftMenuToTree=n.setLeftMenuToTree.bind(Object(f.a)(n)),n.semanticTableEnabled=!1,n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.setMode(Qe.Select),console.log("Mounted")}},{key:"componentDidUpdate",value:function(e,t,a){var n=document.getElementById(t.SelectedTool);null!==n&&(n.style.backgroundColor="#FFFFFF"),(n=document.getElementById(this.state.SelectedTool)).style.backgroundColor="#CFFFFF"}},{key:"setMode",value:function(e){e===Qe.Visibility||e===Qe.Edge||e===Qe.Specialisation?this.setState({drawMode:"Arrow"}):e===Qe.Vertex?this.setState({drawMode:"Vertex"}):e===Qe.Select?this.setState({drawMode:"Select"}):e===Qe.Artifact?this.setState({drawMode:"Artifact"}):e===Qe.Container&&this.setState({drawMode:"Container"}),this.setState({SelectedTool:Qe[e]}),Sa=e}},{key:"setLeftMenu",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null!==a)for(var n=0;n<a.length;n++)a[n].setSelected(!1);null!==this.state.selectedObject&&!1===t&&this.state.selectedObject.setSelected(!1),null===e?this.setState({menu:Fe.TreeView,selectedObject:null}):null!==Re[e.typeName]?(this.setState({menu:e.typeName,selectedObject:e}),e.setSelected(!0)):(null!==this.state.selectedObject&&Ta(),this.setState({menu:Fe.TreeView,selectedObject:null}))}},{key:"setLeftMenuToTree",value:function(){null!==this.state.selectedObject&&Ta(),this.setState({menu:Fe.None}),this.setState({menu:Fe.TreeView,selectedObject:null})}},{key:"loadImport",value:function(e){var t=this.setLeftMenuToTree;if(window.File&&window.FileReader&&window.FileList&&window.Blob)try{var a=null;"Load"===e?a=document.getElementById("File-Select").files[0]:"Import"===e&&(a=document.getElementById("File-Select-Import").files[0]);var n=new FileReader;n.readAsText(a),n.onload=function(){var a=n.result;"Load"===e?Xe(a):"Import"===e&&Je(a),t()}}catch(i){alert(i+" did you select a file?")}else alert("Your browser is too old to support HTML5 File API");return 0}},{key:"mainUndo",value:function(){var e=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,void(_e<9&&void 0!==Ze[_e+1]&&0!==Ze.length&&(_e++,We(Ze[_e])));case 2:this.setLeftMenuToTree();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mainRedo",value:function(){var e=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,void(_e>0&&0!==Ze.length&&(_e--,We(Ze[_e])));case 2:this.setLeftMenuToTree();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Nn,{setLeftMenuToTree:this.setLeftMenuToTree}),i.a.createElement("div",{className:"Program"},i.a.createElement("div",{className:this.semanticTableEnabled?"SemanticDomain":"hidden"},i.a.createElement(ne,null)),i.a.createElement("div",{className:"TopMenus"},i.a.createElement(Ge.a,{variant:"Primary",id:"File-Menu",title:"File",size:"lg"},i.a.createElement(bn.a.Item,null,i.a.createElement("div",{className:"TopBar"},i.a.createElement("button",{id:"file",onClick:function(){return!0===window.confirm("Are you sure, this will clear the current canvas!")?(console.log("Clearing canvas"),window.location.reload()):console.log("User opted to not clear the canvas"),void Ta()}},"New File"))),i.a.createElement(bn.a.Item,null,i.a.createElement("div",{className:"TopBar"},i.a.createElement("button",{id:"downloader",onClick:function(){return function(){var e=document.createElement("a");e.href=Wt.toDataURL("image/png").replace(/^data:image\/[^;]/,"data:application/octet-stream"),e.download="Graph.png",document.body.appendChild(e),e.click()}()},download:"image.png"},"Export as .png"))),i.a.createElement("div",{className:"TopBar"},i.a.createElement("label",null,"Load"),i.a.createElement("input",{type:"file",id:"File-Select",onChange:this.showFile})),i.a.createElement("div",{className:"TopBar"},i.a.createElement("label",null,"Import"),i.a.createElement("input",{type:"file",id:"File-Select-Import",onChange:this.importFile})),i.a.createElement(bn.a.Item,null,i.a.createElement("div",{className:"TopBar"},i.a.createElement("button",{id:"json-downloader",onClick:function(){return function(){var e=qe(),t=JSON.stringify(e),a=new Blob([t],{type:"text/json"}),n=prompt("Please name your file","s23m Graph"),i=document.createElement("a");i.href=URL.createObjectURL(a),i.download=n+".json",document.body.appendChild(i),i.click(),document.body.removeChild(i)}()}},"Save (as Json)")))),i.a.createElement("div",{className:"TopBar",onClick:function(){return e.toggleSemanticDomainState()}},"Semantic Editor"),i.a.createElement("input",{className:"SelectedGraph",id:"SelectedGraph",type:"text",name:"selectedGraph",readOnly:"readonly"}),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.zoom("-")}}," - "),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.zoom("+")}}," + "),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.mainUndo()}},i.a.createElement("img",{src:Sn.a,alt:"Delete Container"})),i.a.createElement("div",{className:"TopBarIcon",onClick:function(){return e.mainRedo()}},i.a.createElement("img",{src:kn.a,alt:"Add Container"})),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarSpace"},"\xa0"),i.a.createElement("div",{className:"TopBarIcon"},i.a.createElement("a",{href:"UserManual.pdf"},i.a.createElement("img",{src:Vn.a,alt:"Help"})))),i.a.createElement("div",{className:"LowerPanel",id:"LowerPanel"},i.a.createElement(Ye,{setMode:this.setMode,setLeftMenu:this.setLeftMenu,mainState:this.state,className:"LeftMenus"}),i.a.createElement("div",{className:"Canvas",id:"Canvas"},i.a.createElement(Jt,{setLeftMenu:this.setLeftMenu,setMode:this.setMode,mainState:this.state})))))}}]),a}(i.a.Component);s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(l,null)),document.getElementById("root")),s.a.render(i.a.createElement(Dn,null),document.getElementById("program")),pn="drawCanvas",Wt=document.getElementById(pn),Zt=Wt.getContext("2d"),Ua(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[224,1,2]]]);
//# sourceMappingURL=main.de0f8dba.chunk.js.map